<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Concise Reference Integrity Manifest</title>
<meta content="Henk Birkholz" name="author">
<meta content="Thomas Fossati" name="author">
<meta content="Yogesh Deshpande" name="author">
<meta content="Ned Smith" name="author">
<meta content="Wei Pan" name="author">
<meta content="
       Remote Attestation Procedures (RATS) enable Relying Parties to assess the trustworthiness of a remote Attester and therefore to decide whether or not to engage in secure interactions with it.
Evidence about trustworthiness can be rather complex and it is deemed unrealistic that every Relying Party is capable of the appraisal of Evidence.
Therefore that burden is typically offloaded to a Verifier.
In order to conduct Evidence appraisal, a Verifier requires not only fresh Evidence from an Attester, but also trusted Endorsements and Reference Values from Endorsers and Reference Value Providers, such as manufacturers, distributors, or device owners.
This document specifies the information elements for representing Endorsements and Reference Values in CBOR format. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="RIM, RATS, attestation, verifier, supply chain" name="keyword">
<meta content="draft-ietf-rats-corim-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-ietf-rats-corim.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CoRIM</td>
<td class="right">November 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Birkholz, et al.</td>
<td class="center">Expires 30 May 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Remote ATtestation ProcedureS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-rats-corim-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-11-26" class="published">26 November 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-05-30">30 May 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">T. Fossati</div>
<div class="org">Linaro</div>
</div>
<div class="author">
      <div class="author-name">Y. Deshpande</div>
<div class="org">arm</div>
</div>
<div class="author">
      <div class="author-name">N. Smith</div>
<div class="org">Independent</div>
</div>
<div class="author">
      <div class="author-name">W. Pan</div>
<div class="org">Huawei Technologies</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Concise Reference Integrity Manifest</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Remote Attestation Procedures (RATS) enable Relying Parties to assess the trustworthiness of a remote Attester and therefore to decide whether or not to engage in secure interactions with it.
Evidence about trustworthiness can be rather complex and it is deemed unrealistic that every Relying Party is capable of the appraisal of Evidence.
Therefore that burden is typically offloaded to a Verifier.
In order to conduct Evidence appraisal, a Verifier requires not only fresh Evidence from an Attester, but also trusted Endorsements and Reference Values from Endorsers and Reference Value Providers, such as manufacturers, distributors, or device owners.
This document specifies the information elements for representing Endorsements and Reference Values in CBOR format.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/ietf-rats-wg/draft-ietf-rats-corim">https://github.com/ietf-rats-wg/draft-ietf-rats-corim</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 30 May 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology-and-requirement" class="internal xref">Terminology and Requirements Language</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="auto internal xref">1.1.1</a>.  <a href="#name-glossary" class="internal xref">Glossary</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-verifier-reconciliation" class="internal xref">Verifier Reconciliation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-internal-representation" class="internal xref">Internal Representation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-interacting-with-an-acs" class="internal xref">Interacting with an ACS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-quantizing-inputs" class="internal xref">Quantizing Inputs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-typographical-conventions-f" class="internal xref">Typographical Conventions for CDDL</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-concise-reference-integrity" class="internal xref">Concise Reference Integrity Manifest (CoRIM)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-corim-map" class="internal xref">CoRIM Map</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-corim-identifier" class="internal xref">CoRIM Identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-tags" class="internal xref">Tags</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-locator-map" class="internal xref">Locator Map</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.4">
                    <p id="section-toc.1-1.4.2.1.2.4.1"><a href="#section-4.1.4" class="auto internal xref">4.1.4</a>.  <a href="#name-profile-types" class="internal xref">Profile Types</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.5">
                    <p id="section-toc.1-1.4.2.1.2.5.1"><a href="#section-4.1.5" class="auto internal xref">4.1.5</a>.  <a href="#name-entities" class="internal xref">Entities</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-signed-corim" class="internal xref">Signed CoRIM</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-protected-header-map" class="internal xref">Protected Header Map</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-cwt-claims" class="internal xref">CWT Claims</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-meta-map" class="internal xref">Meta Map</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3.2.1">
                        <p id="section-toc.1-1.4.2.2.2.3.2.1.1"><a href="#section-4.2.3.1" class="auto internal xref">4.2.3.1</a>.  <a href="#name-signer-map" class="internal xref">Signer Map</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="auto internal xref">4.2.4</a>.  <a href="#name-unprotected-corim-header-ma" class="internal xref">Unprotected CoRIM Header Map</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-signer-authority-of-securel" class="internal xref">Signer authority of securely conveyed unsigned CoRIM</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-corim-collections" class="internal xref">CoRIM collections</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-concise-module-identifier-c" class="internal xref">Concise Module Identifier (CoMID)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-structure" class="internal xref">Structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-tag-identity" class="internal xref">Tag Identity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1.2.1">
                        <p id="section-toc.1-1.5.2.1.2.1.2.1.1"><a href="#section-5.1.1.1" class="auto internal xref">5.1.1.1</a>.  <a href="#name-tag-id" class="internal xref">Tag ID</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1.2.2">
                        <p id="section-toc.1-1.5.2.1.2.1.2.2.1"><a href="#section-5.1.1.2" class="auto internal xref">5.1.1.2</a>.  <a href="#name-tag-version" class="internal xref">Tag Version</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-entities-2" class="internal xref">Entities</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-linked-tag" class="internal xref">Linked Tag</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="auto internal xref">5.1.4</a>.  <a href="#name-triples" class="internal xref">Triples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1">
                        <p id="section-toc.1-1.5.2.1.2.4.2.1.1"><a href="#section-5.1.4.1" class="auto internal xref">5.1.4.1</a>.  <a href="#name-environments" class="internal xref">Environments</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.1">
                            <p id="section-toc.1-1.5.2.1.2.4.2.1.2.1.1"><a href="#section-5.1.4.1.1" class="auto internal xref">5.1.4.1.1</a>.  <a href="#name-environment-class" class="internal xref">Environment Class</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.2">
                            <p id="section-toc.1-1.5.2.1.2.4.2.1.2.2.1"><a href="#section-5.1.4.1.2" class="auto internal xref">5.1.4.1.2</a>.  <a href="#name-environment-instance" class="internal xref">Environment Instance</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.3">
                            <p id="section-toc.1-1.5.2.1.2.4.2.1.2.3.1"><a href="#section-5.1.4.1.3" class="auto internal xref">5.1.4.1.3</a>.  <a href="#name-environment-group" class="internal xref">Environment Group</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.4">
                            <p id="section-toc.1-1.5.2.1.2.4.2.1.2.4.1"><a href="#section-5.1.4.1.4" class="auto internal xref">5.1.4.1.4</a>.  <a href="#name-measurements" class="internal xref">Measurements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.1">
                                <p id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.1.1"><a href="#section-5.1.4.1.4.1" class="auto internal xref">5.1.4.1.4.1</a>.  <a href="#name-measurement-keys" class="internal xref">Measurement Keys</a></p>
</li>
                              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.2">
                                <p id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.2.1"><a href="#section-5.1.4.1.4.2" class="auto internal xref">5.1.4.1.4.2</a>.  <a href="#name-measurement-values" class="internal xref">Measurement Values</a></p>
</li>
                              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.3">
                                <p id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.3.1"><a href="#section-5.1.4.1.4.3" class="auto internal xref">5.1.4.1.4.3</a>.  <a href="#name-version" class="internal xref">Version</a></p>
</li>
                              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.4">
                                <p id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.4.1"><a href="#section-5.1.4.1.4.4" class="auto internal xref">5.1.4.1.4.4</a>.  <a href="#name-security-version-number" class="internal xref">Security Version Number</a></p>
</li>
                              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.5">
                                <p id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.5.1"><a href="#section-5.1.4.1.4.5" class="auto internal xref">5.1.4.1.4.5</a>.  <a href="#name-flags" class="internal xref">Flags</a></p>
</li>
                              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.6">
                                <p id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.6.1"><a href="#section-5.1.4.1.4.6" class="auto internal xref">5.1.4.1.4.6</a>.  <a href="#name-raw-values-types" class="internal xref">Raw Values Types</a></p>
</li>
                              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.7">
                                <p id="section-toc.1-1.5.2.1.2.4.2.1.2.4.2.7.1"><a href="#section-5.1.4.1.4.7" class="auto internal xref">5.1.4.1.4.7</a>.  <a href="#name-address-types" class="internal xref">Address Types</a></p>
</li>
                            </ul>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.5">
                            <p id="section-toc.1-1.5.2.1.2.4.2.1.2.5.1"><a href="#section-5.1.4.1.5" class="auto internal xref">5.1.4.1.5</a>.  <a href="#name-crypto-keys" class="internal xref">Crypto Keys</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.6">
                            <p id="section-toc.1-1.5.2.1.2.4.2.1.2.6.1"><a href="#section-5.1.4.1.6" class="auto internal xref">5.1.4.1.6</a>.  <a href="#name-integrity-registers" class="internal xref">Integrity Registers</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.1.2.7">
                            <p id="section-toc.1-1.5.2.1.2.4.2.1.2.7.1"><a href="#section-5.1.4.1.7" class="auto internal xref">5.1.4.1.7</a>.  <a href="#name-int-range" class="internal xref">Int Range</a></p>
</li>
                        </ul>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.2">
                        <p id="section-toc.1-1.5.2.1.2.4.2.2.1"><a href="#section-5.1.4.2" class="auto internal xref">5.1.4.2</a>.  <a href="#name-reference-values-triple" class="internal xref">Reference Values Triple</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.3">
                        <p id="section-toc.1-1.5.2.1.2.4.2.3.1"><a href="#section-5.1.4.3" class="auto internal xref">5.1.4.3</a>.  <a href="#name-endorsed-values-triple" class="internal xref">Endorsed Values Triple</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.4">
                        <p id="section-toc.1-1.5.2.1.2.4.2.4.1"><a href="#section-5.1.4.4" class="auto internal xref">5.1.4.4</a>.  <a href="#name-conditional-endorsement-tri" class="internal xref">Conditional Endorsement Triple</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.5">
                        <p id="section-toc.1-1.5.2.1.2.4.2.5.1"><a href="#section-5.1.4.5" class="auto internal xref">5.1.4.5</a>.  <a href="#name-conditional-endorsement-ser" class="internal xref">Conditional Endorsement Series Triple</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.6">
                        <p id="section-toc.1-1.5.2.1.2.4.2.6.1"><a href="#section-5.1.4.6" class="auto internal xref">5.1.4.6</a>.  <a href="#name-device-identity-triple" class="internal xref">Device Identity Triple</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.7">
                        <p id="section-toc.1-1.5.2.1.2.4.2.7.1"><a href="#section-5.1.4.7" class="auto internal xref">5.1.4.7</a>.  <a href="#name-attest-key-triple" class="internal xref">Attest Key Triple</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.8">
                        <p id="section-toc.1-1.5.2.1.2.4.2.8.1"><a href="#section-5.1.4.8" class="auto internal xref">5.1.4.8</a>.  <a href="#name-triples-for-domain-definiti" class="internal xref">Triples for domain definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.8.2.1">
                            <p id="section-toc.1-1.5.2.1.2.4.2.8.2.1.1"><a href="#section-5.1.4.8.1" class="auto internal xref">5.1.4.8.1</a>.  <a href="#name-domain-membership-triple" class="internal xref">Domain Membership Triple</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.8.2.2">
                            <p id="section-toc.1-1.5.2.1.2.4.2.8.2.2.1"><a href="#section-5.1.4.8.2" class="auto internal xref">5.1.4.8.2</a>.  <a href="#name-domain-dependency-triple" class="internal xref">Domain Dependency Triple</a></p>
</li>
                        </ul>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4.2.9">
                        <p id="section-toc.1-1.5.2.1.2.4.2.9.1"><a href="#section-5.1.4.9" class="auto internal xref">5.1.4.9</a>.  <a href="#name-comid-coswid-linking-triple" class="internal xref">CoMID-CoSWID Linking Triple</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-extensibility" class="internal xref">Extensibility</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-map-extensions" class="internal xref">Map Extensions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-data-type-extensions" class="internal xref">Data Type Extensions</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-cotl" class="internal xref">CoTL</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-structure-2" class="internal xref">Structure</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-common-types" class="internal xref">Common Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-non-empty" class="internal xref">Non-Empty</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-entity" class="internal xref">Entity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-validity" class="internal xref">Validity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-uuid" class="internal xref">UUID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-ueid" class="internal xref">UEID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-oid" class="internal xref">OID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-digest" class="internal xref">Digest</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="auto internal xref">7.8</a>.  <a href="#name-tagged-bytes-type" class="internal xref">Tagged Bytes Type</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-appraisal-of-corim-based-in" class="internal xref">Appraisal of CoRIM-based Inputs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-appraisal-procedure" class="internal xref">Appraisal Procedure</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-reference-verifier-algorith" class="internal xref">Reference Verifier Algorithm</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-internal-representation-of-" class="internal xref">Internal Representation of Conceptual Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="auto internal xref">9.1.1</a>.  <a href="#name-internal-structure-of-ect" class="internal xref">Internal structure of ECT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-9.1.2" class="auto internal xref">9.1.2</a>.  <a href="#name-internal-representation-of-c" class="internal xref">Internal Representation of Cryptographic Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a href="#section-9.1.3" class="auto internal xref">9.1.3</a>.  <a href="#name-internal-representation-of-e" class="internal xref">Internal Representation of Evidence</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.4">
                    <p id="section-toc.1-1.9.2.1.2.4.1"><a href="#section-9.1.4" class="auto internal xref">9.1.4</a>.  <a href="#name-internal-representation-of-r" class="internal xref">Internal Representation of Reference Values</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.5">
                    <p id="section-toc.1-1.9.2.1.2.5.1"><a href="#section-9.1.5" class="auto internal xref">9.1.5</a>.  <a href="#name-internal-representation-of-en" class="internal xref">Internal Representation of Endorsed Values</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.6">
                    <p id="section-toc.1-1.9.2.1.2.6.1"><a href="#section-9.1.6" class="auto internal xref">9.1.6</a>.  <a href="#name-internal-representation-of-d" class="internal xref">Internal Representation of Domain Membership</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.7">
                    <p id="section-toc.1-1.9.2.1.2.7.1"><a href="#section-9.1.7" class="auto internal xref">9.1.7</a>.  <a href="#name-internal-representation-of-p" class="internal xref">Internal Representation of Policy Statements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.8">
                    <p id="section-toc.1-1.9.2.1.2.8.1"><a href="#section-9.1.8" class="auto internal xref">9.1.8</a>.  <a href="#name-internal-representation-of-a" class="internal xref">Internal Representation of Attestation Results</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.9">
                    <p id="section-toc.1-1.9.2.1.2.9.1"><a href="#section-9.1.9" class="auto internal xref">9.1.9</a>.  <a href="#name-internal-representation-of-ap" class="internal xref">Internal Representation of Appraisal Claims Set (ACS)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.10">
                    <p id="section-toc.1-1.9.2.1.2.10.1"><a href="#section-9.1.10" class="auto internal xref">9.1.10</a>. <a href="#name-internal-representation-of-at" class="internal xref">Internal Representation of Attestation Results Set (ARS)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-input-validation-and-transf" class="internal xref">Input Validation and Transformation (Phase 1)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-9.2.1" class="auto internal xref">9.2.1</a>.  <a href="#name-input-validation" class="internal xref">Input Validation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1.2.1">
                        <p id="section-toc.1-1.9.2.2.2.1.2.1.1"><a href="#section-9.2.1.1" class="auto internal xref">9.2.1.1</a>.  <a href="#name-corim-selection" class="internal xref">CoRIM Selection</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1.2.2">
                        <p id="section-toc.1-1.9.2.2.2.1.2.2.1"><a href="#section-9.2.1.2" class="auto internal xref">9.2.1.2</a>.  <a href="#name-corim-trust-anchors" class="internal xref">CoRIM Trust Anchors</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1.2.3">
                        <p id="section-toc.1-1.9.2.2.2.1.2.3.1"><a href="#section-9.2.1.3" class="auto internal xref">9.2.1.3</a>.  <a href="#name-tags-extraction-and-validat" class="internal xref">Tags Extraction and Validation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1.2.4">
                        <p id="section-toc.1-1.9.2.2.2.1.2.4.1"><a href="#section-9.2.1.4" class="auto internal xref">9.2.1.4</a>.  <a href="#name-cotl-extraction" class="internal xref">CoTL Extraction</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-9.2.2" class="auto internal xref">9.2.2</a>.  <a href="#name-evidence-collection" class="internal xref">Evidence Collection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.2.2.1">
                        <p id="section-toc.1-1.9.2.2.2.2.2.1.1"><a href="#section-9.2.2.1" class="auto internal xref">9.2.2.1</a>.  <a href="#name-cryptographic-validation-of" class="internal xref">Cryptographic Validation of Evidence</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#section-9.2.3" class="auto internal xref">9.2.3</a>.  <a href="#name-input-transformation" class="internal xref">Input Transformation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3.2.1">
                        <p id="section-toc.1-1.9.2.2.2.3.2.1.1"><a href="#section-9.2.3.1" class="auto internal xref">9.2.3.1</a>.  <a href="#name-appraisal-context-construct" class="internal xref">Appraisal Context Construction</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3.2.2">
                        <p id="section-toc.1-1.9.2.2.2.3.2.2.1"><a href="#section-9.2.3.2" class="auto internal xref">9.2.3.2</a>.  <a href="#name-evidence-tranformation" class="internal xref">Evidence Tranformation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3.2.3">
                        <p id="section-toc.1-1.9.2.2.2.3.2.3.1"><a href="#section-9.2.3.3" class="auto internal xref">9.2.3.3</a>.  <a href="#name-reference-triples-transform" class="internal xref">Reference Triples Transformation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3.2.4">
                        <p id="section-toc.1-1.9.2.2.2.3.2.4.1"><a href="#section-9.2.3.4" class="auto internal xref">9.2.3.4</a>.  <a href="#name-endorsement-triples-transfo" class="internal xref">Endorsement Triples Transformations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3.2.4.2.1">
                            <p id="section-toc.1-1.9.2.2.2.3.2.4.2.1.1"><a href="#section-9.2.3.4.1" class="auto internal xref">9.2.3.4.1</a>.  <a href="#name-endorsed-values-triple-tran" class="internal xref">Endorsed Values Triple Transformation</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3.2.4.2.2">
                            <p id="section-toc.1-1.9.2.2.2.3.2.4.2.2.1"><a href="#section-9.2.3.4.2" class="auto internal xref">9.2.3.4.2</a>.  <a href="#name-conditional-endorsement-trip" class="internal xref">Conditional Endorsement Triple Transformation</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3.2.4.2.3">
                            <p id="section-toc.1-1.9.2.2.2.3.2.4.2.3.1"><a href="#section-9.2.3.4.3" class="auto internal xref">9.2.3.4.3</a>.  <a href="#name-conditional-endorsement-seri" class="internal xref">Conditional Endorsement Series Triple Transformation</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3.2.4.2.4">
                            <p id="section-toc.1-1.9.2.2.2.3.2.4.2.4.1"><a href="#section-9.2.3.4.4" class="auto internal xref">9.2.3.4.4</a>.  <a href="#name-key-verification-triples-tr" class="internal xref">Key Verification Triples Transformation</a></p>
</li>
                        </ul>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3.2.5">
                        <p id="section-toc.1-1.9.2.2.2.3.2.5.1"><a href="#section-9.2.3.5" class="auto internal xref">9.2.3.5</a>.  <a href="#name-domain-membership-triples-t" class="internal xref">Domain Membership Triples Transformation</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-acs-augmentation-phases-2-3" class="internal xref">ACS Augmentation - Phases 2, 3, and 4</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#section-9.3.1" class="auto internal xref">9.3.1</a>.  <a href="#name-acs-requirements" class="internal xref">ACS Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1.2.1">
                        <p id="section-toc.1-1.9.2.3.2.1.2.1.1"><a href="#section-9.3.1.1" class="auto internal xref">9.3.1.1</a>.  <a href="#name-acs-processing-requirements" class="internal xref">ACS Processing Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1.2.1.2.1">
                            <p id="section-toc.1-1.9.2.3.2.1.2.1.2.1.1"><a href="#section-9.3.1.1.1" class="auto internal xref">9.3.1.1.1</a>.  <a href="#name-ordering-of-triple-processi" class="internal xref">Ordering of triple processing</a></p>
</li>
                        </ul>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1.2.2">
                        <p id="section-toc.1-1.9.2.3.2.1.2.2.1"><a href="#section-9.3.1.2" class="auto internal xref">9.3.1.2</a>.  <a href="#name-acs-augmentation-requiremen" class="internal xref">ACS Augmentation Requirements</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a href="#section-9.3.2" class="auto internal xref">9.3.2</a>.  <a href="#name-evidence-augmentation-phase" class="internal xref">Evidence Augmentation (Phase 2)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.2.2.1">
                        <p id="section-toc.1-1.9.2.3.2.2.2.1.1"><a href="#section-9.3.2.1" class="auto internal xref">9.3.2.1</a>.  <a href="#name-appraisal-claims-set-initia" class="internal xref">Appraisal Claims Set Initialization</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.2.2.2">
                        <p id="section-toc.1-1.9.2.3.2.2.2.2.1"><a href="#section-9.3.2.2" class="auto internal xref">9.3.2.2</a>.  <a href="#name-the-authority-field-in-the-" class="internal xref">The authority field in the ACS</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.2.2.3">
                        <p id="section-toc.1-1.9.2.3.2.2.2.3.1"><a href="#section-9.3.2.3" class="auto internal xref">9.3.2.3</a>.  <a href="#name-acs-augmentation-using-comi" class="internal xref">ACS augmentation using CoMID triples</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.3">
                    <p id="section-toc.1-1.9.2.3.2.3.1"><a href="#section-9.3.3" class="auto internal xref">9.3.3</a>.  <a href="#name-reference-values-corroborat" class="internal xref">Reference Values Corroboration and Augmentation (Phase 3)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.4">
                    <p id="section-toc.1-1.9.2.3.2.4.1"><a href="#section-9.3.4" class="auto internal xref">9.3.4</a>.  <a href="#name-endorsed-values-augmentatio" class="internal xref">Endorsed Values Augmentation (Phase 4)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.4.2.1">
                        <p id="section-toc.1-1.9.2.3.2.4.2.1.1"><a href="#section-9.3.4.1" class="auto internal xref">9.3.4.1</a>.  <a href="#name-processing-endorsements" class="internal xref">Processing Endorsements</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.4.2.2">
                        <p id="section-toc.1-1.9.2.3.2.4.2.2.1"><a href="#section-9.3.4.2" class="auto internal xref">9.3.4.2</a>.  <a href="#name-processing-conditional-endo" class="internal xref">Processing Conditional Endorsements</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.4.2.3">
                        <p id="section-toc.1-1.9.2.3.2.4.2.3.1"><a href="#section-9.3.4.3" class="auto internal xref">9.3.4.3</a>.  <a href="#name-processing-conditional-endor" class="internal xref">Processing Conditional Endorsement Series</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.4.2.4">
                        <p id="section-toc.1-1.9.2.3.2.4.2.4.1"><a href="#section-9.3.4.4" class="auto internal xref">9.3.4.4</a>.  <a href="#name-processing-key-verification" class="internal xref">Processing Key Verification Endorsements</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.4.2.5">
                        <p id="section-toc.1-1.9.2.3.2.4.2.5.1"><a href="#section-9.3.4.5" class="auto internal xref">9.3.4.5</a>.  <a href="#name-processing-domain-membershi" class="internal xref">Processing Domain Membership</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.5">
                    <p id="section-toc.1-1.9.2.3.2.5.1"><a href="#section-9.3.5" class="auto internal xref">9.3.5</a>.  <a href="#name-examples-for-optional-phase" class="internal xref">Examples for optional phases 5, 6, and 7</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-comparing-a-condition-ect-a" class="internal xref">Comparing a condition ECT against the ACS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.1">
                    <p id="section-toc.1-1.9.2.4.2.1.1"><a href="#section-9.4.1" class="auto internal xref">9.4.1</a>.  <a href="#name-comparing-a-condition-ect-ag" class="internal xref">Comparing a condition ECT against a single ACS entry</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.2">
                    <p id="section-toc.1-1.9.2.4.2.2.1"><a href="#section-9.4.2" class="auto internal xref">9.4.2</a>.  <a href="#name-environment-comparison" class="internal xref">Environment Comparison</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.3">
                    <p id="section-toc.1-1.9.2.4.2.3.1"><a href="#section-9.4.3" class="auto internal xref">9.4.3</a>.  <a href="#name-authority-comparison" class="internal xref">Authority comparison</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.4">
                    <p id="section-toc.1-1.9.2.4.2.4.1"><a href="#section-9.4.4" class="auto internal xref">9.4.4</a>.  <a href="#name-element-list-comparison" class="internal xref">Element list comparison</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.5">
                    <p id="section-toc.1-1.9.2.4.2.5.1"><a href="#section-9.4.5" class="auto internal xref">9.4.5</a>.  <a href="#name-element-map-comparison" class="internal xref">Element map comparison</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.6">
                    <p id="section-toc.1-1.9.2.4.2.6.1"><a href="#section-9.4.6" class="auto internal xref">9.4.6</a>.  <a href="#name-measurement-values-map-map-" class="internal xref">Measurement values map map Comparison</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.6.2.1">
                        <p id="section-toc.1-1.9.2.4.2.6.2.1.1"><a href="#section-9.4.6.1" class="auto internal xref">9.4.6.1</a>.  <a href="#name-comparison-of-a-single-meas" class="internal xref">Comparison of a single measurement-values-map codepoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.6.2.1.2.1">
                            <p id="section-toc.1-1.9.2.4.2.6.2.1.2.1.1"><a href="#section-9.4.6.1.1" class="auto internal xref">9.4.6.1.1</a>.  <a href="#name-comparison-for-version-entr" class="internal xref">Comparison for version entries</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.6.2.1.2.2">
                            <p id="section-toc.1-1.9.2.4.2.6.2.1.2.2.1"><a href="#section-9.4.6.1.2" class="auto internal xref">9.4.6.1.2</a>.  <a href="#name-comparison-for-svn-entries" class="internal xref">Comparison for svn entries</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.6.2.1.2.3">
                            <p id="section-toc.1-1.9.2.4.2.6.2.1.2.3.1"><a href="#section-9.4.6.1.3" class="auto internal xref">9.4.6.1.3</a>.  <a href="#name-comparison-for-digests-entr" class="internal xref">Comparison for digests entries</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.6.2.1.2.4">
                            <p id="section-toc.1-1.9.2.4.2.6.2.1.2.4.1"><a href="#section-9.4.6.1.4" class="auto internal xref">9.4.6.1.4</a>.  <a href="#name-comparison-for-raw-value-en" class="internal xref">Comparison for raw-value entries</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.6.2.1.2.5">
                            <p id="section-toc.1-1.9.2.4.2.6.2.1.2.5.1"><a href="#section-9.4.6.1.5" class="auto internal xref">9.4.6.1.5</a>.  <a href="#name-comparison-for-cryptokeys-e" class="internal xref">Comparison for cryptokeys entries</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.6.2.1.2.6">
                            <p id="section-toc.1-1.9.2.4.2.6.2.1.2.6.1"><a href="#section-9.4.6.1.6" class="auto internal xref">9.4.6.1.6</a>.  <a href="#name-comparison-for-integrity-re" class="internal xref">Comparison for Integrity Registers</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.6.2.1.2.7">
                            <p id="section-toc.1-1.9.2.4.2.6.2.1.2.7.1"><a href="#section-9.4.6.1.7" class="auto internal xref">9.4.6.1.7</a>.  <a href="#name-comparison-for-int-range-en" class="internal xref">Comparison for int-range entries</a></p>
</li>
                        </ul>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.7">
                    <p id="section-toc.1-1.9.2.4.2.7.1"><a href="#section-9.4.7" class="auto internal xref">9.4.7</a>.  <a href="#name-profile-directed-comparison" class="internal xref">Profile-directed Comparison</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-veraison" class="internal xref">Veraison</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-security-and-privacy-consid" class="internal xref">Security and Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-new-cose-header-parameters" class="internal xref">New COSE Header Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-new-cbor-tags" class="internal xref">New CBOR Tags</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-corim-map-registry" class="internal xref">CoRIM Map Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-corim-entity-map-registry" class="internal xref">CoRIM Entity Map Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-corim-signer-map-registry" class="internal xref">CoRIM Signer Map Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#section-12.6" class="auto internal xref">12.6</a>.  <a href="#name-comid-map-registry" class="internal xref">CoMID Map Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a href="#section-12.7" class="auto internal xref">12.7</a>.  <a href="#name-comid-entity-map-registry" class="internal xref">CoMID Entity Map Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.8">
                <p id="section-toc.1-1.12.2.8.1"><a href="#section-12.8" class="auto internal xref">12.8</a>.  <a href="#name-comid-triples-map-registry" class="internal xref">CoMID Triples Map Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.9">
                <p id="section-toc.1-1.12.2.9.1"><a href="#section-12.9" class="auto internal xref">12.9</a>.  <a href="#name-comid-measurement-values-ma" class="internal xref">CoMID Measurement Values Map Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.10">
                <p id="section-toc.1-1.12.2.10.1"><a href="#section-12.10" class="auto internal xref">12.10</a>. <a href="#name-comid-flags-map-registry" class="internal xref">CoMID Flags Map Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.11">
                <p id="section-toc.1-1.12.2.11.1"><a href="#section-12.11" class="auto internal xref">12.11</a>. <a href="#name-cotl-map-registry" class="internal xref">CoTL Map Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.12">
                <p id="section-toc.1-1.12.2.12.1"><a href="#section-12.12" class="auto internal xref">12.12</a>. <a href="#name-new-media-types" class="internal xref">New Media Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.12.2.1">
                    <p id="section-toc.1-1.12.2.12.2.1.1"><a href="#section-12.12.1" class="auto internal xref">12.12.1</a>.  <a href="#name-rimcbor" class="internal xref">rim+cbor</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.12.2.2">
                    <p id="section-toc.1-1.12.2.12.2.2.1"><a href="#section-12.12.2" class="auto internal xref">12.12.2</a>.  <a href="#name-rimcose" class="internal xref">rim+cose</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.13">
                <p id="section-toc.1-1.12.2.13.1"><a href="#section-12.13" class="auto internal xref">12.13</a>. <a href="#name-coap-content-formats-regist" class="internal xref">CoAP Content-Formats Registration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-base-corim-cddl" class="internal xref">Base CoRIM CDDL</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec-intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The RATS Architecture <span><a href="https://rfc-editor.org/rfc/rfc9334#section-4" class="relref">Section 4</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> specifies several roles, including Endorsers and Reference Value Providers.
These two roles are typically fulfilled by supply chain actors, such as manufacturers, distributors, or device owners.
Endorsers and Reference Value Providers supply Endorsements (e.g., test results or certification data) and Reference Values (e.g., digest ) relating to an Attester.
This information is used by a Verifier to appraise Evidence received from an Attester which describes Attester operational state.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">In a complex supply chain, multiple actors will likely produce these values over several points in time.
As such, one supply chain actor might only supply a portion of the Reference Values or Endorsements that otherwise fully characterizes an Attester.
Ideally, only the supply chain actor who is the most knowledgable entity regarding a particular component will supply Reference Values or Endorsements for that component.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Attesters vary across vendors and even across products from a single vendor.
Not only Attesters can evolve and therefore new measurement types need to be expressed, but an Endorser may also want to provide new security relevant attributes about an Attester at a future point in time.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">In order to promote inter-operability, consistency and accuracy in the representation of Endorsements and Reference Values this document specifies a data model for Endorsements and Reference Values known as Concise Reference Integrity Manifests (CoRIM).
The CoRIM data model is expressed in CDDL which is used to realize a CBOR <span>[<a href="#STD94" class="cite xref">STD94</a>]</span> encoding suitable for cryptographic operations (e.g., hashing, signing, encryption) and transmission over computer networks.
Additionally, this document describes multiple phases of a Verifier Appraisal and provides an example of a possible use of CoRIM messages from multiple supply chain actors to represent a homogeneous representation of Attester state.
CoRIM is extensible to accommodate supply chain diversity while supporting a common representation for Endorsement and Reference Value inputs to Verifiers.
See <a href="#sec-verifier-rec" class="auto internal xref">Section 2</a>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="terminology-and-requirements-language">
<section id="section-1.1">
        <h3 id="name-terminology-and-requirement">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology-and-requirement" class="section-name selfRef">Terminology and Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This document uses terms and concepts defined by the RATS architecture.
Specifically the terms Attester, Reference Value Provider, Endorser, Verifier Owner, and Relying Party are taken from <span><a href="https://rfc-editor.org/rfc/rfc9334#section-4" class="relref">Section 4</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">For a complete glossary, see <span><a href="https://rfc-editor.org/rfc/rfc9334#section-4" class="relref">Section 4</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">This document uses the terms <em>"actual state"</em> and <em>"reference state"</em> as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-endorsements-07#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-rats-endorsements" class="cite xref">I-D.ietf-rats-endorsements</a>]</span>.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">In this document, the term CoRIM message and CoRIM documents are used as synonyms. A CoRIM data structure can be at rest (e.g., residing in a file system as a document) or can be in flight (e.g., conveyed as a message in a protocol exchange). The bytes composing the CoRIM data structure are the same either way.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">The terminology from CBOR <span>[<a href="#STD94" class="cite xref">STD94</a>]</span>, CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> and COSE <span>[<a href="#STD96" class="cite xref">STD96</a>]</span> applies;
in particular, CBOR diagnostic notation is defined in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-8" class="relref">Section 8</a> of [<a href="#STD94" class="cite xref">STD94</a>]</span>
and <span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>. Terms and concepts are always referenced as proper nouns, i.e., with Capital Letters.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<div id="sec-glossary">
<section id="section-1.1.1">
          <h4 id="name-glossary">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-glossary" class="section-name selfRef">Glossary</a>
          </h4>
<p id="section-1.1.1-1">This document uses the following terms:<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.1.1-2">
            <dt id="section-1.1.1-2.1">Appraisal Claims Set (ACS):</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.2">
              <p id="section-1.1.1-2.2.1">A structure that holds Environment-Claim Tuples that have been appraised.
The ACS contains Attester state that has been authorized by Verifier processing and Appraisal Policy.<a href="#section-1.1.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.3">Appraisal Policy:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.4">
              <p id="section-1.1.1-2.4.1">A description of the conditions that, if met, allow appraisal of Claims.
Typically, the entity asserting a Claim should have knowledge, expertise, or context that gives credibility to the assertion.
Appraisal Policy resolves which entities are credible and under what conditions.
See also "Appraisal Policy for Evidence" in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-1.1.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.5">Attestation Results Set (ARS):</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.6">
              <p id="section-1.1.1-2.6.1">A structure that holds results of appraisal and Environment-Claim Tuples that are used to construct an Attestation Results message that is conveyed to a Relying Party.<a href="#section-1.1.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.7">Authority:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.8">
              <p id="section-1.1.1-2.8.1">The entity asserting that a Claim is true.
Typically, a Claim is asserted using a cryptographic key to digitally sign the Claim.
A cryptographic key can be a proxy for a human or organizational entity.<a href="#section-1.1.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.9">Claim:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.10">
              <p id="section-1.1.1-2.10.1">A piece of information, in the form of a key-value pair.
See also <span><a href="https://rfc-editor.org/rfc/rfc9334#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc7519#section-2" class="relref">Section 2</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-1.1.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.11">Class ID:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.12">
              <p id="section-1.1.1-2.12.1">An identifier for an Environment that is shared among similar Environment instances, such as those with the same hardware assembly.
See also <span><a href="https://rfc-editor.org/rfc/rfc9711#section-4.2.4" class="relref">Section 4.2.4</a> of [<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>.<a href="#section-1.1.1-2.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.13">Composite Attester:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.14">
              <p id="section-1.1.1-2.14.1">A Composite Attester is either a Composite Device (<span><a href="https://rfc-editor.org/rfc/rfc9334#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) or a Layered Attester (<span><a href="https://rfc-editor.org/rfc/rfc9334#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) or any composition involving a combination of one or more Composite Devices or Layered Attesters.<a href="#section-1.1.1-2.14.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.15">Domain:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.16">
              <p id="section-1.1.1-2.16.1">A domain is a hierarchical description of a Composite Attester in terms of its constituent Environments and their compositional relationships.<a href="#section-1.1.1-2.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.17">Endorsed values:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.18">
              <p id="section-1.1.1-2.18.1">A set of characteristics of an Attester that do not appear in Evidence.
For example, Endorsed Values may include testing or certification data related to a hardware or firmware module.
Endorsed Values are said to be "conditional" when they apply if Attester's actual state matches Verifier's accepted Claims.
See also <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-endorsements-07#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-rats-endorsements" class="cite xref">I-D.ietf-rats-endorsements</a>]</span>.<a href="#section-1.1.1-2.18.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.19">Environment:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.20">
              <p id="section-1.1.1-2.20.1">A logical partition within an Attester.
The term "Target Environment" refers to the group of system security metrics that are reported through Evidence.
The term "Attesting Environment" refers to the entity that collects and cryptographically signs such security metrics.
See also <span><a href="https://rfc-editor.org/rfc/rfc9334#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-1.1.1-2.20.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.21">Environment-Claim Tuple (ECT):</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.22">
              <p id="section-1.1.1-2.22.1">A structure containing a set of values that describe a Target Environment plus a set of Measurement / Claim values that describe properties of the Target Environment.
The ECT also contains Authority which identifies the entity that authored the ECT.<a href="#section-1.1.1-2.22.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.23">Instance ID:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.24">
              <p id="section-1.1.1-2.24.1">An identifier of an Environment that is unique to that Environment instance, such as the serial number of a hardware module.
See also <span><a href="https://rfc-editor.org/rfc/rfc9711#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>.<a href="#section-1.1.1-2.24.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.25">Measurement:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.26">
              <p id="section-1.1.1-2.26.1">A value associated with specific security characteristics of an Attester that influences the trustworthiness of that Attester.
The object of a Measurement could be the invariant part of a firmware component loaded into memory during startup, a run-time integrity check (RTIC), a file system object, or a CPU register.
A measured object is part of the Attester's Target Environment.
Expected, or "golden," Measurements are compiled as Reference Values, which are used by the Verifier to assess the trust state of the Attester.
See also <span>[<a href="#TNC.Arch" class="cite xref">TNC.Arch</a>]</span>, and Section 9.5.5 of <span>[<a href="#TPM2.Part1" class="cite xref">TPM2.Part1</a>]</span>.<a href="#section-1.1.1-2.26.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.27">Reference Values:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.28">
              <p id="section-1.1.1-2.28.1">A set of values that represent the desired or undesired state of an Attester.
Reference Values are compared against Evidence to determine whether Attester state is corroborated by a Reference Value Provider.
Reference Values with matching Evidence produce "acceptable Claims."
See also <span><a href="https://rfc-editor.org/rfc/rfc9334#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, <span><a href="https://rfc-editor.org/rfc/rfc9334#section-8.3" class="relref">Section 8.3</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, and <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-endorsements-07#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-rats-endorsements" class="cite xref">I-D.ietf-rats-endorsements</a>]</span>.<a href="#section-1.1.1-2.28.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-2.29">Triple:</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-2.30">
              <p id="section-1.1.1-2.30.1">A term derived from the Resource Description Framework (RDF) to mean a statement expressing a relationship between a subject and an object resource.
The nature of the relationship between subject and object is expressed via a predicate.
In CoRIM, unlike RDF, the predicate of the triple is implicit and is encoded in the triple's name/codepoint.
CoRIM triples typically represent assertions made by the CoRIM author regarding Attesting or Target Environments and their security features, such as Measurements and cryptographic key material.
See also Section 3.1 of <span>[<a href="#W3C.rdf11-primer" class="cite xref">W3C.rdf11-primer</a>]</span>.<a href="#section-1.1.1-2.30.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-verifier-rec">
<section id="section-2">
      <h2 id="name-verifier-reconciliation">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-verifier-reconciliation" class="section-name selfRef">Verifier Reconciliation</a>
      </h2>
<p id="section-2-1">This specification describes the CoRIM format and documents how a Verifier must process the CoRIM.
This ensures that the behaviour of the CoRIM-based appraisal is predictable and consistent, in a word deterministic.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">A Verifier needs to reconcile its various inputs, with CoRIM being one of them.
In addition to the external CoRIM documents, the Verifier is expected to create an internal representation for each input and map each external representation to an internal one.
By using the internal representation, the Verifier processes inputs as if they are part of a conversation, keeping track of who said what.
The origin of the inputs is tracked as <em>authority</em>.
The authority for the Claims in a CoRIM is the CoRIM issuer.
To this effect, this specification defines one possible internal representation of the attester's actual state for use during the appraisal procedure, known as Appraisal Claims Set (ACS).<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Effectively, Attesters, Reference Value Providers, Endorsers, Verifier Owners, Relying Parties, and even the Verifier potentially all contribute to the conversation.
Each producer of corresponding RATS Conceptual Messages can assert Claims about an Attester's actual or allowed state.
The Verifier's objective is to produce a list of Claims that describe the Attester's presumed actual state.
Producers of RATS Conceptual Messages can assert contradictory assertions.
For example, a compromised Attester may produce false claims that conflict with the Reference Values provided by a Reference Value Provider (RVP).
In essence, if Evidence is not corroborated by an RVP's Claims, then the RVP's Claims are not included in the ACS. Please see <a href="#fig-verifier-internal" class="auto internal xref">Figure 1</a>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">A Verifier relies on input from appraisal policy to identify relevant assertions included in the ACS.
For example, if a policy requires corroborated assertions issued by a particular RVP, then those assertions may be conveyed as Attestation Results.
The Verifier may produce new assertions as a result of an applied appraisal policy.
For example, if an appraisal procedure finds all of the components of a subsystem are configured correctly, the policy may direct the Verifier to produce new assertions, "Subsystem=X" has the Claim "TRUSTED=TRUE".
Consequently, the internal ACS structure is a reconciled conversation between several producers of RATS Conceptual Messages that has mapped each message into a consistent internal representation, has associated the identity of the corresponding RATS role with each assertion (the authority), and has applied Conceptual Message constraints to the assertion.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">The CoRIM data model specified in this document covers the RATS Conceptual Message types, "Reference Values" and "Endorsements".
Reference values and Endorsements are required for Verifier reconciliation, and Evidence is required for corresponding internal ACS creation as illustrated in <a href="#sec-interact-acs" class="auto internal xref">Section 2.2</a>.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="sec-internal-rep">
<section id="section-2.1">
        <h3 id="name-internal-representation">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-internal-representation" class="section-name selfRef">Internal Representation</a>
        </h3>
<p id="section-2.1-1">In this document CDDL is used to specify both the CoRIM structure and to specify an internal representation for use in the appraisal procedure.
The actual internal representation of a Verifier is implementation-specific and out-of-scope of this document.
Requirements for an internal representation of Conceptual Messages are defined in <a href="#tbl-cmrr" class="auto internal xref">Table 1</a>, where each Conceptual Message type has a structure as depicted by the <em>Structure</em> column.
The internal representations used by this document are defined in <a href="#sec-ir-cm" class="auto internal xref">Section 9.1</a>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-interact-acs">
<section id="section-2.2">
        <h3 id="name-interacting-with-an-acs">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-interacting-with-an-acs" class="section-name selfRef">Interacting with an ACS</a>
        </h3>
<p id="section-2.2-1">Conceptual Messages interact with an ACS by specifying criteria that should be met by the ACS and by presenting the assertions that should be added to the ACS if the criteria are satisfied.
The processing sequence of Conceptual Message interaction with ACS is guided by <a href="#sec-appraisal-procedure" class="auto internal xref">Section 8.1</a>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">Internal representations of Conceptual Messages, ACS, and Attestation Results Set (ARS) SHOULD satisfy the following requirements for Verifier reconciliation and appraisal processing:<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<span id="name-conceptual-message-represen"></span><div id="tbl-cmrr">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-conceptual-message-represen" class="selfRef">Conceptual Message Representation Requirements</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">CM Type</th>
              <th class="text-left" rowspan="1" colspan="1">Structure</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Evidence</td>
              <td class="text-left" rowspan="1" colspan="1">List of Evidence claims</td>
              <td class="text-left" rowspan="1" colspan="1">If the Attester is authenticated, add Evidence claims to the ACS with Attester authority</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Reference Values</td>
              <td class="text-left" rowspan="1" colspan="1">List of Reference Values claims</td>
              <td class="text-left" rowspan="1" colspan="1">If a reference value in a CoRIM matches claims in the ACS, then the authority of the CoRIM issuer is added to those claims.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Endorsements</td>
              <td class="text-left" rowspan="1" colspan="1">List of expected actual state claims, List of Endorsed Values claims</td>
              <td class="text-left" rowspan="1" colspan="1">If the list of expected claims are in the ACS, then add the list of Endorsed Values claims to the ACS with Endorser authority</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Series Endorsements</td>
              <td class="text-left" rowspan="1" colspan="1">List of expected actual state claims and a series of selection-addition tuples</td>
              <td class="text-left" rowspan="1" colspan="1">If the expected claims are in the ACS, and if the series selection condition is satisfied, then add the additional claims to the ACS with Endorser authority. See <a href="#sec-ir-end-val" class="auto internal xref">Section 9.1.5</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Verifier</td>
              <td class="text-left" rowspan="1" colspan="1">List of expected actual state claims, List of Verifier-generated claims</td>
              <td class="text-left" rowspan="1" colspan="1">If the list of expected claims are in the ACS, then add the list of Verifier-generated claims to the ACS with Verifier authority</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Policy</td>
              <td class="text-left" rowspan="1" colspan="1">List of expected actual state claims, List of Policy-generated claims</td>
              <td class="text-left" rowspan="1" colspan="1">If the list of expected claims are in the ACS, then add the list of Policy-generated claims to the ACS with Policy Owner authority</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Attestation Results</td>
              <td class="text-left" rowspan="1" colspan="1">List of expected actual state claims, List of expected Attestation Results claims</td>
              <td class="text-left" rowspan="1" colspan="1">If the list of expected claims are in the ACS, then copy the list of Attestation Results claims into the ARS. See <a href="#sec-ir-ars" class="auto internal xref">Section 9.1.10</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-quantize">
<section id="section-2.3">
        <h3 id="name-quantizing-inputs">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-quantizing-inputs" class="section-name selfRef">Quantizing Inputs</a>
        </h3>
<p id="section-2.3-1"><span class="cref" id="tracked-at">Tracked at:</span> https://github.com/ietf-rats-wg/draft-ietf-rats-corim/issues/242<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-type-conv">
<section id="section-3">
      <h2 id="name-typographical-conventions-f">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-typographical-conventions-f" class="section-name selfRef">Typographical Conventions for CDDL</a>
      </h2>
<p id="section-3-1">The CDDL definitions in this document follows the naming conventions illustrated in <a href="#tbl-typography" class="auto internal xref">Table 2</a>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-type-traits-and-typographic"></span><div id="tbl-typography">
<table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-type-traits-and-typographic" class="selfRef">Type Traits and Typographical Conventions</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Type trait</th>
            <th class="text-left" rowspan="1" colspan="1">Example</th>
            <th class="text-left" rowspan="1" colspan="1">Typographical convention</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">extensible type choice</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>int / text / ...</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>$</code>NAME<code>-type-choice</code>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">closed type choice</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>int / text</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">NAME<code>-type-choice</code>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">group choice</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>( 1 =&gt; int // 2 =&gt; text )</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>$$</code>NAME<code>-group-choice</code>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">group</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>( 1 =&gt; int, 2 =&gt; text )</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">NAME<code>-group</code>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">type</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>int</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">NAME<code>-type</code>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">tagged type</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>#6.123(int)</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>tagged-</code>NAME<code>-type</code>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">map</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>{ 1 =&gt; int, 2 =&gt; text }</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">NAME-<code>map</code>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">flags</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>&amp;( a: 1, b: 2 )</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">NAME-<code>flags</code>
</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="sec-corim">
<section id="section-4">
      <h2 id="name-concise-reference-integrity">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-concise-reference-integrity" class="section-name selfRef">Concise Reference Integrity Manifest (CoRIM)</a>
      </h2>
<p id="section-4-1">A CoRIM is a collection of tags and related metadata in a concise CBOR <span>[<a href="#STD94" class="cite xref">STD94</a>]</span> encoding.
A CoRIM can be digitally signed with a COSE <span>[<a href="#STD96" class="cite xref">STD96</a>]</span> signature.
A tag is a structured, machine-readable data format used to uniquely identify, describe, and manage modules or components of a system.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Tags can be of different types:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
          <p id="section-4-3.1.1">Concise Module ID (CoMID) tags (<a href="#sec-comid" class="auto internal xref">Section 5</a>) contain metadata and claims about the hardware and firmware modules.<a href="#section-4-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.2">
          <p id="section-4-3.2.1">Concise Software ID (CoSWID) tags (<span>[<a href="#RFC9393" class="cite xref">RFC9393</a>]</span>) are used to identify, describe and manage software components.<a href="#section-4-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.3">
          <p id="section-4-3.3.1">Concise Tag List (CoTL) tags (<a href="#sec-cotl" class="auto internal xref">Section 6</a>) contain the list of CoMID and CoSWID tags that the Verifier should consider as "active" at a certain point in time.<a href="#section-4-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-4">CoRIM allows for new types of tags to be added in future specifications.
For example, Concise Trust Anchor Stores (CoTS) (<span>[<a href="#I-D.ietf-rats-concise-ta-stores" class="cite xref">I-D.ietf-rats-concise-ta-stores</a>]</span>) is currently being defined as a standard CoRIM extension.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Each CoRIM contains a unique identifier to distinguish a CoRIM from other CoRIMs.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">CoRIM can also carry the following optional metadata:<a href="#section-4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-7.1">
          <p id="section-4-7.1.1">A locator, which allows discovery of possibly related RIMs.<a href="#section-4-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-7.2">
          <p id="section-4-7.2.1">A profile identifier, which is used to interpret the information contained in the enclosed tags.
A profile allows the base CoRIM CDDL definition to be customized to fit a specific Attester by augmenting the base CDDL data definition via the specified extension points or by constraining types defined.
A profile MUST NOT change the base CoRIM CDDL definition's semantics, which includes not changing or overloading names and numbers registered at IANA registries used by this document.
For more detail, see <a href="#sec-corim-profile-types" class="auto internal xref">Section 4.1.4</a>.<a href="#section-4-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-7.3">
          <p id="section-4-7.3.1">A validity period, which indicates the time period for which the CoRIM contents are valid.<a href="#section-4-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-7.4">
          <p id="section-4-7.4.1">Information about the supply chain entities responsible for the contents of the CoRIM and their associated roles.<a href="#section-4-7.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-8">A CoRIM can be signed (<a href="#sec-corim-signed" class="auto internal xref">Section 4.2</a>) using COSE Sign1 to provide end-to-end security to the CoRIM contents.
When CoRIM is signed, the protected header carries further identifying information about the CoRIM signer.
Alternatively, CoRIM can be encoded as a #6.501 CBOR-tagged payload (<a href="#sec-corim-map" class="auto internal xref">Section 4.1</a>) and transported over a secure channel.<a href="#section-4-8" class="pilcrow">¶</a></p>
<p id="section-4-9">The following CDDL describes the top-level CoRIM.<a href="#section-4-9" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4-10">
<pre>
corim = concise-rim-type-choice

concise-rim-type-choice /= tagged-unsigned-corim-map
concise-rim-type-choice /= signed-corim
</pre><a href="#section-4-10" class="pilcrow">¶</a>
</div>
<div id="sec-corim-map">
<section id="section-4.1">
        <h3 id="name-corim-map">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-corim-map" class="section-name selfRef">CoRIM Map</a>
        </h3>
<p id="section-4.1-1">The CDDL specification for the <code>corim-map</code> is as follows and this rule and its
constraints MUST be followed when creating or validating a CoRIM map.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.1-2">
<pre>
corim-map = {
  &amp;(id: 0) =&gt; $corim-id-type-choice
  &amp;(tags: 1) =&gt; [ + $concise-tag-type-choice ]
  ? &amp;(dependent-rims: 2) =&gt; [ + corim-locator-map ]
  ? &amp;(profile: 3) =&gt; $profile-type-choice
  ? &amp;(rim-validity: 4) =&gt; validity-map
  ? &amp;(entities: 5) =&gt; [ + corim-entity-map ]
  * $$corim-map-extension
}
unsigned-corim-map = corim-map
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">The following describes each child item of this map.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1"><code>id</code> (index 0): A globally unique identifier to identify a CoRIM. Described
in <a href="#sec-corim-id" class="auto internal xref">Section 4.1.1</a>.<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.2">
            <p id="section-4.1-4.2.1"><code>tags</code> (index 1):  An array of one or more CoMID, CoSWID or CoTL tags.  Described
in <a href="#sec-corim-tags" class="auto internal xref">Section 4.1.2</a>.<a href="#section-4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.3">
            <p id="section-4.1-4.3.1"><code>dependent-rims</code> (index 2): One or more services supplying additional,
possibly dependent, manifests or related files.
Described in <a href="#sec-corim-locator-map" class="auto internal xref">Section 4.1.3</a>.<a href="#section-4.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.4">
            <p id="section-4.1-4.4.1"><code>profile</code> (index 3): An optional profile identifier for the tags contained in
this CoRIM.  The profile MUST be understood by the CoRIM processor.  Failure
to recognize the profile identifier MUST result in the rejection of the
entire CoRIM.
See <a href="#sec-corim-profile-types" class="auto internal xref">Section 4.1.4</a><a href="#section-4.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.5">
            <p id="section-4.1-4.5.1"><code>rim-validity</code> (index 4): Specifies the validity period of the CoRIM.
Described in <a href="#sec-common-validity" class="auto internal xref">Section 7.3</a>.<a href="#section-4.1-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.6">
            <p id="section-4.1-4.6.1"><code>entities</code> (index 5): A list of entities involved in a CoRIM life-cycle.
Described in <a href="#sec-corim-entity" class="auto internal xref">Section 4.1.5</a>.<a href="#section-4.1-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.7">
            <p id="section-4.1-4.7.1"><code>$$corim-map-extension</code>: This CDDL socket is used to add new information
structures to the <code>corim-map</code>.
Described in <a href="#sec-iana-corim" class="auto internal xref">Section 12.3</a>.<a href="#section-4.1-4.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-5">A <code>corim-map</code> is unsigned, and its tagged form is an entrypoint for parsing a CoRIM, so it is named <code>tagged-unsigned-corim-map</code>.
~~~ cddl
tagged-unsigned-corim-map = #6.501(unsigned-corim-map)
~~~<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<div id="sec-corim-id">
<section id="section-4.1.1">
          <h4 id="name-corim-identifier">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-corim-identifier" class="section-name selfRef">CoRIM Identifier</a>
          </h4>
<p id="section-4.1.1-1">A CoRIM Identifier uniquely identifies a CoRIM instance within the context of a CoRIM issuer.
In other words the CoRIM identifier is not guaranteed to be globally unique, but can be used to distinguish CoRIMs that come from the same issuer.
The base CDDL definition allows UUID and text identifiers.
Other types of identifiers could be defined as needed.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.1.1-2">
<pre>
$corim-id-type-choice /= tstr
$corim-id-type-choice /= uuid-type
</pre><a href="#section-4.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-corim-tags">
<section id="section-4.1.2">
          <h4 id="name-tags">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-tags" class="section-name selfRef">Tags</a>
          </h4>
<p id="section-4.1.2-1">A <code>$concise-tag-type-choice</code> is a tagged CBOR payload that carries either a
CoMID (<a href="#sec-comid" class="auto internal xref">Section 5</a>), a CoSWID (<span>[<a href="#RFC9393" class="cite xref">RFC9393</a>]</span>), or a CoTL (<a href="#sec-cotl" class="auto internal xref">Section 6</a>).<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.1.2-2">
<pre>
$concise-tag-type-choice /= tagged-concise-swid-tag
$concise-tag-type-choice /= tagged-concise-mid-tag
$concise-tag-type-choice /= tagged-concise-tl-tag
</pre><a href="#section-4.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-corim-locator-map">
<section id="section-4.1.3">
          <h4 id="name-locator-map">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-locator-map" class="section-name selfRef">Locator Map</a>
          </h4>
<p id="section-4.1.3-1">The locator map contains pointers to repositories where dependent manifests,
certificates, or other relevant information can be retrieved by the Verifier.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.1.3-2">
<pre>
corim-locator-map = {
  &amp;(href: 0) =&gt; uri / [ + uri ]
  ? &amp;(thumbprint: 1) =&gt; digest / [digest]
}
</pre><a href="#section-4.1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3-3">The following describes each child element of this type.<a href="#section-4.1.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.3-4.1">
              <p id="section-4.1.3-4.1.1"><code>href</code> (index 0): a URI or array of alternative URIs identifying locations where the additional resource can be fetched.<a href="#section-4.1.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.3-4.2">
              <p id="section-4.1.3-4.2.1"><code>thumbprint</code> (index 1): expected digest or an array of digests referenced by <code>href</code> or an array of <code>href</code>s. See sec-common-hash-entry}}.<a href="#section-4.1.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sec-corim-profile-types">
<section id="section-4.1.4">
          <h4 id="name-profile-types">
<a href="#section-4.1.4" class="section-number selfRef">4.1.4. </a><a href="#name-profile-types" class="section-name selfRef">Profile Types</a>
          </h4>
<p id="section-4.1.4-1">Profiling is the mechanism that allows the base CoRIM CDDL definition to be customized to fit a specific Attester.<a href="#section-4.1.4-1" class="pilcrow">¶</a></p>
<p id="section-4.1.4-2">A profile defines which of the optional parts of a CoRIM are required, which are prohibited and which extension points are exercised and how.
A profile MUST NOT alter the syntax or semantics of CoRIM types defined in this document.<a href="#section-4.1.4-2" class="pilcrow">¶</a></p>
<p id="section-4.1.4-3">A profile MAY constrain the values of a given CoRIM type to a subset of the values.
A profile MAY extend the set of a given CoRIM type using the defined extension points (<a href="#sec-extensibility" class="auto internal xref">Section 5.2</a>).
Exercised extension points SHOULD preserve the intent of the original semantics.<a href="#section-4.1.4-3" class="pilcrow">¶</a></p>
<p id="section-4.1.4-4">CoRIM profiles SHOULD be specified in a publicly available document.<a href="#section-4.1.4-4" class="pilcrow">¶</a></p>
<p id="section-4.1.4-5">A CoRIM profile can use one of the base CoRIM media type defined in <a href="#sec-mt-rim-cbor" class="auto internal xref">Section 12.12.1</a> with the <code>profile</code> parameter set to the appropriate value.
Alternatively, it MAY define and register its own media type.<a href="#section-4.1.4-5" class="pilcrow">¶</a></p>
<p id="section-4.1.4-6">A profile identifier is either an OID <span>[<a href="#RFC9090" class="cite xref">RFC9090</a>]</span> or a URL <span>[<a href="#STD66" class="cite xref">STD66</a>]</span>.<a href="#section-4.1.4-6" class="pilcrow">¶</a></p>
<p id="section-4.1.4-7">The profile identifier uniquely identifies a documented profile.  Any changes
to the profile, even the slightest deviation, is considered a different profile
that MUST have a different identifier.<a href="#section-4.1.4-7" class="pilcrow">¶</a></p>
<p id="section-4.1.4-8">The CoRIM profile must describe at a minimum the following:  (a) how cryptographic verification key material is represented (e.g., using Attestation Keys triples, or CoTS tags), and
(b) how key material is associated with the Attesting Environment.
The CoRIM profile should also specify whether CBOR deterministic encoding is required.<a href="#section-4.1.4-8" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.1.4-9">
<pre>
$profile-type-choice /= uri
$profile-type-choice /= tagged-oid-type
</pre><a href="#section-4.1.4-9" class="pilcrow">¶</a>
</div>
<p id="section-4.1.4-10">For an example profile definition, see <span>[<a href="#I-D.fdb-rats-psa-endorsements" class="cite xref">I-D.fdb-rats-psa-endorsements</a>]</span>.<a href="#section-4.1.4-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-corim-entity">
<section id="section-4.1.5">
          <h4 id="name-entities">
<a href="#section-4.1.5" class="section-number selfRef">4.1.5. </a><a href="#name-entities" class="section-name selfRef">Entities</a>
          </h4>
<p id="section-4.1.5-1">The CoRIM Entity is an instantiation of the Entity generic (<a href="#sec-common-entity" class="auto internal xref">Section 7.2</a>) using a <code>$corim-role-type-choice</code>.<a href="#section-4.1.5-1" class="pilcrow">¶</a></p>
<p id="section-4.1.5-2">The only role defined in this specification for a CoRIM Entity is
<code>manifest-creator</code>.<a href="#section-4.1.5-2" class="pilcrow">¶</a></p>
<p id="section-4.1.5-3">The <code>$$corim-entity-map-extension</code> extension socket is empty in this
specification.<a href="#section-4.1.5-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.1.5-4">
<pre>
corim-entity-map =
  entity-map&lt;$corim-role-type-choice, $$corim-entity-map-extension&gt;

$corim-role-type-choice /= &amp;(manifest-creator: 1)
$corim-role-type-choice /= &amp;(manifest-signer: 2)
</pre><a href="#section-4.1.5-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1.5-5">The <code>corim-entity-map</code> MUST NOT contain two entities with the <code>manifest-signer</code> role.<a href="#section-4.1.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-corim-signed">
<section id="section-4.2">
        <h3 id="name-signed-corim">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-signed-corim" class="section-name selfRef">Signed CoRIM</a>
        </h3>
<div class="lang-cddl sourcecode" id="section-4.2-1">
<pre>
signed-corim = #6.18(COSE-Sign1-corim)
</pre><a href="#section-4.2-1" class="pilcrow">¶</a>
</div>
<p id="section-4.2-2">Signing a CoRIM follows the procedures defined in CBOR Object Signing and
Encryption <span>[<a href="#STD96" class="cite xref">STD96</a>]</span>. A CoRIM tag MUST be wrapped in a COSE_Sign1 structure.
The CoRIM MUST be signed by the CoRIM creator.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The following CDDL specification defines a restrictive subset of COSE header
parameters that MUST be used in the protected header alongside additional
information about the CoRIM encoded in a <code>corim-meta-map</code> (<a href="#sec-corim-meta" class="auto internal xref">Section 4.2.3</a>) or alternatively in a <code>CWT-Claims</code> (<span>[<a href="#RFC9597" class="cite xref">RFC9597</a>]</span>).<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.2-4">
<pre>
COSE-Sign1-corim = [
  protected: bstr .cbor protected-corim-header-map
  unprotected: unprotected-corim-header-map
  payload: bstr .cbor tagged-unsigned-corim-map
  signature: bstr
]
</pre><a href="#section-4.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2-5">The following describes each child element of this type.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-6.1">
            <p id="section-4.2-6.1.1"><code>protected</code>: A CBOR Encoded protected header which is protected by the COSE
signature. Contains information as given by Protected Header Map below.<a href="#section-4.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-6.2">
            <p id="section-4.2-6.2.1"><code>unprotected</code>: A COSE header that is not protected by COSE signature.<a href="#section-4.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-6.3">
            <p id="section-4.2-6.3.1"><code>payload</code>: A CBOR encoded tagged CoRIM.<a href="#section-4.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-6.4">
            <p id="section-4.2-6.4.1"><code>signature</code>: A COSE signature block which is the signature over the protected
and payload components of the signed CoRIM.<a href="#section-4.2-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="protected-header-map">
<section id="section-4.2.1">
          <h4 id="name-protected-header-map">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-protected-header-map" class="section-name selfRef">Protected Header Map</a>
          </h4>
<div class="lang-cddl sourcecode" id="section-4.2.1-1">
<pre>
; protected header map needs to contain at least one of corim-meta (8) or CWT-Claims (15)
protected-corim-header-map =
  {
    &amp;(alg: 1) =&gt; int,
    &amp;(content-type: 3) =&gt; "application/rim+cbor",
    meta-group,
    * cose-label =&gt; cose-value
  }

meta-group = ((
        corim-meta-identity,
        ? cwt-claims-identity,
      ) // cwt-claims-identity)

corim-meta-identity = (&amp;(corim-meta: 8) =&gt; bstr .cbor corim-meta-map)
cwt-claims-identity = (&amp;(CWT-Claims: 15) =&gt; cwt-claims)
</pre><a href="#section-4.2.1-1" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-2">The CoRIM protected header map uses some common COSE header parameters plus additional metadata.
Additional metadata can either be carried in a <code>CWT_Claims</code> (index: 15) parameter as defined by <span>[<a href="#RFC9597" class="cite xref">RFC9597</a>]</span>,
or in a <code>corim-meta</code> map as a legacy alternative, described in <a href="#sec-corim-meta" class="auto internal xref">Section 4.2.3</a>.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-3">The following describes each child item of this map.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-4.1">
              <p id="section-4.2.1-4.1.1"><code>alg</code> (index 1): An integer that identifies a signature algorithm.<a href="#section-4.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-4.2">
              <p id="section-4.2.1-4.2.1"><code>content-type</code> (index 3): A string that represents the "MIME Content type" carried in the CoRIM payload.<a href="#section-4.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-5">At least one of:<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-6.1">
              <p id="section-4.2.1-6.1.1"><code>CWT-Claims</code> (index 15): A map that contains metadata associated with a signed CoRIM.
Described in <span>[<a href="#RFC9597" class="cite xref">RFC9597</a>]</span>.<a href="#section-4.2.1-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-6.2">
              <p id="section-4.2.1-6.2.1"><code>corim-meta</code> (index 8): A map that contains metadata associated with a signed CoRIM.
Described in <a href="#sec-corim-meta" class="auto internal xref">Section 4.2.3</a>.<a href="#section-4.2.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-7">Documents MAY include both <code>CWT-Claims</code> and <code>corim-meta</code>, in which case the signer MUST ensure that their contents are semantically identical: the <code>CWT-Claims</code> issuer (<code>iss</code>) MUST have the same value as <code>signer-name</code> in <code>corim-meta</code>, and the <code>nbf</code> and <code>exp</code> values in the <code>CWT-Claims</code> MUST match the <code>signature-validity</code> in <code>corim-meta</code>.<a href="#section-4.2.1-7" class="pilcrow">¶</a></p>
<p id="section-4.2.1-8">Additional data can be included in the COSE header map as per (<span><a href="https://rfc-editor.org/rfc/rfc9052#section-3" class="relref">Section 3</a> of [<a href="#STD96" class="cite xref">STD96</a>]</span>).<a href="#section-4.2.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cwt-claims">
<section id="section-4.2.2">
          <h4 id="name-cwt-claims">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-cwt-claims" class="section-name selfRef">CWT Claims</a>
          </h4>
<p id="section-4.2.2-1">The CWT Claims (<span>[<a href="#RFC9597" class="cite xref">RFC9597</a>]</span>) map identifies the entity that created and signed the CoRIM.
This ensures the consumer is able to identify credentials used to authenticate its signer.
To avoid any possible ambiguity with the contents of the CoRIM tags, the CWT Claims map MUST NOT contain claims that have semantic overlap with the information contained in CoRIM tags.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">The following describes each child item of this group.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-3.1">
              <p id="section-4.2.2-3.1.1"><code>iss</code> (index 1): Issuer or signer for the CoRIM, formerly <code>signer-name</code> or <code>signer-uri</code> in <a href="#sec-corim-signer" class="auto internal xref">Section 4.2.3.1</a>.<a href="#section-4.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.2-3.2">
              <p id="section-4.2.2-3.2.1"><code>sub</code> (index 2): Optional - identifies the CoRIM document, equivalent to a string representation of $corim-id-type-choice<a href="#section-4.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.2-4">Additional data can be included in the CWT Claims, as per <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, such as:<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-5.1">
              <p id="section-4.2.2-5.1.1"><code>exp</code> (index 4): Expiration time, formerly <code>signature-validity</code> in <a href="#sec-common-validity" class="auto internal xref">Section 7.3</a>.<a href="#section-4.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.2-5.2">
              <p id="section-4.2.2-5.2.1"><code>nbf</code> (index 5): Not before time, formerly <code>signature-validity</code> in <a href="#sec-common-validity" class="auto internal xref">Section 7.3</a>.<a href="#section-4.2.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sec-corim-meta">
<section id="section-4.2.3">
          <h4 id="name-meta-map">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-meta-map" class="section-name selfRef">Meta Map</a>
          </h4>
<p id="section-4.2.3-1">The CoRIM meta map identifies the entity or entities that create and sign the CoRIM.
This ensures the consumer is able to identify credentials used to authenticate its signer.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.2.3-2">
<pre>
corim-meta-map = {
  &amp;(signer: 0) =&gt; corim-signer-map
  ? &amp;(signature-validity: 1) =&gt; validity-map
}
</pre><a href="#section-4.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.3-3">The following describes each child item of this group.<a href="#section-4.2.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.3-4.1">
              <p id="section-4.2.3-4.1.1"><code>signer</code> (index 0): Information about the entity that signs the CoRIM.
Described in <a href="#sec-corim-signer" class="auto internal xref">Section 4.2.3.1</a>.<a href="#section-4.2.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.3-4.2">
              <p id="section-4.2.3-4.2.1"><code>signature-validity</code> (index 1): Validity period for the CoRIM.
Described in <a href="#sec-common-validity" class="auto internal xref">Section 7.3</a>.<a href="#section-4.2.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="sec-corim-signer">
<section id="section-4.2.3.1">
            <h5 id="name-signer-map">
<a href="#section-4.2.3.1" class="section-number selfRef">4.2.3.1. </a><a href="#name-signer-map" class="section-name selfRef">Signer Map</a>
            </h5>
<div class="lang-cddl sourcecode" id="section-4.2.3.1-1">
<pre>
corim-signer-map = {
  &amp;(signer-name: 0) =&gt; $entity-name-type-choice
  ? &amp;(signer-uri: 1) =&gt; uri
  * $$corim-signer-map-extension
}
</pre><a href="#section-4.2.3.1-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-4.2.3.1-2.1">
                <p id="section-4.2.3.1-2.1.1"><code>signer-name</code> (index 0): Name of the organization that performs the signer
role<a href="#section-4.2.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.3.1-2.2">
                <p id="section-4.2.3.1-2.2.1"><code>signer-uri</code> (index 1): A URI identifying the same organization<a href="#section-4.2.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.3.1-2.3">
                <p id="section-4.2.3.1-2.3.1"><code>$$corim-signer-map-extension</code>: Extension point for future expansion of the
Signer map.<a href="#section-4.2.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="sec-corim-unprotected-header">
<section id="section-4.2.4">
          <h4 id="name-unprotected-corim-header-ma">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-unprotected-corim-header-ma" class="section-name selfRef">Unprotected CoRIM Header Map</a>
          </h4>
<div class="lang-cddl sourcecode" id="section-4.2.4-1">
<pre>
unprotected-corim-header-map = {
  * cose-label =&gt; cose-value
}
</pre><a href="#section-4.2.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec-conveyed-signer">
<section id="section-4.3">
        <h3 id="name-signer-authority-of-securel">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-signer-authority-of-securel" class="section-name selfRef">Signer authority of securely conveyed unsigned CoRIM</a>
        </h3>
<p id="section-4.3-1">An unsigned (#6.501-tagged) CoRIM may be a payload in an enveloping signed document, or it may be conveyed unsigned within the protection scope of a secure channel.
The CoRIM signer authority is taken from the authenticated credential (e.g., OAUTH token) of the entity that originates the CoRIM.
For example, this entity could be the sending peer in a secure channel.
A CoRIM role entry expressing the origin of the unsigned CoRIM (i.e., the enveloping signed document or the origin endpoint of the secure channel) via the <code>manifest-signer</code> role MUST be added to <code>corim-entity-map</code>.
If the authority cannot be expressed directly via the existing authority types, the receiver SHOULD establish a local authority in one of the supported authority formats (e.g., if an unsigned CoRIM is received over a secure channel where authentication is token- or password-based).
If it is impossible to assert the authority of the origin, the Verifier's appraisal policy MAY assert the Verifier’s authority as the CoRIM origin.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">It is out of scope of this document to specify a method of delegating the signer role in the case that an unsigned CoRIM is conveyed through multiple secured links with different notions of authenticity without end-to-end integrity protection.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div id="corim-collections">
<section id="section-4.3.1">
          <h4 id="name-corim-collections">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-corim-collections" class="section-name selfRef">CoRIM collections</a>
          </h4>
<p id="section-4.3.1-1">Several CoRIMs may share the same signer (e.g., as collection payload in a different signed message) and use locally-resolvable references to each other, for example using a RATS Conceptual Message Wrapper (CMW) <span>[<a href="#I-D.ietf-rats-msg-wrap" class="cite xref">I-D.ietf-rats-msg-wrap</a>]</span>.
The Collection CMW type is similar to a profile in its way of restricting the shape of the CMW collection.
The Collection CMW type for a CoRIM collection SHALL be <code>tag:{{&amp;SELF}}:corim</code>.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">A COSE_Sign1-signed CoRIM Collection CMW has a similar requirement to a signed CoRIM.
The signing operation MUST include either a <code>CWT-Claims</code> or a <code>corim-meta</code> and MAY contain both, in the COSE_Sign1 <code>protected-header</code> parameter.
These metadata containers ensure that each CoRIM in the collection has an identified signer.
The COSE protected header can include a Collection CMW type name by using the <code>cmwc_t</code> content type parameter for the <code>&amp;(content-type: 3)</code> COSE header.<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3">If using other signing envelope formats, the CoRIM signing authority MUST be specified. For example, this can be accomplished by adding the <code>manifest-signer</code> role to every CoRIM, or by using a protected header analogous to <code>corim-meta</code>.<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.3.1-4">
<pre>
corim-cbor-collection = {
  "__cmwc_t" =&gt; "tag:{{&amp;SELF}}:corim",
  + cmw-label =&gt; [TBD1, bytes .cbor tagged-corim-map]
}
cmw-label = text / int
</pre><a href="#section-4.3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-5">The Collection CMW MAY use any label for its CoRIMs.
If there is a hierarchical structure to the CoRIM Collection CMW, the base entry point SHOULD be labeled <code>0</code> in CBOR or <code>"base"</code> in JSON.
It is RECOMMENDED to label a CoRIM with its tag-id in string format, where <code>uuid-type</code> string format is specified by <span>[<a href="#RFC9562" class="cite xref">RFC9562</a>]</span>.
CoRIMs distributed in a CoRIM Collection CMW MAY declare their interdependence <code>dependent-rims</code> with local resource indicators.
It is RECOMMENDED that a CoRIM with a <code>uuid-type</code> tag-id be referenced with URI <code>urn:uuid:</code><em>tag-id-uuid-string</em>.
It is RECOMMENDED that a CoRIM with a <code>tstr</code> tag-id be referenced with <code>tag:{{&amp;SELF}}:local,</code><em>tag-id-tstr</em>.
It is RECOMMENDED for a <code>corim-locator-map</code> containing local URIs to afterwards list a nonzero number of reachable URLs as remote references.<a href="#section-4.3.1-5" class="pilcrow">¶</a></p>
<p id="section-4.3.1-6">The following example demonstrates these recommendations for bundling CoRIMs with a common signer but have different profiles.<a href="#section-4.3.1-6" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-4.3.1-7">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ================

/ cbor-collection / {
  "__cmwc_t": "tag:{{&amp;SELF}}:corim",
  "adee8cd4-4e47-461f-b341-2aba3ae4cbda":
    / cbor-cmw / [TBD1, &lt;&lt; / tagged-corim-map / 501({
      / id / 0: h'adee8cd44e47461fb3412aba3ae4cbda',
      / tags / 1: [/ tagged-concise-mid-tag / 506(&lt;&lt;{
        / tag-identity / 1: {
          / tag-id / 0: h'315cfc0208d548ee9c89906df96e7fb8'
        },
        / triples / 4: {
          / reference-triples / 0: [[
            / ref-env / {/ class / 0: {/ class-id / 0: 560(h'c0de')}\
                                                                   },
            / ref-claims / {
              / mval / 1: {
                / profile-foo / -404:
                  h'\
                  6094685f8bb9b67daaf35707bd2c391f536a1df2ce5152c3cc'
              }}]],
          / coswid-triples / 6: [[
            {/ class / 0: {/ class-id / 0: 560(h'c0de')}},
            [h'369a6688451240b9b74905b1dd5fae9f']]]}}&gt;&gt;)],
      / profile / 3: "tag:example.com,2025/example-profile",
      / dependent-rims / 2: [{
        / href / 0: [
          "urn:uuid:51a5f633-71c0-45f5-855e-43e8254c1806",
          "https://example.com/369a6688451240b9b74905b1dd5fae9f.\
                                                               corim"
        ]}]}) &gt;&gt;],
  "51a5f633-71c0-45f5-855e-43e8254c1806":
    / cbor-cmw / [TBD1, &lt;&lt; / tagged-corim-map / 501({
      / id: / 0: h'51a5f63371c045f5855e43e8254c1806',
      / tags / 1: [/ tagged-concise-swid-tag / 505(&lt;&lt;{
          / tag-id / 0: h'369a6688451240b9b74905b1dd5fae9f',
          / tag-version / 12: 2,
          / software-name / 1: "Gadget Firmware",
          / entity / 2: {
            / entity-name / 31: "ACME Firmware",
            / role / 33: / software-creator / 2
          },
          / profile-bar / 4294967295: {
           / profile-baz / 0: 5,
           / profile-qux / 1: h'f76e41f3462a62e8'}}&gt;&gt;)],
      / profile / 3: "tag:example.com,2025/software-profile"})&gt;&gt;]
}
</pre><a href="#section-4.3.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-comid">
<section id="section-5">
      <h2 id="name-concise-module-identifier-c">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-concise-module-identifier-c" class="section-name selfRef">Concise Module Identifier (CoMID)</a>
      </h2>
<p id="section-5-1">A CoMID tag contains information about hardware, firmware, or module composition.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Each CoMID has a unique ID that is used to unambiguously identify CoMID instances when cross referencing CoMID tags, for example in typed link relations, or in a CoTL tag.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">A CoMID defines several types of Claims, using "triples" semantics.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">At a high level, a triple is a statement that links a subject to an object via a predicate.
CoMID triples typically encode assertions made by the CoRIM author about Attesting or Target Environments and their security features, for example measurements, cryptographic key material, etc.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">This specification defines two classes of triples, the Mandatory To Implement (MTI) and the Optional To Implement (OTI).
The MTI triples are essential to basic appraisal processing as illustrated in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> and <span>[<a href="#I-D.ietf-rats-endorsements" class="cite xref">I-D.ietf-rats-endorsements</a>]</span>.
Every CoRIM Verifier MUST implement the MTI triples.
The OTI class of triples are generally useful across profiles.
A CoRIM Verifier SHOULD implement OTI triples.
Verifiers may be constrained in various ways that may make implementation of the OTI class infeasible or unnecessary.
For example, deployment environments may have constrained resources, limited code size, or limited scope Attesters.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">MTI Triples:<a href="#section-5-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-7.1">
          <p id="section-5-7.1.1">Reference Values triples: containing Reference Values that are expected to match Evidence for a given Target Environment (<a href="#sec-comid-triple-refval" class="auto internal xref">Section 5.1.4.2</a>).<a href="#section-5-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-7.2">
          <p id="section-5-7.2.1">Endorsed Values triples: containing "Endorsed Values", i.e., features about an Environment that do not appear in Evidence. Specific examples include testing or certification data pertaining to a module (<a href="#sec-comid-triple-endval" class="auto internal xref">Section 5.1.4.3</a>).<a href="#section-5-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-7.3">
          <p id="section-5-7.3.1">Conditional Endorsement triples: describing one or more conditions that, once matched, result in augmenting the Attester's actual state with the supplied Endorsed Values (<a href="#sec-comid-triple-cond-endors" class="auto internal xref">Section 5.1.4.4</a>).<a href="#section-5-7.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-8">OTI Triples:<a href="#section-5-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-9.1">
          <p id="section-5-9.1.1">Conditional Endorsement Series triples: describing conditional endorsements that are evaluated using a special matching algorithm (<a href="#sec-comid-triple-cond-endors" class="auto internal xref">Section 5.1.4.4</a>).<a href="#section-5-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-9.2">
          <p id="section-5-9.2.1">Device Identity triples: containing cryptographic credentials - for example, an IDevID - uniquely identifying a device (<a href="#sec-comid-triple-identity" class="auto internal xref">Section 5.1.4.6</a>).<a href="#section-5-9.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-9.3">
          <p id="section-5-9.3.1">Attestation Key triples: containing cryptographic keys that are used to verify the integrity protection on the Evidence received from the Attester (<a href="#sec-comid-triple-attest-key" class="auto internal xref">Section 5.1.4.7</a>).<a href="#section-5-9.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-9.4">
          <p id="section-5-9.4.1">Domain dependency triples: describing trust relationships between domains, i.e., collection of related environments and their measurements (<a href="#sec-comid-triple-domain-dependency" class="auto internal xref">Section 5.1.4.8.2</a>).<a href="#section-5-9.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-9.5">
          <p id="section-5-9.5.1">Domain membership triples: describing topological relationships between (sub-)modules. For example, in a composite Attester comprising multiple sub-Attesters (sub-modules), this triple can be used to define the topological relationship between lead- and sub- Attester environments (<a href="#sec-comid-triple-domain-membership" class="auto internal xref">Section 5.1.4.8.1</a>).<a href="#section-5-9.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-9.6">
          <p id="section-5-9.6.1">CoMID-CoSWID linking triples: associating a Target Environment with existing CoSWID Payload tags (<a href="#sec-comid-triple-coswid" class="auto internal xref">Section 5.1.4.9</a>).<a href="#section-5-9.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-10">CoMID triples are extensible (<a href="#sec-comid-triples" class="auto internal xref">Section 5.1.4</a>).
Triples added via the extensibility feature MUST be OTI class triples.
This document specifies profiles (see <a href="#sec-extensibility" class="auto internal xref">Section 5.2</a>).
OTI triples MAY be reclassified as MTI using a profile.
Conversely, profiles can choose not to <em>use</em> certain MTI triples.
Profiles MUST NOT reclassify MTI triples as OTI.<a href="#section-5-10" class="pilcrow">¶</a></p>
<div id="structure">
<section id="section-5.1">
        <h3 id="name-structure">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-structure" class="section-name selfRef">Structure</a>
        </h3>
<p id="section-5.1-1">The CDDL specification for the <code>concise-mid-tag</code> map is as follows and this
rule and its constraints MUST be followed when creating or validating a CoMID
tag:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1-2">
<pre>
concise-mid-tag = {
  ? &amp;(language: 0) =&gt; text
  &amp;(tag-identity: 1) =&gt; tag-identity-map
  ? &amp;(entities: 2) =&gt; [ + comid-entity-map ]
  ? &amp;(linked-tags: 3) =&gt; [ + linked-tag-map ]
  &amp;(triples: 4) =&gt; triples-map
  * $$concise-mid-tag-extension
}
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1-3">The following describes each member of the <code>concise-mid-tag</code> map.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-4.1">
            <p id="section-5.1-4.1.1"><code>lang</code> (index 0): A textual language tag that conforms with IANA "Language
Subtag Registry" <span>[<a href="#IANA.language-subtag-registry" class="cite xref">IANA.language-subtag-registry</a>]</span>. The context of the specified language
applies to all sibling and descendant textual values, unless a descendant
object has defined a different language tag. Thus, a new context is
established when a descendant object redefines a new language tag.  All
textual values within a given context MUST be considered expressed in the
specified language.<a href="#section-5.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.2">
            <p id="section-5.1-4.2.1"><code>tag-identity</code> (index 1): A <code>tag-identity-map</code> containing unique
identification information for the CoMID.
Described in <a href="#sec-comid-tag-id" class="auto internal xref">Section 5.1.1</a>.<a href="#section-5.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.3">
            <p id="section-5.1-4.3.1"><code>entities</code> (index 2): Provides information about one or more organizations
responsible for producing the CoMID tag.
Described in <a href="#sec-comid-entity" class="auto internal xref">Section 5.1.2</a>.<a href="#section-5.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.4">
            <p id="section-5.1-4.4.1"><code>linked-tags</code> (index 3): A list of one or more <code>linked-tag-map</code> providing typed relationships between this and
other CoMIDs.
Described in <a href="#sec-comid-linked-tag" class="auto internal xref">Section 5.1.3</a>).<a href="#section-5.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.5">
            <p id="section-5.1-4.5.1"><code>triples</code> (index 4): One or more triples providing information specific to
the described module, e.g.: reference or endorsed values, cryptographic
material, or structural relationship between the described module and other
modules.
Described in <a href="#sec-comid-triples" class="auto internal xref">Section 5.1.4</a>.<a href="#section-5.1-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="sec-comid-tag-id">
<section id="section-5.1.1">
          <h4 id="name-tag-identity">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-tag-identity" class="section-name selfRef">Tag Identity</a>
          </h4>
<div class="lang-cddl sourcecode" id="section-5.1.1-1">
<pre>
tag-identity-map = {
  &amp;(tag-id: 0) =&gt; $tag-id-type-choice
  ? &amp;(tag-version: 1) =&gt; tag-version-type
}
</pre><a href="#section-5.1.1-1" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-2">The following describes each member of the <code>tag-identity-map</code>.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.1-3.1">
              <p id="section-5.1.1-3.1.1"><code>tag-id</code> (index 0): A universally unique identifier for the CoMID.
Described in <a href="#sec-tag-id" class="auto internal xref">Section 5.1.1.1</a>.<a href="#section-5.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.1-3.2">
              <p id="section-5.1.1-3.2.1"><code>tag-version</code> (index 1): Optional versioning information for the <code>tag-id</code>.
Described in <a href="#sec-tag-version" class="auto internal xref">Section 5.1.1.2</a>.<a href="#section-5.1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="sec-tag-id">
<section id="section-5.1.1.1">
            <h5 id="name-tag-id">
<a href="#section-5.1.1.1" class="section-number selfRef">5.1.1.1. </a><a href="#name-tag-id" class="section-name selfRef">Tag ID</a>
            </h5>
<div class="lang-cddl sourcecode" id="section-5.1.1.1-1">
<pre>
$tag-id-type-choice /= tstr
$tag-id-type-choice /= uuid-type
</pre><a href="#section-5.1.1.1-1" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1.1-2">A Tag ID is either a 16-byte binary string, or a textual identifier, uniquely
referencing the CoMID. The tag identifier MUST be globally unique. Failure to
ensure global uniqueness can create ambiguity in tag use since the tag-id
serves as the global key for matching, lookups and linking. If represented as a
16-byte binary string, the identifier MUST be a valid universally unique
identifier as defined by <span>[<a href="#RFC9562" class="cite xref">RFC9562</a>]</span>. There are no strict guidelines on how the
identifier is structured, but examples include a 16-byte GUID (e.g., class 4
UUID) <span>[<a href="#RFC9562" class="cite xref">RFC9562</a>]</span>, or a URI <span>[<a href="#STD66" class="cite xref">STD66</a>]</span>.<a href="#section-5.1.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-tag-version">
<section id="section-5.1.1.2">
            <h5 id="name-tag-version">
<a href="#section-5.1.1.2" class="section-number selfRef">5.1.1.2. </a><a href="#name-tag-version" class="section-name selfRef">Tag Version</a>
            </h5>
<div class="lang-cddl sourcecode" id="section-5.1.1.2-1">
<pre>
tag-version-type = uint .default 0
</pre><a href="#section-5.1.1.2-1" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1.2-2">Tag Version is an integer value that indicates the specific release revision of
the tag.  Typically, the initial value of this field is set to 0 and the value
is increased for subsequent tags produced for the same module release.  This
value allows a CoMID tag producer to correct an incorrect tag previously
released without indicating a change to the underlying module the tag
represents. For example, the tag version could be changed to add new metadata,
to correct a broken link, to add a missing reference value, etc. When producing
a revised tag, the new tag-version value MUST be greater than the old
tag-version value.<a href="#section-5.1.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-comid-entity">
<section id="section-5.1.2">
          <h4 id="name-entities-2">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-entities-2" class="section-name selfRef">Entities</a>
          </h4>
<div class="lang-cddl sourcecode" id="section-5.1.2-1">
<pre>
comid-entity-map =
  entity-map&lt;$comid-role-type-choice, $$comid-entity-map-extension&gt;
</pre><a href="#section-5.1.2-1" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-2">The CoMID Entity is an instantiation of <code>entity-map</code> (<a href="#sec-common-entity" class="auto internal xref">Section 7.2</a>) using a <code>$comid-role-type-choice</code>.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">The <code>$$comid-entity-map-extension</code> extension socket is empty in this
specification.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.2-4">
<pre>
$comid-role-type-choice /= &amp;(tag-creator: 0)
$comid-role-type-choice /= &amp;(creator: 1)
$comid-role-type-choice /= &amp;(maintainer: 2)
</pre><a href="#section-5.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-5">The roles defined for a CoMID entity are:<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.2-6.1">
              <p id="section-5.1.2-6.1.1"><code>tag-creator</code> (value 0): creator of the CoMID tag.<a href="#section-5.1.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-6.2">
              <p id="section-5.1.2-6.2.1"><code>creator</code> (value 1): original maker of the module described by the CoMID tag.<a href="#section-5.1.2-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-6.3">
              <p id="section-5.1.2-6.3.1"><code>maintainer</code> (value 2): an entity making changes to the module described by the CoMID tag.<a href="#section-5.1.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sec-comid-linked-tag">
<section id="section-5.1.3">
          <h4 id="name-linked-tag">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-linked-tag" class="section-name selfRef">Linked Tag</a>
          </h4>
<p id="section-5.1.3-1">The linked tag map represents a typed relationship between the embedding CoMID
tag (the source) and another CoMID tag (the target).<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.3-2">
<pre>
linked-tag-map = {
  &amp;(linked-tag-id: 0) =&gt; $tag-id-type-choice
  &amp;(tag-rel: 1) =&gt; $tag-rel-type-choice
}
</pre><a href="#section-5.1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3-3">The following describes each member of the <code>tag-identity-map</code>.<a href="#section-5.1.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.3-4.1">
              <p id="section-5.1.3-4.1.1"><code>linked-tag-id</code> (index 0): Unique identifier for the target tag.
See <a href="#sec-tag-id" class="auto internal xref">Section 5.1.1.1</a>.<a href="#section-5.1.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.3-4.2">
              <p id="section-5.1.3-4.2.1"><code>tag-rel</code> (index 1): the kind of relation linking the source tag to the
target identified by <code>linked-tag-id</code>.<a href="#section-5.1.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div class="lang-cddl sourcecode" id="section-5.1.3-5">
<pre>
$tag-rel-type-choice /= &amp;(supplements: 0)
$tag-rel-type-choice /= &amp;(replaces: 1)
</pre><a href="#section-5.1.3-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3-6">The relations defined in this specification are:<a href="#section-5.1.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.3-7.1">
              <p id="section-5.1.3-7.1.1"><code>supplements</code> (value 0): the source tag provides additional information about
the module described in the target tag.<a href="#section-5.1.3-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.3-7.2">
              <p id="section-5.1.3-7.2.1"><code>replaces</code> (value 1): the source tag corrects erroneous information
contained in the target tag.  The information in the target MUST be
disregarded.<a href="#section-5.1.3-7.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sec-comid-triples">
<section id="section-5.1.4">
          <h4 id="name-triples">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-triples" class="section-name selfRef">Triples</a>
          </h4>
<p id="section-5.1.4-1">The <code>triples-map</code> contains all the CoMID triples broken down per category.  Not
all category need to be present but at least one category MUST be present and
contain at least one entry.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4-2">In most cases, the supply chain entity that is responsible for providing a triple (i.e., Reference Values or Endorsed Values) is by default the CoRIM signer.
The signer of a triple is said to be its <em>authority</em>.
However, multiple authorities may be involved in signing triples.
See <span>[<a href="#STD96" class="cite xref">STD96</a>]</span>.
Consequently, authority may differ for search criteria.
See <a href="#sec-measurements" class="auto internal xref">Section 5.1.4.1.4</a>.<a href="#section-5.1.4-2" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4-3">
<pre>
triples-map = non-empty&lt;{
  ? &amp;(reference-triples: 0) =&gt;
    [ + reference-triple-record ]
  ? &amp;(endorsed-triples: 1) =&gt;
    [ + endorsed-triple-record ]
  ? &amp;(identity-triples: 2) =&gt;
    [ + identity-triple-record ]
  ? &amp;(attest-key-triples: 3) =&gt;
    [ + attest-key-triple-record ]
  ? &amp;(dependency-triples: 4) =&gt;
    [ + domain-dependency-triple-record ]
  ? &amp;(membership-triples: 5) =&gt;
    [ + domain-membership-triple-record ]
  ? &amp;(coswid-triples: 6) =&gt;
    [ + coswid-triple-record ]
  ? &amp;(conditional-endorsement-series-triples: 8) =&gt;
    [ + conditional-endorsement-series-triple-record ]
  ? &amp;(conditional-endorsement-triples: 10) =&gt;
    [ + conditional-endorsement-triple-record ]
  * $$triples-map-extension
}&gt;
</pre><a href="#section-5.1.4-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4-4">The following describes each member of the <code>triples-map</code>:<a href="#section-5.1.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4-5.1">
              <p id="section-5.1.4-5.1.1"><code>reference-triples</code> (index 0): Triples containing reference values.
Described in <a href="#sec-comid-triple-refval" class="auto internal xref">Section 5.1.4.2</a>.<a href="#section-5.1.4-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-5.2">
              <p id="section-5.1.4-5.2.1"><code>endorsed-triples</code> (index 1): Triples containing endorsed values.
Described in <a href="#sec-comid-triple-endval" class="auto internal xref">Section 5.1.4.3</a>.<a href="#section-5.1.4-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-5.3">
              <p id="section-5.1.4-5.3.1"><code>identity-triples</code> (index 2): Triples containing identity credentials.
Described in <a href="#sec-comid-triple-identity" class="auto internal xref">Section 5.1.4.6</a>.<a href="#section-5.1.4-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-5.4">
              <p id="section-5.1.4-5.4.1"><code>attest-key-triples</code> (index 3): Triples containing verification keys associated with attesting environments.
Described in <a href="#sec-comid-triple-attest-key" class="auto internal xref">Section 5.1.4.7</a>.<a href="#section-5.1.4-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-5.5">
              <p id="section-5.1.4-5.5.1"><code>dependency-triples</code> (index 4): Triples describing trust relationships between domains.
Described in <a href="#sec-comid-triple-domain-dependency" class="auto internal xref">Section 5.1.4.8.2</a>.<a href="#section-5.1.4-5.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-5.6">
              <p id="section-5.1.4-5.6.1"><code>membership-triples</code> (index 5): Triples describing topological relationships between (sub-)modules.
Described in <a href="#sec-comid-triple-domain-membership" class="auto internal xref">Section 5.1.4.8.1</a>.<a href="#section-5.1.4-5.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-5.7">
              <p id="section-5.1.4-5.7.1"><code>coswid-triples</code> (index 6): Triples associating modules with existing CoSWID tags.
Described in <a href="#sec-comid-triple-coswid" class="auto internal xref">Section 5.1.4.9</a>.<a href="#section-5.1.4-5.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-5.8">
              <p id="section-5.1.4-5.8.1"><code>conditional-endorsement-series-triples</code> (index 8): Triples describing a series of Endorsement that are applicable based on the acceptance of a series of stateful environment records.
Described in <a href="#sec-comid-triple-cond-series" class="auto internal xref">Section 5.1.4.5</a>.<a href="#section-5.1.4-5.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-5.9">
              <p id="section-5.1.4-5.9.1"><code>conditional-endorsement-triples</code> (index 10): Triples describing a series of conditional Endorsements based on the acceptance of a stateful environment.
Described in <a href="#sec-comid-triple-cond-endors" class="auto internal xref">Section 5.1.4.4</a>.<a href="#section-5.1.4-5.9.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="sec-environments">
<section id="section-5.1.4.1">
            <h5 id="name-environments">
<a href="#section-5.1.4.1" class="section-number selfRef">5.1.4.1. </a><a href="#name-environments" class="section-name selfRef">Environments</a>
            </h5>
<p id="section-5.1.4.1-1">An <code>environment-map</code> may be used to represent a whole Attester, an Attesting
Environment, or a Target Environment.  The exact semantic depends on the
context (triple) in which the environment is used.<a href="#section-5.1.4.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1-2">An environment is named after a class, instance or group identifier (or a
combination thereof).<a href="#section-5.1.4.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1-3">An environment MUST be globally unique.
The combination of values within <code>class-map</code> MUST combine to form a globally unique identifier.<a href="#section-5.1.4.1-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1-4">
<pre>
environment-map = non-empty&lt;{
  ? &amp;(class: 0) =&gt; class-map
  ? &amp;(instance: 1) =&gt; $instance-id-type-choice
  ? &amp;(group: 2) =&gt; $group-id-type-choice
}&gt;
</pre><a href="#section-5.1.4.1-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1-5">The following describes each member of the <code>environment-map</code>:<a href="#section-5.1.4.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.1-6.1">
                <p id="section-5.1.4.1-6.1.1"><code>class</code> (index 0): Contains "class" attributes associated with the module.
Described in <a href="#sec-comid-class" class="auto internal xref">Section 5.1.4.1.1</a>.<a href="#section-5.1.4.1-6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.4.1-6.2">
                <p id="section-5.1.4.1-6.2.1"><code>instance</code> (index 1): Contains a unique identifier of a module's instance.
Described in <a href="#sec-comid-instance" class="auto internal xref">Section 5.1.4.1.2</a>.<a href="#section-5.1.4.1-6.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.4.1-6.3">
                <p id="section-5.1.4.1-6.3.1"><code>group</code> (index 2): identifier for a group of instances, e.g., if an
anonymization scheme is used.
Described in <a href="#sec-comid-group" class="auto internal xref">Section 5.1.4.1.3</a>.<a href="#section-5.1.4.1-6.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<div id="sec-comid-class">
<section id="section-5.1.4.1.1">
              <h6 id="name-environment-class">
<a href="#section-5.1.4.1.1" class="section-number selfRef">5.1.4.1.1. </a><a href="#name-environment-class" class="section-name selfRef">Environment Class</a>
              </h6>
<p id="section-5.1.4.1.1-1">The Class name consists of class attributes that distinguish the class of
environment from other classes. The class attributes include class-id, vendor,
model, layer, and index. The CoMID author determines which attributes are
needed.<a href="#section-5.1.4.1.1-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.1-2">
<pre>
class-map = non-empty&lt;{
  ? &amp;(class-id: 0) =&gt; $class-id-type-choice
  ? &amp;(vendor: 1) =&gt; tstr
  ? &amp;(model: 2) =&gt; tstr
  ? &amp;(layer: 3) =&gt; uint
  ? &amp;(index: 4) =&gt; uint
}&gt;

$class-id-type-choice /= tagged-oid-type
$class-id-type-choice /= tagged-uuid-type
$class-id-type-choice /= tagged-bytes
</pre><a href="#section-5.1.4.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1.1-3">The following describes each member of the <code>class-map</code>:<a href="#section-5.1.4.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.1.1-4.1">
                  <p id="section-5.1.4.1.1-4.1.1"><code>class-id</code> (index 0): Identifies the environment via a well-known identifier.
Typically, <code>class-id</code> is an object identifier (OID) variable-length opaque byte string (<a href="#sec-common-tagged-bytes" class="auto internal xref">Section 7.8</a>) or universally unique identifier (UUID).
Use of this attribute is preferred.<a href="#section-5.1.4.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.1-4.2">
                  <p id="section-5.1.4.1.1-4.2.1"><code>vendor</code> (index 1): Identifies the entity responsible for choosing values for
the other class attributes that do not already have naming authority.<a href="#section-5.1.4.1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.1-4.3">
                  <p id="section-5.1.4.1.1-4.3.1"><code>model</code> (index 2): Describes a product, generation, and family.  If
populated, vendor MUST also be populated.<a href="#section-5.1.4.1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.1-4.4">
                  <p id="section-5.1.4.1.1-4.4.1"><code>layer</code> (index 3): Is used to capture where in a sequence the environment
exists. For example, the order in which bootstrap code is executed may have
security relevance.<a href="#section-5.1.4.1.1-4.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.1-4.5">
                  <p id="section-5.1.4.1.1-4.5.1"><code>index</code> (index 4): Is used when there are clones (i.e., multiple instances)
of the same class of environment.  Each clone is given a different index
value to disambiguate it from the other clones. For example, given a chassis
with several network interface controllers (NIC), each NIC can be given a
different index value.<a href="#section-5.1.4.1.1-4.5.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</section>
</div>
<div id="sec-comid-instance">
<section id="section-5.1.4.1.2">
              <h6 id="name-environment-instance">
<a href="#section-5.1.4.1.2" class="section-number selfRef">5.1.4.1.2. </a><a href="#name-environment-instance" class="section-name selfRef">Environment Instance</a>
              </h6>
<p id="section-5.1.4.1.2-1">An <code>instance-id</code> is a unique value that identifies a Target Environment instance.
The identifier is reliably bound to the Target Environment.
For example, if an X.509 certificate's subject public key is unique for each instance of a target environment, the <code>instance-id</code> might be created from that subject public key.
See <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
Alternatively, if the certificate's subject public key is large, the <code>instance-id</code> might be a key identifier that is a digest of that public key.
See <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.2" class="relref">Section 4.2.1.2</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
The key identifier is reliably bound to the subject public key because the identifier is a digest of the key.<a href="#section-5.1.4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.2-2">The types defined for an instance identifier are CBOR tagged expressions of
UEID, UUID, variable-length opaque byte string (<a href="#sec-common-tagged-bytes" class="auto internal xref">Section 7.8</a>), cryptographic keys, or cryptographic key identifiers.<a href="#section-5.1.4.1.2-2" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.2-3">
<pre>
$instance-id-type-choice /= tagged-ueid-type
$instance-id-type-choice /= tagged-uuid-type
$instance-id-type-choice /= tagged-bytes
$instance-id-type-choice /= tagged-pkix-base64-key-type
$instance-id-type-choice /= tagged-pkix-base64-cert-type
$instance-id-type-choice /= tagged-cose-key-type
$instance-id-type-choice /= tagged-key-thumbprint-type
$instance-id-type-choice /= tagged-cert-thumbprint-type
$instance-id-type-choice /= tagged-pkix-asn1der-cert-type
</pre><a href="#section-5.1.4.1.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-comid-group">
<section id="section-5.1.4.1.3">
              <h6 id="name-environment-group">
<a href="#section-5.1.4.1.3" class="section-number selfRef">5.1.4.1.3. </a><a href="#name-environment-group" class="section-name selfRef">Environment Group</a>
              </h6>
<p id="section-5.1.4.1.3-1">A group carries a unique identifier that is reliably bound to a group of
Attesters, for example when a number of Attester are hidden in the same
anonymity set.<a href="#section-5.1.4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.3-2">The types defined for a group identified are UUID and variable-length opaque byte string (<a href="#sec-common-tagged-bytes" class="auto internal xref">Section 7.8</a>).<a href="#section-5.1.4.1.3-2" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.3-3">
<pre>
$group-id-type-choice /= tagged-uuid-type
$group-id-type-choice /= tagged-bytes
</pre><a href="#section-5.1.4.1.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-measurements">
<section id="section-5.1.4.1.4">
              <h6 id="name-measurements">
<a href="#section-5.1.4.1.4" class="section-number selfRef">5.1.4.1.4. </a><a href="#name-measurements" class="section-name selfRef">Measurements</a>
              </h6>
<p id="section-5.1.4.1.4-1">Measurements can be of a variety of things including software, firmware,
configuration files, read-only memory, fuses, IO ring configuration, partial
reconfiguration regions, etc. Measurements comprise raw values, digests, or
status information.<a href="#section-5.1.4.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4-2">An environment has one or more measurable elements. Each element can have a
dedicated measurement or multiple elements could be combined into a single
measurement. Measurements can have class, instance or group scope.  This is
typically determined by the triple's environment.<a href="#section-5.1.4.1.4-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4-3">Class measurements apply generally to all the Attesters in a given class.<a href="#section-5.1.4.1.4-3" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4-4">Instance measurements apply to a specific Attester instance.  Environments
identified by a class identifier have measurements that are common to the
class. Environments identified by an instance identifier have measurements that
are specific to that instance.<a href="#section-5.1.4.1.4-4" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4-5">An environment may have multiple measured elements.
Measured elements are distinguished from each other by measurement keys.
Measurement keys may be used to disambiguate measurements of the same type originating from different elements.<a href="#section-5.1.4.1.4-5" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4-6">Triples that have search conditions may specify authority as matching criteria by populating <code>authorized-by</code>.<a href="#section-5.1.4.1.4-6" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.4-7">
<pre>
measurement-map = {
  ? &amp;(mkey: 0) =&gt; $measured-element-type-choice
  &amp;(mval: 1) =&gt; measurement-values-map
  ? &amp;(authorized-by: 2) =&gt; [ + $crypto-key-type-choice ]
}
</pre><a href="#section-5.1.4.1.4-7" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1.4-8">The following describes each member of the <code>measurement-map</code>:<a href="#section-5.1.4.1.4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.1.4-9.1">
                  <p id="section-5.1.4.1.4-9.1.1"><code>mkey</code> (index 0): An optional measurement key.
 Described in <a href="#sec-comid-mkey" class="auto internal xref">Section 5.1.4.1.4.1</a>.
 A <code>measurement-map</code> without an <code>mkey</code> is said to be anonymous.<a href="#section-5.1.4.1.4-9.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.4-9.2">
                  <p id="section-5.1.4.1.4-9.2.1"><code>mval</code> (index 1): The measurements associated with the environment.
 Described in <a href="#sec-comid-mval" class="auto internal xref">Section 5.1.4.1.4.2</a>.<a href="#section-5.1.4.1.4-9.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.4-9.3">
                  <p id="section-5.1.4.1.4-9.3.1"><code>authorized-by</code> (index 2): The cryptographic identity of the entity (individual or organization) that is
 the designated authority for measurement Claims.
 For example, the signer of a CoMID triple.
 See <a href="#sec-crypto-keys" class="auto internal xref">Section 5.1.4.1.5</a>.
 An entity is authoritative when it makes Claims that are inside its area of
competence.<a href="#section-5.1.4.1.4-9.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<div id="sec-comid-mkey">
<section id="section-5.1.4.1.4.1">
                <h6 id="name-measurement-keys">
<a href="#section-5.1.4.1.4.1" class="section-number selfRef">5.1.4.1.4.1. </a><a href="#name-measurement-keys" class="section-name selfRef">Measurement Keys</a>
                </h6>
<p id="section-5.1.4.1.4.1-1">Measurement keys SHALL be unique within the scope of the <code>environment-map</code> they are associated with.
The initial types defined are OID, UUID, uint, and tstr.
<code>mkey</code> may be necessary to disambiguate multiple measurements of the same type or to distinguish multiple measured elements within the same environment.
A single anonymous <code>measurement-map</code> is allowed within the same environment.
Two or more measurement-map entries within the same environment MUST populate <code>mkey</code>.<a href="#section-5.1.4.1.4.1-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.4.1-2">
<pre>
$measured-element-type-choice /= tagged-oid-type
$measured-element-type-choice /= tagged-uuid-type
$measured-element-type-choice /= uint
$measured-element-type-choice /= tstr
</pre><a href="#section-5.1.4.1.4.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-comid-mval">
<section id="section-5.1.4.1.4.2">
                <h6 id="name-measurement-values">
<a href="#section-5.1.4.1.4.2" class="section-number selfRef">5.1.4.1.4.2. </a><a href="#name-measurement-values" class="section-name selfRef">Measurement Values</a>
                </h6>
<p id="section-5.1.4.1.4.2-1">A <code>measurement-values-map</code> contains measurements associated with a certain
environment. Depending on the context (triple) in which they are found,
elements in a <code>measurement-values-map</code> can represent class or instance
measurements. Note that some of the elements have instance scope only.<a href="#section-5.1.4.1.4.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4.2-2">Measurement values may support use cases beyond Verifier appraisal.
Typically, a Relying Party determines if additional processing is desirable
and whether the processing is applied by the Verifier or the Relying Party.<a href="#section-5.1.4.1.4.2-2" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.4.2-3">
<pre>
measurement-values-map = non-empty&lt;{
  ? &amp;(version: 0) =&gt; version-map
  ? &amp;(svn: 1) =&gt; svn-type-choice
  ? &amp;(digests: 2) =&gt; digests-type
  ? &amp;(flags: 3) =&gt; flags-map
  ? (
      &amp;(raw-value: 4) =&gt; $raw-value-type-choice,
      ? &amp;(raw-value-mask-DEPRECATED: 5) =&gt; raw-value-mask-type
    )
  ? &amp;(mac-addr: 6) =&gt; mac-addr-type-choice
  ? &amp;(ip-addr: 7) =&gt;  ip-addr-type-choice
  ? &amp;(serial-number: 8) =&gt; text
  ? &amp;(ueid: 9) =&gt; ueid-type
  ? &amp;(uuid: 10) =&gt; uuid-type
  ? &amp;(name: 11) =&gt; text
  ? &amp;(cryptokeys: 13) =&gt; [ + $crypto-key-type-choice ]
  ? &amp;(integrity-registers: 14) =&gt; integrity-registers
  ? &amp;(int-range: 15) =&gt; int-range-type-choice
  * $$measurement-values-map-extension
}&gt;
</pre><a href="#section-5.1.4.1.4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1.4.2-4">The following describes each member of the <code>measurement-values-map</code>.<a href="#section-5.1.4.1.4.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.1.4.2-5.1">
                    <p id="section-5.1.4.1.4.2-5.1.1"><code>version</code> (index 0): Typically changes whenever the measured environment is updated.
Described in <a href="#sec-comid-version" class="auto internal xref">Section 5.1.4.1.4.3</a>.<a href="#section-5.1.4.1.4.2-5.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.2">
                    <p id="section-5.1.4.1.4.2-5.2.1"><code>svn</code> (index 1): The security version number typically changes only when a security relevant change is made to the measured environment.
Described in <a href="#sec-comid-svn" class="auto internal xref">Section 5.1.4.1.4.4</a>.<a href="#section-5.1.4.1.4.2-5.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.3">
                    <p id="section-5.1.4.1.4.2-5.3.1"><code>digests</code> (index 2): Contains the digest(s) of the measured environment
together with the respective hash algorithm used in the process.
It uses the <code>digests-type</code>.
Described in <a href="#sec-common-hash-entry" class="auto internal xref">Section 7.7</a>.<a href="#section-5.1.4.1.4.2-5.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.4">
                    <p id="section-5.1.4.1.4.2-5.4.1"><code>flags</code> (index 3): Describes security relevant operational modes.
For example, whether the environment is in a debug mode, recovery mode, not fully
configured, not secure, not replay protected or not integrity protected.
The <code>flags</code> field indicates which operational modes are currently associated with measured environment.
Described in <a href="#sec-comid-flags" class="auto internal xref">Section 5.1.4.1.4.5</a>.<a href="#section-5.1.4.1.4.2-5.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.5">
                    <p id="section-5.1.4.1.4.2-5.5.1"><code>raw-value</code> (index 4): Contains the actual (not hashed) value of the element.
The vendor determines the encoding of <code>raw-value</code>.
When used for comparison, the <code>tagged-masked-raw-value</code> variant includes a mask indicating which bits in the value to compare.
Described in <a href="#sec-comid-raw-value-types" class="auto internal xref">Section 5.1.4.1.4.6</a><a href="#section-5.1.4.1.4.2-5.5.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.6">
                    <p id="section-5.1.4.1.4.2-5.6.1"><code>raw-value-mask-DEPRECATED</code> (index 5): Is an obsolete method of indicating which bits in a raw value to compare. New CoMID files should use the <code>tagged-masked-raw-value</code> on index 4 instead of using index 5.<a href="#section-5.1.4.1.4.2-5.6.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.7">
                    <p id="section-5.1.4.1.4.2-5.7.1"><code>mac-addr</code> (index 6): A EUI-48 or EUI-64 MAC address associated with the measured environment.
Described in <a href="#sec-comid-address-types" class="auto internal xref">Section 5.1.4.1.4.7</a>.<a href="#section-5.1.4.1.4.2-5.7.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.8">
                    <p id="section-5.1.4.1.4.2-5.8.1"><code>ip-addr</code> (index 7): An IPv4 or IPv6 address associated with the measured environment.
Described in <a href="#sec-comid-address-types" class="auto internal xref">Section 5.1.4.1.4.7</a>.<a href="#section-5.1.4.1.4.2-5.8.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.9">
                    <p id="section-5.1.4.1.4.2-5.9.1"><code>serial-number</code> (index 8): A text string representing the product serial number.<a href="#section-5.1.4.1.4.2-5.9.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.10">
                    <p id="section-5.1.4.1.4.2-5.10.1"><code>ueid</code> (index 9): UEID associated with the measured environment.
Described in <a href="#sec-common-ueid" class="auto internal xref">Section 7.5</a>.<a href="#section-5.1.4.1.4.2-5.10.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.11">
                    <p id="section-5.1.4.1.4.2-5.11.1"><code>uuid</code> (index 10): UUID associated with the measured environment.
Described in <a href="#sec-common-uuid" class="auto internal xref">Section 7.4</a>.<a href="#section-5.1.4.1.4.2-5.11.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.12">
                    <p id="section-5.1.4.1.4.2-5.12.1"><code>name</code> (index 11): a name associated with the measured environment.<a href="#section-5.1.4.1.4.2-5.12.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.13">
                    <p id="section-5.1.4.1.4.2-5.13.1"><code>cryptokeys</code> (index 13): identifies cryptographic keys that are protected by the Target Environment
See <a href="#sec-crypto-keys" class="auto internal xref">Section 5.1.4.1.5</a> for the supported formats.
An Attesting Environment determines that keys are protected as part of Claims collection.
Appraisal verifies that, for each value in <code>cryptokeys</code>, there is a matching Reference Value entry.
Matching is described in <a href="#sec-cryptokeys-matching" class="auto internal xref">Section 9.4.6.1.5</a>.<a href="#section-5.1.4.1.4.2-5.13.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.2-5.14">
                    <p id="section-5.1.4.1.4.2-5.14.1"><code>integrity-registers</code> (index 14): A group of one or more named measurements associated with the environment.  Described in <a href="#sec-comid-integrity-registers" class="auto internal xref">Section 5.1.4.1.6</a>.<a href="#section-5.1.4.1.4.2-5.14.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</section>
</div>
<div id="sec-comid-version">
<section id="section-5.1.4.1.4.3">
                <h6 id="name-version">
<a href="#section-5.1.4.1.4.3" class="section-number selfRef">5.1.4.1.4.3. </a><a href="#name-version" class="section-name selfRef">Version</a>
                </h6>
<p id="section-5.1.4.1.4.3-1">A <code>version-map</code> contains details about the versioning of a measured
environment.<a href="#section-5.1.4.1.4.3-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.4.3-2">
<pre>
version-map = {
  &amp;(version: 0) =&gt; text
  ? &amp;(version-scheme: 1) =&gt; $version-scheme
}
</pre><a href="#section-5.1.4.1.4.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1.4.3-3">The following describes each member of the <code>version-map</code>:<a href="#section-5.1.4.1.4.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.1.4.3-4.1">
                    <p id="section-5.1.4.1.4.3-4.1.1"><code>version</code> (index 0): the version string<a href="#section-5.1.4.1.4.3-4.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.3-4.2">
                    <p id="section-5.1.4.1.4.3-4.2.1"><code>version-scheme</code> (index 1): an optional indicator of the versioning
convention used in the <code>version</code> attribute.
Defined in <span><a href="https://rfc-editor.org/rfc/rfc9393#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC9393" class="cite xref">RFC9393</a>]</span>.
The CDDL is copied below for convenience.<a href="#section-5.1.4.1.4.3-4.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.4.3-5">
<pre>
$version-scheme /= &amp;(multipartnumeric: 1)
$version-scheme /= &amp;(multipartnumeric-suffix: 2)
$version-scheme /= &amp;(alphanumeric: 3)
$version-scheme /= &amp;(decimal: 4)
$version-scheme /= &amp;(semver: 16384)
$version-scheme /= int / text
</pre><a href="#section-5.1.4.1.4.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-comid-svn">
<section id="section-5.1.4.1.4.4">
                <h6 id="name-security-version-number">
<a href="#section-5.1.4.1.4.4" class="section-number selfRef">5.1.4.1.4.4. </a><a href="#name-security-version-number" class="section-name selfRef">Security Version Number</a>
                </h6>
<p id="section-5.1.4.1.4.4-1">The following details the security version number (<code>svn</code>) and the minimum security version number (<code>min-svn</code>) statements.
A security version number is used to track changes to an object (e.g., a secure enclave, a boot loader executable, a configuration file, etc.) that are security relevant.
Rollback of a security relevant change is considered to be an attack vector; as such, security version numbers cannot be decremented.
If a security relevant flaw is discovered in the Target Environment and is subsequently fixed, the <code>svn</code> value is typically incremented.<a href="#section-5.1.4.1.4.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4.4-2">There may be several revisions to a Target Environment that are in use at the same time.
If there are multiple revisions with different <code>svn</code> values, the revision with a lower <code>svn</code> value may
or may not be in a security critical condition. The Endorser may provide a minimum security version number
using <code>min-svn</code> to specify the lowest <code>svn</code> value that is acceptable.
<code>svn</code> values that are equal to or greater than <code>min-svn</code> do not signal a security critical condition.
<code>svn</code> values that are below <code>min-svn</code> are in a security critical condition that is unsafe for normal use.<a href="#section-5.1.4.1.4.4-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4.4-3">The <code>svn-type-choice</code> measurement consists of a <code>tagged-svn</code> or <code>tagged-min-svn</code> value.
The <code>tagged-svn</code> and <code>tagged-min-svn</code> tags are CBOR tags with the values <code>#6.552</code> and <code>#6.553</code> respectively.<a href="#section-5.1.4.1.4.4-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.4.4-4">
<pre>
svn-type = uint
svn = svn-type
min-svn = svn-type
tagged-svn = #6.552(svn)
tagged-min-svn = #6.553(min-svn)
svn-type-choice = svn / tagged-svn / tagged-min-svn
</pre><a href="#section-5.1.4.1.4.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-comid-flags">
<section id="section-5.1.4.1.4.5">
                <h6 id="name-flags">
<a href="#section-5.1.4.1.4.5" class="section-number selfRef">5.1.4.1.4.5. </a><a href="#name-flags" class="section-name selfRef">Flags</a>
                </h6>
<p id="section-5.1.4.1.4.5-1">The <code>flags-map</code> measurement describes a number of boolean operational modes.
If a <code>flags-map</code> value is not specified, then the operational mode is unknown.<a href="#section-5.1.4.1.4.5-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.4.5-2">
<pre>
flags-map = {
  ? &amp;(is-configured: 0) =&gt; bool
  ? &amp;(is-secure: 1) =&gt; bool
  ? &amp;(is-recovery: 2) =&gt; bool
  ? &amp;(is-debug: 3) =&gt; bool
  ? &amp;(is-replay-protected: 4) =&gt; bool
  ? &amp;(is-integrity-protected: 5) =&gt; bool
  ? &amp;(is-runtime-meas: 6) =&gt; bool
  ? &amp;(is-immutable: 7) =&gt; bool
  ? &amp;(is-tcb: 8) =&gt; bool
  ? &amp;(is-confidentiality-protected: 9) =&gt; bool
  * $$flags-map-extension
}
</pre><a href="#section-5.1.4.1.4.5-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1.4.5-3">The following describes each member of the <code>flags-map</code>:<a href="#section-5.1.4.1.4.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.1.4.5-4.1">
                    <p id="section-5.1.4.1.4.5-4.1.1"><code>is-configured</code> (index 0): If the flag is true, the measured environment is fully configured for normal operation.<a href="#section-5.1.4.1.4.5-4.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.5-4.2">
                    <p id="section-5.1.4.1.4.5-4.2.1"><code>is-secure</code> (index 1): If the flag is true, the measured environment's configurable
security settings are fully enabled.<a href="#section-5.1.4.1.4.5-4.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.5-4.3">
                    <p id="section-5.1.4.1.4.5-4.3.1"><code>is-recovery</code> (index 2): If the flag is true, the measured environment is in recovery
mode.<a href="#section-5.1.4.1.4.5-4.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.5-4.4">
                    <p id="section-5.1.4.1.4.5-4.4.1"><code>is-debug</code> (index 3): If the flag is true, the measured environment is in a debug enabled
mode.<a href="#section-5.1.4.1.4.5-4.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.5-4.5">
                    <p id="section-5.1.4.1.4.5-4.5.1"><code>is-replay-protected</code> (index 4): If the flag is true, the measured environment is
protected from rollback to previous software images.<a href="#section-5.1.4.1.4.5-4.5.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.5-4.6">
                    <p id="section-5.1.4.1.4.5-4.6.1"><code>is-integrity-protected</code> (index 5): If the flag is true, the measured environment is
protected from unauthorized update.<a href="#section-5.1.4.1.4.5-4.6.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.5-4.7">
                    <p id="section-5.1.4.1.4.5-4.7.1"><code>is-runtime-meas</code> (index 6): If the flag is true, the measured environment is measured
after being loaded into memory.<a href="#section-5.1.4.1.4.5-4.7.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.5-4.8">
                    <p id="section-5.1.4.1.4.5-4.8.1"><code>is-immutable</code> (index 7): If the flag is true, the measured environment is immutable.<a href="#section-5.1.4.1.4.5-4.8.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.5-4.9">
                    <p id="section-5.1.4.1.4.5-4.9.1"><code>is-tcb</code> (index 8): If the flag is true, the measured environment is a trusted
computing base.<a href="#section-5.1.4.1.4.5-4.9.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1.4.1.4.5-4.10">
                    <p id="section-5.1.4.1.4.5-4.10.1"><code>is-confidentiality-protected</code> (index 9): If the flag is true, the measured environment
is confidentiality protected. For example, if the measured environment consists of memory,
the sensitive values in memory are encrypted.<a href="#section-5.1.4.1.4.5-4.10.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</section>
</div>
<div id="sec-comid-raw-value-types">
<section id="section-5.1.4.1.4.6">
                <h6 id="name-raw-values-types">
<a href="#section-5.1.4.1.4.6" class="section-number selfRef">5.1.4.1.4.6. </a><a href="#name-raw-values-types" class="section-name selfRef">Raw Values Types</a>
                </h6>
<p id="section-5.1.4.1.4.6-1">Raw value measurements are typically vendor defined values that are checked by Verifiers
for consistency only, since the security relevance is opaque to Verifiers. A profile may choose
to define more specific semantic meaning to a raw value.<a href="#section-5.1.4.1.4.6-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4.6-2">A <code>raw-value</code> measurement, or an Endorsement, is a tagged value of type <code>bytes</code>.
This specification defines tag #6.560.
The default raw value measurement is of type <code>tagged-bytes</code> (<a href="#sec-common-tagged-bytes" class="auto internal xref">Section 7.8</a>).<a href="#section-5.1.4.1.4.6-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4.6-3">Additional value types can be added to <code>$raw-value-type-choice</code>. These additional values MUST be CBOR tagged <code>bstr</code>s.
Constraining all raw value types to be <code>bstr</code> lets Verifiers compare raw values without understanding their contents.<a href="#section-5.1.4.1.4.6-3" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4.6-4">A raw value intended for comparison can include a mask value, which selects the bits to compare during appraisal.
The mask is applied by the Verifier as part of appraisal.
Only the raw value bits with corresponding TRUE mask bits are compared during appraisal.<a href="#section-5.1.4.1.4.6-4" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.4.6-5">The <code>raw-value-mask-DEPRECATED</code> in <code>measurement-values-map</code> is deprecated, but retained for backwards compatibility.
This code point may be removed in a future revision of this specification.<a href="#section-5.1.4.1.4.6-5" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.4.6-6">
<pre>
$raw-value-type-choice /= tagged-bytes
$raw-value-type-choice /= tagged-masked-raw-value

raw-value-mask-type = bytes
tagged-masked-raw-value = #6.563([
  value: bytes
  mask : bytes
])
</pre><a href="#section-5.1.4.1.4.6-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-comid-address-types">
<section id="section-5.1.4.1.4.7">
                <h6 id="name-address-types">
<a href="#section-5.1.4.1.4.7" class="section-number selfRef">5.1.4.1.4.7. </a><a href="#name-address-types" class="section-name selfRef">Address Types</a>
                </h6>
<p id="section-5.1.4.1.4.7-1">The types or associating addressing information to a measured environment are:<a href="#section-5.1.4.1.4.7-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.4.7-2">
<pre>
ip-addr-type-choice = ip4-addr-type / ip6-addr-type
ip4-addr-type = bytes .size 4
ip6-addr-type = bytes .size 16

mac-addr-type-choice = eui48-addr-type / eui64-addr-type
eui48-addr-type = bytes .size 6
eui64-addr-type = bytes .size 8
</pre><a href="#section-5.1.4.1.4.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec-crypto-keys">
<section id="section-5.1.4.1.5">
              <h6 id="name-crypto-keys">
<a href="#section-5.1.4.1.5" class="section-number selfRef">5.1.4.1.5. </a><a href="#name-crypto-keys" class="section-name selfRef">Crypto Keys</a>
              </h6>
<p id="section-5.1.4.1.5-1">A cryptographic key can be one of the following formats:<a href="#section-5.1.4.1.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.1.5-2.1">
                  <p id="section-5.1.4.1.5-2.1.1"><code>tagged-pkix-base64-key-type</code>: PEM encoded SubjectPublicKeyInfo.
Defined in <span><a href="https://rfc-editor.org/rfc/rfc7468#section-13" class="relref">Section 13</a> of [<a href="#RFC7468" class="cite xref">RFC7468</a>]</span>.<a href="#section-5.1.4.1.5-2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.5-2.2">
                  <p id="section-5.1.4.1.5-2.2.1"><code>tagged-pkix-base64-cert-type</code>: PEM encoded X.509 public key certificate.
Defined in <span><a href="https://rfc-editor.org/rfc/rfc7468#section-5" class="relref">Section 5</a> of [<a href="#RFC7468" class="cite xref">RFC7468</a>]</span>.<a href="#section-5.1.4.1.5-2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.5-2.3">
                  <p id="section-5.1.4.1.5-2.3.1"><code>tagged-pkix-base64-cert-path-type</code>: X.509 certificate chain created by the
concatenation of as many PEM encoded X.509 certificates as needed.  The
certificates MUST be concatenated in order so that each directly certifies
the one preceding.<a href="#section-5.1.4.1.5-2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.5-2.4">
                  <p id="section-5.1.4.1.5-2.4.1"><code>tagged-cose-key-type</code>: CBOR encoded COSE_Key or COSE_KeySet.
Defined in <span><a href="https://rfc-editor.org/rfc/rfc9052#section-7" class="relref">Section 7</a> of [<a href="#STD96" class="cite xref">STD96</a>]</span>.<a href="#section-5.1.4.1.5-2.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.5-2.5">
                  <p id="section-5.1.4.1.5-2.5.1"><code>tagged-pkix-asn1der-cert-type</code>: a <code>bstr</code> of ASN.1 DER encoded X.509 public key certificate.
Defined in <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4" class="relref">Section 4</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-5.1.4.1.5-2.5.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-5.1.4.1.5-3">A cryptographic key digest can be one of the following formats:<a href="#section-5.1.4.1.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.1.5-4.1">
                  <p id="section-5.1.4.1.5-4.1.1"><code>tagged-key-thumbprint-type</code>: a <code>digest</code> (e.g., the SHA-2 hash) of a raw public key.
For example, the digest value can be used to locate a public key contained in a lookup table.
Ultimately, the discovered keys have to be successfully byte-by-byte compared with the corresponding keys.<a href="#section-5.1.4.1.5-4.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.5-4.2">
                  <p id="section-5.1.4.1.5-4.2.1"><code>tagged-cert-thumbprint-type</code>: a <code>digest</code> of a certificate.
The digest value may be used to find the certificate if contained in a lookup table.<a href="#section-5.1.4.1.5-4.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.5-4.3">
                  <p id="section-5.1.4.1.5-4.3.1"><code>tagged-cert-path-thumbprint-type</code>: a <code>digest</code> of a certification path.
The digest value may be used to find the certificate path if contained in a lookup table.<a href="#section-5.1.4.1.5-4.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.1.4.1.5-4.4">
                  <p id="section-5.1.4.1.5-4.4.1"><code>tagged-bytes</code>: a key identifier with no prescribed construction method.<a href="#section-5.1.4.1.5-4.4.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.5-5">
<pre>
$crypto-key-type-choice /= tagged-pkix-base64-key-type
$crypto-key-type-choice /= tagged-pkix-base64-cert-type
$crypto-key-type-choice /= tagged-pkix-base64-cert-path-type
$crypto-key-type-choice /= tagged-cose-key-type
$crypto-key-type-choice /= tagged-pkix-asn1der-cert-type
$crypto-key-type-choice /= tagged-key-thumbprint-type
$crypto-key-type-choice /= tagged-cert-thumbprint-type
$crypto-key-type-choice /= tagged-cert-path-thumbprint-type
$crypto-key-type-choice /= tagged-bytes
tagged-pkix-base64-key-type = #6.554(tstr)
tagged-pkix-base64-cert-type = #6.555(tstr)
tagged-pkix-base64-cert-path-type = #6.556(tstr)
tagged-key-thumbprint-type = #6.557(digest)
tagged-cose-key-type = #6.558(COSE_Key)
tagged-cert-thumbprint-type = #6.559(digest)
tagged-cert-path-thumbprint-type = #6.561(digest)
tagged-pkix-asn1der-cert-type = #6.562(bstr)
</pre><a href="#section-5.1.4.1.5-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-comid-integrity-registers">
<section id="section-5.1.4.1.6">
              <h6 id="name-integrity-registers">
<a href="#section-5.1.4.1.6" class="section-number selfRef">5.1.4.1.6. </a><a href="#name-integrity-registers" class="section-name selfRef">Integrity Registers</a>
              </h6>
<p id="section-5.1.4.1.6-1">An Integrity Registers map groups together one or more measured "objects".
Each measured object has a unique identifier and one or more associated digests.
Identifiers are either unsigned integers or text strings and their type matters, e.g., unsigned integer 5 is distinct from the text string "5".
The digests use <code>digests-type</code> semantics (<a href="#sec-common-hash-entry" class="auto internal xref">Section 7.7</a>).<a href="#section-5.1.4.1.6-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.6-2">
<pre>
integrity-register-id-type-choice = uint / text

integrity-registers = {
  + integrity-register-id-type-choice =&gt; digests-type
}
</pre><a href="#section-5.1.4.1.6-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1.6-3">All the measured objects in an Integrity Registers map are explicitly named and the order in which they appear in the map is irrelevant.
Any digests associated with a measured object represent an acceptable state for the object.
Therefore, if multiple digests are provided, the acceptable state is their cross-product.
For example, given the following Integrity Registers:<a href="#section-5.1.4.1.6-3" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-5.1.4.1.6-4">
<pre>
{
  0: [ [ 0, h'00' ] ],
  1: [ [ 0, h'11' ], [ 1, h'12' ] ]
}
</pre><a href="#section-5.1.4.1.6-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1.6-5">then both<a href="#section-5.1.4.1.6-5" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-5.1.4.1.6-6">
<pre>
{
  0: [ 0, h'00' ],
  1: [ 0, h'11' ]
}
</pre><a href="#section-5.1.4.1.6-6" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1.6-7">and<a href="#section-5.1.4.1.6-7" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-5.1.4.1.6-8">
<pre>
{
  0: [ 0, h'00' ],
  1: [ 1, h'12' ]
}
</pre><a href="#section-5.1.4.1.6-8" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1.6-9">are acceptable states.<a href="#section-5.1.4.1.6-9" class="pilcrow">¶</a></p>
<p id="section-5.1.4.1.6-10">Integrity Registers can be used to model the PCRs in a TPM or vTPM, in which case the identifier is the register index, or other kinds of vendor-specific measured objects.<a href="#section-5.1.4.1.6-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-comid-int-range">
<section id="section-5.1.4.1.7">
              <h6 id="name-int-range">
<a href="#section-5.1.4.1.7" class="section-number selfRef">5.1.4.1.7. </a><a href="#name-int-range" class="section-name selfRef">Int Range</a>
              </h6>
<p id="section-5.1.4.1.7-1">An int range describes an integer value that can be compared with linear order in the target environment.
An int range is represented with either major type 0 or major type 1 ints.<a href="#section-5.1.4.1.7-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.1.7-2">
<pre>
int-range-type-choice = int / tagged-int-range
int-range = [min: int / negative-inf, max: int / positive-inf]
tagged-int-range = #6.564(int-range)
positive-inf = null
negative-inf = null
</pre><a href="#section-5.1.4.1.7-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.1.7-3">The signed integer range representation is an inclusive range unless either <code>min</code> or <code>max</code> are infinite as represented by <code>null</code>, in which case, each infinity is necessarily exclusive.<a href="#section-5.1.4.1.7-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-comid-triple-refval">
<section id="section-5.1.4.2">
            <h5 id="name-reference-values-triple">
<a href="#section-5.1.4.2" class="section-number selfRef">5.1.4.2. </a><a href="#name-reference-values-triple" class="section-name selfRef">Reference Values Triple</a>
            </h5>
<p id="section-5.1.4.2-1">Reference Values Triples describe the possible intended states of an Attester.
At any given point in time, an Attester is expected to match only one of these states.<a href="#section-5.1.4.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.2-2">A Reference Values Triple provides reference values pertaining to a Target Environment.
In a Reference Value triple, the subject identifies a Target Environment, the object contains reference measurements associated with one or more measured elements of the Environment, and the predicate asserts that these represent the expected state of the Target Environment.<a href="#section-5.1.4.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4.2-3">The Reference Values Triple has the following structure:<a href="#section-5.1.4.2-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.2-4">
<pre>
reference-triple-record = [
  ref-env: environment-map
  ref-claims: [ + measurement-map ]
]
</pre><a href="#section-5.1.4.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.2-5">The <code>reference-triple-record</code> has the following parameters:<a href="#section-5.1.4.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.2-6.1">
                <p id="section-5.1.4.2-6.1.1"><code>ref-env</code>: Identifies the Target Environment<a href="#section-5.1.4.2-6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.4.2-6.2">
                <p id="section-5.1.4.2-6.2.1"><code>ref-claims</code>: Contains one or more reference measurements for the Target Environment<a href="#section-5.1.4.2-6.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.1.4.2-7">CoMID triples (<a href="#sec-comid-triples" class="auto internal xref">Section 5.1.4</a>) may contain multiple <code>reference-triple-record</code> entries, each of which describes one or more possible states for a particular Target Environment.<a href="#section-5.1.4.2-7" class="pilcrow">¶</a></p>
<p id="section-5.1.4.2-8">The <code>ref-claims</code> in a <code>reference-triple-record</code> can contain one or more entries.
This multiplicity can have different meanings:<a href="#section-5.1.4.2-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.4.2-9">
<li id="section-5.1.4.2-9.1">
                <p id="section-5.1.4.2-9.1.1">Each <code>ref-claims</code> entry can represent a different possible state of the Environment.<a href="#section-5.1.4.2-9.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-5.1.4.2-9.2">
                <p id="section-5.1.4.2-9.2.1">Each <code>ref-claims</code> entry can represent a possible state of a different measured element (identified by its <code>mkey</code>) within the Environment.<a href="#section-5.1.4.2-9.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-5.1.4.2-10">Note that the same semantics can be expressed using multiple Reference Value Triples.<a href="#section-5.1.4.2-10" class="pilcrow">¶</a></p>
<p id="section-5.1.4.2-11">Note also that a measurement key-value pair could be defined to have multiple values or use "wild carding" to describe a range of acceptable values, for example when using <code>int-range</code> and <code>min-svn</code>.<a href="#section-5.1.4.2-11" class="pilcrow">¶</a></p>
<p id="section-5.1.4.2-12">Any of these multiplicities could be used in the context of Reference Values Triples.<a href="#section-5.1.4.2-12" class="pilcrow">¶</a></p>
<p id="section-5.1.4.2-13">To process a <code>reference-triple-record</code>, the <code>ref-env</code> and <code>ref-claims</code> criteria are compared with Evidence entries.
First, <code>ref-env</code> is used as search criteria to locate matching Evidence environments.
Then, the <code>ref-claims</code> from this triple are used to match against the Evidence measurements for a matched environment.
If the search criteria are satisfied, the matching entry is added to the body of Attester state, except these Claims are asserted with the Reference Value Provider's authority.
By re-asserting Evidence matched with Reference Values using the RVP's authority, the Verifier avoids confusing Reference Values (reference / possible state) with Evidence (actual state).
See <span>[<a href="#I-D.ietf-rats-endorsements" class="cite xref">I-D.ietf-rats-endorsements</a>]</span>.
Evidence Claims that are re-asserted using RVP authority are said to be "corroborated Evidence" because the actual state in Evidence was found within the corpus of the RVP's possible state.<a href="#section-5.1.4.2-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-comid-triple-endval">
<section id="section-5.1.4.3">
            <h5 id="name-endorsed-values-triple">
<a href="#section-5.1.4.3" class="section-number selfRef">5.1.4.3. </a><a href="#name-endorsed-values-triple" class="section-name selfRef">Endorsed Values Triple</a>
            </h5>
<p id="section-5.1.4.3-1">An Endorsed Values triple provides additional Endorsements - i.e., claims reflecting the actual state - for an existing Target Environment.
For Endorsed Values Claims, the subject is a Target Environment, the object contains Endorsement Claims for the Environment, and the predicate defines semantics for how the object relates to the subject.<a href="#section-5.1.4.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.3-2">The Endorsed Values Triple has the following structure:<a href="#section-5.1.4.3-2" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.3-3">
<pre>
endorsed-triple-record = [
  condition: environment-map
  endorsement: [ + measurement-map ]
]
</pre><a href="#section-5.1.4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.3-4">The <code>endorsed-triple-record</code> has the following parameters:<a href="#section-5.1.4.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.3-5.1">
                <p id="section-5.1.4.3-5.1.1"><code>condition</code>: Search criterion that locates an Evidence, corroborated Evidence, or Endorsements environment.<a href="#section-5.1.4.3-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.4.3-5.2">
                <p id="section-5.1.4.3-5.2.1"><code>endorsement</code>: Additional Endorsement Claims.<a href="#section-5.1.4.3-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.1.4.3-6">To process a <code>endorsed-triple-record</code> the <code>condition</code> is compared with existing Evidence, corroborated Evidence, and Endorsements.
If the search criterion is satisfied, the <code>endorsement</code> Claims are combined with the <code>condition</code> <code>environment-map</code> to form a new (actual state) entry.
The new entry is added to the existing set of entries using the Endorser's authority.<a href="#section-5.1.4.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-comid-triple-cond-endors">
<section id="section-5.1.4.4">
            <h5 id="name-conditional-endorsement-tri">
<a href="#section-5.1.4.4" class="section-number selfRef">5.1.4.4. </a><a href="#name-conditional-endorsement-tri" class="section-name selfRef">Conditional Endorsement Triple</a>
            </h5>
<p id="section-5.1.4.4-1">A Conditional Endorsement Triple declares one or more conditions that, once matched, results in augmenting the Attester's actual state with the Endorsement Claims.
The conditions are expressed via <code>stateful-environment-records</code>, which match Target Environments from Evidence in certain reference state.<a href="#section-5.1.4.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.4-2">The Conditional Endorsement Triple has the following structure:<a href="#section-5.1.4.4-2" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.4-3">
<pre>
conditional-endorsement-triple-record = [
  conditions: [ + stateful-environment-record ]
  endorsements: [ + endorsed-triple-record ]
]

stateful-environment-record = [
  environment: environment-map,
  claims-list: [ + measurement-map ]
]
</pre><a href="#section-5.1.4.4-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.4-4">The <code>conditional-endorsement-triple-record</code> has the following parameters:<a href="#section-5.1.4.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.4-5.1">
                <p id="section-5.1.4.4-5.1.1"><code>conditions</code>: Search criteria that locates Evidence, corroborated Evidence, or Endorsements.<a href="#section-5.1.4.4-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.4.4-5.2">
                <p id="section-5.1.4.4-5.2.1"><code>endorsements</code>: Additional Endorsements.<a href="#section-5.1.4.4-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.1.4.4-6">To process a <code>conditional-endorsement-triple-record</code> the <code>conditions</code> are compared with existing Evidence, corroborated Evidence, and Endorsements.
If the search criteria are satisfied, the <code>endorsements</code> entries are asserted with the Endorser's authority as new Endorsements.<a href="#section-5.1.4.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-comid-triple-cond-series">
<section id="section-5.1.4.5">
            <h5 id="name-conditional-endorsement-ser">
<a href="#section-5.1.4.5" class="section-number selfRef">5.1.4.5. </a><a href="#name-conditional-endorsement-ser" class="section-name selfRef">Conditional Endorsement Series Triple</a>
            </h5>
<p id="section-5.1.4.5-1">The Conditional Endorsement Series Triple is used to assert endorsed values based on an initial condition match (specified in <code>condition:</code>) followed by a series condition match (specified in <code>selection:</code> inside <code>conditional-series-record</code>).
Every <code>conditional-series-record</code> selection MUST select the same mkeys where every selected mkey's corresponding set of code points represented as mval.key MUST be the same across each <code>conditional-series-record</code>.
For example, if a selection matches on 3 <code>measurement-map</code> statements; <code>mkey</code> is the same for all 3 statements and <code>mval</code> contains only A= variable-X, B= variable-Y, and C= variable-Z (exactly the set of code points A, B, and C) respectively for every <code>conditional-series-record</code> in the series.<a href="#section-5.1.4.5-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.5-2">These restrictions ensure that evaluation order does not change the meaning of the triple during the appraisal process.
Series entries are ordered such that the most precise match is evaluated first and least precise match is evaluated last.
The first series condition that matches terminates series matching and the endorsement values are added to the Attester's actual state.<a href="#section-5.1.4.5-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4.5-3">The Conditional Endorsement Series Triple has the following structure:<a href="#section-5.1.4.5-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.5-4">
<pre>
conditional-endorsement-series-triple-record = [
  condition: stateful-environment-record
  series: [ + conditional-series-record ]
]

conditional-series-record = [
  selection: [ + measurement-map]
  addition: [ + measurement-map ]
]
</pre><a href="#section-5.1.4.5-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.5-5">The <code>conditional-endorsement-series-triple-record</code> has the following parameters:<a href="#section-5.1.4.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.5-6.1">
                <p id="section-5.1.4.5-6.1.1"><code>condition</code>: Search criteria that locates Evidence, corroborated Evidence, or Endorsements.<a href="#section-5.1.4.5-6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.4.5-6.2">
                <p id="section-5.1.4.5-6.2.1"><code>series</code>: A set of selection-addition tuples.<a href="#section-5.1.4.5-6.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.1.4.5-7">The <code>conditional-series-record</code> has the following parameters:<a href="#section-5.1.4.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4.5-8.1">
                <p id="section-5.1.4.5-8.1.1"><code>selection</code>: Search criteria that locates Evidence, corroborated Evidence, or Endorsements from the <code>condition</code> result.<a href="#section-5.1.4.5-8.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.4.5-8.2">
                <p id="section-5.1.4.5-8.2.1"><code>addition</code>: Additional Endorsements if the <code>selection</code> criteria are satisfied.<a href="#section-5.1.4.5-8.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.1.4.5-9">To process a <code>conditional-endorsement-series-record</code> the <code>conditions</code> are compared with existing Evidence, corroborated Evidence, and Endorsements.
If the search criteria are satisfied, the <code>series</code> tuples are processed.<a href="#section-5.1.4.5-9" class="pilcrow">¶</a></p>
<p id="section-5.1.4.5-10">The <code>series</code> array contains an ordered list of <code>conditional-series-record</code> entries.
Evaluation order begins at list position 0.<a href="#section-5.1.4.5-10" class="pilcrow">¶</a></p>
<p id="section-5.1.4.5-11">For each <code>series</code> entry, if the <code>selection</code> criteria matches an entry found in the <code>condition</code> result, the <code>series</code> <code>addition</code> is combined with the <code>environment-map</code> from the <code>condition</code> result to form a new Endorsement entry.
The new entry is added to the existing set of Endorsements.<a href="#section-5.1.4.5-11" class="pilcrow">¶</a></p>
<p id="section-5.1.4.5-12">The first <code>series</code> entry that successfully matches the <code>selection</code> criteria terminates <code>series</code> processing.<a href="#section-5.1.4.5-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-comid-triple-identity">
<section id="section-5.1.4.6">
            <h5 id="name-device-identity-triple">
<a href="#section-5.1.4.6" class="section-number selfRef">5.1.4.6. </a><a href="#name-device-identity-triple" class="section-name selfRef">Device Identity Triple</a>
            </h5>
<p id="section-5.1.4.6-1">Device Identity triples (see <code>identity-triples</code> in <a href="#sec-comid-triples" class="auto internal xref">Section 5.1.4</a>) endorse that the keys were securely provisioned to the named Target Environment.
A single Target Environment (as identified by <code>environment</code> and <code>mkey</code>) may contain one or more cryptographic keys.
The existence of these keys is asserted in Evidence, Reference Values, or Endorsements.<a href="#section-5.1.4.6-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.6-2">The device identity keys may have been used to authenticate the Attester device or may be held in reserve for later use.<a href="#section-5.1.4.6-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4.6-3">Device Identity triples instruct a Verifier to perform key validation checks, such as revocation, certificate path construction &amp; verification, or proof of possession.
The Verifier SHOULD verify keys contained in Device Identity triples.<a href="#section-5.1.4.6-3" class="pilcrow">¶</a></p>
<p id="section-5.1.4.6-4">Additional details about how a key was provisioned or is protected may be asserted using Endorsements such as <code>endorsed-triples</code>.<a href="#section-5.1.4.6-4" class="pilcrow">¶</a></p>
<p id="section-5.1.4.6-5">Depending on key formatting, as defined by <code>$crypto-key-type-choice</code>, the Verifier may take different steps to locate and verify the key.<a href="#section-5.1.4.6-5" class="pilcrow">¶</a></p>
<p id="section-5.1.4.6-6">If a key has usage restrictions that limit its use to device identity challenges, the Verifier SHOULD enforce key use restrictions.<a href="#section-5.1.4.6-6" class="pilcrow">¶</a></p>
<p id="section-5.1.4.6-7">Each successful verification of a key in <code>key-list</code> SHALL produce Endorsement Claims that are added to the Attester's Claim set.
Claims are asserted with the joint authority of the Endorser (CoRIM signer) and the Verifier.
The Verifier MAY report key verification results as part of an error reporting function.<a href="#section-5.1.4.6-7" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.6-8">
<pre>
identity-triple-record = [
  environment: environment-map
  key-list: [ + $crypto-key-type-choice ]
  ? conditions: non-empty&lt;{
    ? &amp;(mkey: 0) =&gt; $measured-element-type-choice,
    ? &amp;(authorized-by: 1) =&gt; [ + $crypto-key-type-choice ]
  }&gt;
]
</pre><a href="#section-5.1.4.6-8" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-5.1.4.6-9.1">
                <p id="section-5.1.4.6-9.1.1"><code>environment</code>: An <code>environment-map</code> condition used to identify the target Evidence or Reference Value.
See <a href="#sec-environments" class="auto internal xref">Section 5.1.4.1</a>.<a href="#section-5.1.4.6-9.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.4.6-9.2">
                <p id="section-5.1.4.6-9.2.1"><code>key-list</code>: A list of <code>$crypto-key-type-choice</code> keys that identifies which keys are to be verified.
See <a href="#sec-crypto-keys" class="auto internal xref">Section 5.1.4.1.5</a>.<a href="#section-5.1.4.6-9.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.4.6-9.3">
                <p id="section-5.1.4.6-9.3.1"><code>mkey</code>: An optional <code>$measured-element-type-choice</code> condition used to identify the element within the target Evidence or Reference Value.
See <a href="#sec-comid-mkey" class="auto internal xref">Section 5.1.4.1.4.1</a>.<a href="#section-5.1.4.6-9.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.4.6-9.4">
                <p id="section-5.1.4.6-9.4.1"><code>authorized-by</code>: An optional list of <code>$crypto-key-type-choice</code> keys that identifies the authorities that asserted the <code>key-list</code> in the target Evidence or Reference Values.<a href="#section-5.1.4.6-9.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="sec-comid-triple-attest-key">
<section id="section-5.1.4.7">
            <h5 id="name-attest-key-triple">
<a href="#section-5.1.4.7" class="section-number selfRef">5.1.4.7. </a><a href="#name-attest-key-triple" class="section-name selfRef">Attest Key Triple</a>
            </h5>
<p id="section-5.1.4.7-1">Attest Key triples (see <code>attest-key-triples</code> in <a href="#sec-comid-triples" class="auto internal xref">Section 5.1.4</a>) endorse that the keys were securely provisioned to the named Attesting Environment.
An Attesting Environment (as identified by <code>environment</code> and <code>mkey</code>) may contain one or more cryptographic keys.
The existence of these keys is asserted in Evidence, Reference Values, or Endorsements.<a href="#section-5.1.4.7-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.7-2">The attestation keys may have been used to sign Evidence or may be held in reserve for later use.<a href="#section-5.1.4.7-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4.7-3">Attest Key triples instruct a Verifier to perform key validation checks, such as revocation, certification path construction and validation, or proof of possession.
The Verifier SHOULD verify keys contained in Attest Key triples.<a href="#section-5.1.4.7-3" class="pilcrow">¶</a></p>
<p id="section-5.1.4.7-4">Additional details about how a key was provisioned or is protected may be asserted using Endorsements such as <code>endorsed-triples</code>.<a href="#section-5.1.4.7-4" class="pilcrow">¶</a></p>
<p id="section-5.1.4.7-5">Depending on key formatting, as defined by <code>$crypto-key-type-choice</code>, the Verifier may take different steps to locate and verify the key.
If a key has usage restrictions that limits its use to Evidence signing (e.g., see Section 5.1.5.3 in <span>[<a href="#DICE.cert" class="cite xref">DICE.cert</a>]</span>).
The Verifier SHOULD enforce key use restrictions.<a href="#section-5.1.4.7-5" class="pilcrow">¶</a></p>
<p id="section-5.1.4.7-6">Each successful verification of a key in <code>key-list</code> SHALL produce Endorsement Claims that are added to the Attester's Claim set.
Claims are asserted with the joint authority of the Endorser (CoRIM signer) and the Verifier.
The Verifier MAY report key verification results as part of an error reporting function.<a href="#section-5.1.4.7-6" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.7-7">
<pre>
attest-key-triple-record = [
  environment: environment-map
  key-list: [ + $crypto-key-type-choice ]
  ? conditions: non-empty&lt; {
    ? &amp;(mkey: 0) =&gt; $measured-element-type-choice,
    ? &amp;(authorized-by: 1) =&gt; [ + $crypto-key-type-choice ]
  }&gt;
]
</pre><a href="#section-5.1.4.7-7" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.7-8">See <a href="#sec-comid-triple-identity" class="auto internal xref">Section 5.1.4.6</a> for additional details.<a href="#section-5.1.4.7-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-comid-domains">
<section id="section-5.1.4.8">
            <h5 id="name-triples-for-domain-definiti">
<a href="#section-5.1.4.8" class="section-number selfRef">5.1.4.8. </a><a href="#name-triples-for-domain-definiti" class="section-name selfRef">Triples for domain definitions</a>
            </h5>
<p id="section-5.1.4.8-1">A domain is a hierarchical description of a Composite Attester in terms of its constituent Environments and their compositional relationships.<a href="#section-5.1.4.8-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.8-2">The following CDDL describes domain type.<a href="#section-5.1.4.8-2" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.8-3">
<pre>
domain-type = environment-map
</pre><a href="#section-5.1.4.8-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.4.8-4">Domain structure is defined with the following types of triples.<a href="#section-5.1.4.8-4" class="pilcrow">¶</a></p>
<div id="sec-comid-triple-domain-membership">
<section id="section-5.1.4.8.1">
              <h6 id="name-domain-membership-triple">
<a href="#section-5.1.4.8.1" class="section-number selfRef">5.1.4.8.1. </a><a href="#name-domain-membership-triple" class="section-name selfRef">Domain Membership Triple</a>
              </h6>
<p id="section-5.1.4.8.1-1">A Domain Membership Triple (DMT) links a domain identifier to its member Environments.
The triple's subject is the domain identifier while the triple’s object lists all the member Environments within the domain.<a href="#section-5.1.4.8.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4.8.1-2">The Domain Membership Triple allows an Endorser (for example, an Integrator) to issue an authoritative statement about the composition of an Attester as a collection of Environments.
This allows a topological description of an Attester to be expressed by linking a parent Environment (e.g., a lead Attester) to its child Environments (e.g., one or more sub-Attesters).<a href="#section-5.1.4.8.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4.8.1-3">If the Verifier Appraisal policy requires Domain Membership, the Domain Membership Triple is used to match an Attester's reference composition with the actual composition represented in Evidence.<a href="#section-5.1.4.8.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.4.8.1-4">Representing members of a DMT as domains enables the recursive construction of an entity's topology, such as a Composite Device (see <span><a href="https://rfc-editor.org/rfc/rfc9334#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>), where multiple lower-level domains can be aggregated into a higher-level domain.<a href="#section-5.1.4.8.1-4" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.8.1-5">
<pre>
domain-membership-triple-record = [
  domain-id: domain-type
  members: [ +  domain-type ]
]
</pre><a href="#section-5.1.4.8.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-comid-triple-domain-dependency">
<section id="section-5.1.4.8.2">
              <h6 id="name-domain-dependency-triple">
<a href="#section-5.1.4.8.2" class="section-number selfRef">5.1.4.8.2. </a><a href="#name-domain-dependency-triple" class="section-name selfRef">Domain Dependency Triple</a>
              </h6>
<p id="section-5.1.4.8.2-1">A Domain Dependency triple defines trust dependencies between measurement sources.
The subject identifies a domain (<a href="#sec-comid-triple-domain-membership" class="auto internal xref">Section 5.1.4.8.1</a>) that has a predicate relationship to the object containing one or more dependent domains.
Dependency means the subject domain’s trustworthiness properties rely on the object domain(s) trustworthiness having been established before the trustworthiness properties of the subject domain exist.<a href="#section-5.1.4.8.2-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.8.2-2">
<pre>
domain-dependency-triple-record = [
  domain-type
  [ + domain-type ]
]
</pre><a href="#section-5.1.4.8.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec-comid-triple-coswid">
<section id="section-5.1.4.9">
            <h5 id="name-comid-coswid-linking-triple">
<a href="#section-5.1.4.9" class="section-number selfRef">5.1.4.9. </a><a href="#name-comid-coswid-linking-triple" class="section-name selfRef">CoMID-CoSWID Linking Triple</a>
            </h5>
<p id="section-5.1.4.9-1">A CoSWID triple relates reference measurements contained in one or more CoSWIDs
to a Target Environment. The subject identifies a Target Environment, the
object one or more unique tag identifiers of existing CoSWIDs, and the
predicate asserts that these contain the expected (i.e., reference)
measurements for the Target Environment.<a href="#section-5.1.4.9-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1.4.9-2">
<pre>
coswid-triple-record = [
  environment-map
  [ + concise-swid-tag-id ]
]

concise-swid-tag-id = text / bstr .size 16
</pre><a href="#section-5.1.4.9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-extensibility">
<section id="section-5.2">
        <h3 id="name-extensibility">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-extensibility" class="section-name selfRef">Extensibility</a>
        </h3>
<p id="section-5.2-1">The base CoRIM document definition is described using CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> that can be extended only at specific allowed points known as "extension points".<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The following types of extensions are supported in CoRIM.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<div id="map-extensions">
<section id="section-5.2.1">
          <h4 id="name-map-extensions">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-map-extensions" class="section-name selfRef">Map Extensions</a>
          </h4>
<p id="section-5.2.1-1">Map extensions provide extensibility support to CoRIM map structures.
CDDL map extensibility enables a CoRIM profile to extend the base CoRIM CDDL definition.
CDDL map extension points have the form <code>($$NAME-extension)</code> where "NAME" is the name of the map and '$$' signifies map extensibility.
Typically, map extension requires a convention for code point naming that avoids code-point reuse.
Well-known code points may be in a registry, such as CoSWID <span>[<a href="#IANA.coswid" class="cite xref">IANA.coswid</a>]</span>.
Non-negative integers are reserved for IANA to assign meaning globally.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-type-extensions">
<section id="section-5.2.2">
          <h4 id="name-data-type-extensions">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-data-type-extensions" class="section-name selfRef">Data Type Extensions</a>
          </h4>
<p id="section-5.2.2-1">Data type extensibility has the form <code>($NAME-type-choice)</code> where "NAME" is the type name and '$' signifies type extensibility.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">New data type extensions SHOULD be documented to facilitate interoperability.
CoRIM profiles are best used to document vendor or industry defined extensions.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-cotl">
<section id="section-6">
      <h2 id="name-cotl">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-cotl" class="section-name selfRef">CoTL</a>
      </h2>
<p id="section-6-1">A Concise Tag List (CoTL) object represents the signal for the
Verifier to activate the listed tags. Verifier policy determines whether CoTLs are required.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">When CoTLs are required, each tag MUST be activated by a CoTL before being processed.
All the tags listed in the CoTL MUST be activated atomically. If any tag activated by a CoTL is not available to the Verifier, the entire CoTL is rejected.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The number of CoTLs required in a given supply chain ecosystem is dependent on
Verifier Owner's Appraisal Policy for Evidence. Corresponding policies are often driven by the complexity and nature of the use case.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">If a Verifier Owner has a policy that does not require CoTL, tags within a CoRIM received by a Verifier
are activated immediately and treated valid for appraisal.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">There may be cases when Verifier receives CoRIMs from multiple
Reference Value providers and Endorsers. In such cases, a supplier (or other authorities, such as integrators)
may be designated to issue a single CoTL to activate all the tags submitted to the Verifier
in these CoRIMs.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">In a more complex case, there may be multiple authorities that issue CoTLs at different points in time.
An Appraisal Policy for Evidence may dictate how multiple CoTLs are to be processed within the Verifier.<a href="#section-6-6" class="pilcrow">¶</a></p>
<div id="structure-1">
<section id="section-6.1">
        <h3 id="name-structure-2">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-structure-2" class="section-name selfRef">Structure</a>
        </h3>
<p id="section-6.1-1">The CDDL specification for the <code>concise-tl-tag</code> map and additional grammatical requirements specified in the text of this Section MUST be followed when creating or validating a CoTL tag are given below:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-6.1-2">
<pre>
concise-tl-tag = {
  &amp;(tag-identity: 0) =&gt; tag-identity-map
  &amp;(tags-list: 1) =&gt; [ + tag-identity-map ],
  &amp;(tl-validity: 2) =&gt; validity-map
}
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1-3">The following describes each member of the <code>concise-tl-tag</code> map.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.1">
            <p id="section-6.1-4.1.1"><code>tag-identity</code> (index 0): A <code>tag-identity-map</code> containing unique
identification information for the CoTL.
Described in <a href="#sec-comid-tag-id" class="auto internal xref">Section 5.1.1</a>.<a href="#section-6.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.2">
            <p id="section-6.1-4.2.1"><code>tags-list</code> (index 1): One or more <code>tag-identity-maps</code> identifying
the CoMID and CoSWID tags that constitute the list, i.e.,
a complete set of verification-related information.  The <code>tags-list</code> behaves
like a signaling mechanism from the supply chain (e.g., a product vendor) to
a Verifier that activates the tags in <code>tags-list</code> for use in the Evidence
appraisal process, and the activation is atomic. All tags listed in <code>tags-list</code>
MUST be activated or no tags are activated.<a href="#section-6.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.3">
            <p id="section-6.1-4.3.1"><code>tl-validity</code> (index 2): Specifies the validity period of the CoTL.
Described in <a href="#sec-common-validity" class="auto internal xref">Section 7.3</a>.<a href="#section-6.1-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-common-types">
<section id="section-7">
      <h2 id="name-common-types">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-common-types" class="section-name selfRef">Common Types</a>
      </h2>
<p id="section-7-1">The following CDDL types may be shared by CoRIM, CoMID, and CoTL.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="sec-non-empty">
<section id="section-7.1">
        <h3 id="name-non-empty">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-non-empty" class="section-name selfRef">Non-Empty</a>
        </h3>
<p id="section-7.1-1">The <code>non-empty</code> generic type is used to express that a map with only optional
members MUST at least include one of the members.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-7.1-2">
<pre>
non-empty&lt;M&gt; = (M) .and ({ + any =&gt; any })
</pre><a href="#section-7.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-common-entity">
<section id="section-7.2">
        <h3 id="name-entity">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-entity" class="section-name selfRef">Entity</a>
        </h3>
<p id="section-7.2-1">The <code>entity-map</code> is a generic type describing an organization responsible for
the contents of a manifest. It is instantiated by supplying two parameters:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">
            <p id="section-7.2-2.1.1">A <code>role-type-choice</code>, i.e., a selection of roles that entities of the
instantiated type can claim<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.2">
            <p id="section-7.2-2.2.1">An <code>extension-socket</code>, i.e., a CDDL socket that can be used to extend
the attributes associated with entities of the instantiated type<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="lang-cddl sourcecode" id="section-7.2-3">
<pre>
entity-map&lt;role-type-choice, extension-socket&gt; = {
  &amp;(entity-name: 0) =&gt; $entity-name-type-choice
  ? &amp;(reg-id: 1) =&gt; uri
  &amp;(role: 2) =&gt; [ + role-type-choice ]
  * extension-socket
}

$entity-name-type-choice /= text
</pre><a href="#section-7.2-3" class="pilcrow">¶</a>
</div>
<p id="section-7.2-4">The following describes each member of the <code>entity-map</code>.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-5.1">
            <p id="section-7.2-5.1.1"><code>entity-name</code> (index 0): The name of entity which is responsible for the action(s) as defined by the role.
<code>$entity-name-type-choice</code> can only be text.
Other specifications can extend the <code>$entity-name-type-choice</code>.
See <a href="#sec-iana-comid" class="auto internal xref">Section 12.6</a>.<a href="#section-7.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-5.2">
            <p id="section-7.2-5.2.1"><code>reg-id</code> (index 1): A URI associated with the organization that owns the entity name.<a href="#section-7.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-5.3">
            <p id="section-7.2-5.3.1"><code>role</code> (index 2): A type choice defining the roles that the entity is claiming.
The role is supplied as a parameter at the time the <code>entity-map</code> generic is instantiated.<a href="#section-7.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-5.4">
            <p id="section-7.2-5.4.1"><code>extension-socket</code>: A CDDL socket used to add new information structures to the <code>entity-map</code>.<a href="#section-7.2-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-6">Examples of how the <code>entity-map</code> generic is instantiated can be found in
(<a href="#sec-corim-entity" class="auto internal xref">Section 4.1.5</a>) and (<a href="#sec-comid-entity" class="auto internal xref">Section 5.1.2</a>).<a href="#section-7.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-common-validity">
<section id="section-7.3">
        <h3 id="name-validity">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-validity" class="section-name selfRef">Validity</a>
        </h3>
<p id="section-7.3-1">A <code>validity-map</code> represents the time interval during which the signer
warrants that it will maintain information about the status of the signed
object (e.g., a manifest).<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">In a <code>validity-map</code>, both ends of the interval are encoded as epoch-based
date/time as per <span><a href="https://rfc-editor.org/rfc/rfc8949#section-3.4.2" class="relref">Section 3.4.2</a> of [<a href="#STD94" class="cite xref">STD94</a>]</span>.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-7.3-3">
<pre>
validity-map = {
  ? &amp;(not-before: 0) =&gt; time
  &amp;(not-after: 1) =&gt; time
}
</pre><a href="#section-7.3-3" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-7.3-4.1">
            <p id="section-7.3-4.1.1"><code>not-before</code> (index 0): the date on which the signed manifest validity period
begins<a href="#section-7.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-4.2">
            <p id="section-7.3-4.2.1"><code>not-after</code> (index 1): the date on which the signed manifest validity period
ends<a href="#section-7.3-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-common-uuid">
<section id="section-7.4">
        <h3 id="name-uuid">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-uuid" class="section-name selfRef">UUID</a>
        </h3>
<p id="section-7.4-1">Used to tag a byte string as a binary UUID.
Defined in <span><a href="https://rfc-editor.org/rfc/rfc9562#section-4" class="relref">Section 4</a> of [<a href="#RFC9562" class="cite xref">RFC9562</a>]</span>.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-7.4-2">
<pre>
uuid-type = bytes .size 16
tagged-uuid-type = #6.37(uuid-type)
</pre><a href="#section-7.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-common-ueid">
<section id="section-7.5">
        <h3 id="name-ueid">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-ueid" class="section-name selfRef">UEID</a>
        </h3>
<p id="section-7.5-1">Used to tag a byte string as Universal Entity ID Claim (UEID).
Defined in <span><a href="https://rfc-editor.org/rfc/rfc9711#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-7.5-2">
<pre>
ueid-type = bytes .size (7..33)
tagged-ueid-type = #6.550(ueid-type)
</pre><a href="#section-7.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-common-oid">
<section id="section-7.6">
        <h3 id="name-oid">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-oid" class="section-name selfRef">OID</a>
        </h3>
<p id="section-7.6-1">Used to tag a byte string as the BER encoding <span>[<a href="#X.690" class="cite xref">X.690</a>]</span> of an absolute object
identifier <span>[<a href="#RFC9090" class="cite xref">RFC9090</a>]</span>.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-7.6-2">
<pre>
oid-type = bytes
tagged-oid-type = #6.111(oid-type)
</pre><a href="#section-7.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-common-hash-entry">
<section id="section-7.7">
        <h3 id="name-digest">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-digest" class="section-name selfRef">Digest</a>
        </h3>
<p id="section-7.7-1">A digest represents the value of a hashing operation together with the hash algorithm used.
The type of the digest algorithm identifier can be either <code>int</code> or <code>text</code> and is interpreted according to the <span>[<a href="#IANA.named-information" class="cite xref">IANA.named-information</a>]</span> registry.
Specifically, <code>int</code> values are matched against "ID" entries, <code>text</code> values are matched against "Hash Name String" entries.
Whenever possible, using the <code>int</code> encoding is RECOMMENDED.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-7.7-2">
<pre>
digest = [
  alg: (int / text),
  val: bytes
]

digests-type = [ + digest ]
</pre><a href="#section-7.7-2" class="pilcrow">¶</a>
</div>
<p id="section-7.7-3">A measurement can be obtained using different hash algorithms.
A <code>digests-type</code> can be used to collect multiple digest values obtained by applying different hash algorithms on the same input.
Each entry in the <code>digests-type</code> MUST have a unique <code>alg</code> value.<a href="#section-7.7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-common-tagged-bytes">
<section id="section-7.8">
        <h3 id="name-tagged-bytes-type">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-tagged-bytes-type" class="section-name selfRef">Tagged Bytes Type</a>
        </h3>
<p id="section-7.8-1">An opaque, variable-length byte string.
It can be used in different contexts: as an instance, class or group identifier in an <code>environment-map</code>; as a raw value measurement in a <code>measurement-values-map</code>.
Its semantics are defined by the context in which it is found, and by the overarching CoRIM profile.
When used as an identifier the responsible allocator entity SHOULD ensure uniqueness within the context that it is used.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-7.8-2">
<pre>
tagged-bytes = #6.560(bytes)
</pre><a href="#section-7.8-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec-appr-corim-inputs">
<section id="section-8">
      <h2 id="name-appraisal-of-corim-based-in">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-appraisal-of-corim-based-in" class="section-name selfRef">Appraisal of CoRIM-based Inputs</a>
      </h2>
<p id="section-8-1">Inputs to a Verifier are mapped from their external representation to an internal representation.
CoRIM defines CBOR structures and content media types for Conceptual Messages that include Endorsements and Reference Values.
CoRIM data structures may also be used by Evidence and Attestation Results that wish to describe overlapping structure.
CoRIM-based data structures define an external representation of Conceptual Messages that are mapped to an internal representation.
Appraisal processing describes both mapping transformations and Verifier reconciliation (<a href="#sec-verifier-rec" class="auto internal xref">Section 2</a>).
Non-CoRIM-based data structures require mapping transformation, but these are out of scope for this document.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">If a CoRIM profile is specified, there are a few well-defined points in the procedure where Verifier behaviour depends on the profile.
The CoRIM profile MUST provide a description of the expected Verifier behavior for each of those well-defined points.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Verifier implementations MUST provide the specified information model of the ACS at the end of phase 4 as described in this specification.
They are not required to use the same internal representation or evaluation order described by this specification.<a href="#section-8-3" class="pilcrow">¶</a></p>
<div id="sec-appraisal-procedure">
<section id="section-8.1">
        <h3 id="name-appraisal-procedure">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-appraisal-procedure" class="section-name selfRef">Appraisal Procedure</a>
        </h3>
<p id="section-8.1-1">The appraisal procedure is divided into several logical phases for clarity.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.1">
            <p id="section-8.1-2.1.1"><strong>Phase 1</strong>: Input Validation and Transformation<a href="#section-8.1-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-3">During Phase 1, all available Conceptual Messages are processed for validation.
This involves checking digital signatures to verify their integrity and authenticity, ensuring they are not outdated, and confirming their relevance to the current appraisal.
If validation fails, the input Conceptual Message is discarded.
If validation succeeds, the input Conceptual Message is transformed from its external representation into an internal one.
These internal representations are then collected in an implementation-specific "staging area", which acts as a database for subsequent appraisal processing.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-4.1">
            <p id="section-8.1-4.1.1"><strong>Phase 2</strong>: Evidence Augmentation<a href="#section-8.1-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-5">During Phase 2, Evidence inputs are added to a list that describes the Attester's actual state.
These inputs are added with the Attester's authority.<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-6.1">
            <p id="section-8.1-6.1.1"><strong>Phase 3</strong>: Reference Values Corroboration and Augmentation<a href="#section-8.1-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-7">During Phase 3, Reference Values inputs are compared with Evidence inputs.
Reference Values inputs describe possible states of Attesters.
If the actual state of the Attester is described by the possible Attester states, then the overlapping (corroborated) actual states are added to the Attester's actual state.
These inputs are added with the Reference Value Provider's authority.<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-8.1">
            <p id="section-8.1-8.1.1"><strong>Phase 4</strong>: Endorsed Values Augmentation<a href="#section-8.1-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-9">During Phase 4, Endorsed Values inputs containing conditions that describe expected Attester state are processed.
If the comparison is satisfied, then additional Claims about the Attester are added to the ACS.
These inputs are added with the Endorser's authority.<a href="#section-8.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-10.1">
            <p id="section-8.1-10.1.1"><strong>Phase 5</strong>: Verifier Augmentation<a href="#section-8.1-10.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-11">During Phase 5, the Verifier may perform consistency, integrity, or additional validity checks.<a href="#section-8.1-11" class="pilcrow">¶</a></p>
<p id="section-8.1-12">These checks may result in additional Claims about the Attester that are added to the ACS.
These Claims are added with the Verifier's authority.<a href="#section-8.1-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-13.1">
            <p id="section-8.1-13.1.1"><strong>Phase 6</strong>: Policy Augmentation<a href="#section-8.1-13.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-14">During Phase 6, appraisal policies are processed that describe Attester states that are desirable or undesirable.
If these conditions exist, the policy may add additional Claims about the Attester, to the ACS.
These Claims are added with the policy author's authority.<a href="#section-8.1-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-15.1">
            <p id="section-8.1-15.1.1"><strong>Phase 7</strong>: Attestation Results Production and Transformation<a href="#section-8.1-15.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-16">During Phase 7, the outcome of Appraisal and the set of Attester Claims that are interesting to a Relying Party are copied from the Attester state to an output staging area.
The Claims in the output staging area and other Verifier related metadata are transformed into an external representation suitable for consumption by a Relying Party.<a href="#section-8.1-16" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-verifier-abstraction">
<section id="section-9">
      <h2 id="name-reference-verifier-algorith">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-reference-verifier-algorith" class="section-name selfRef">Reference Verifier Algorithm</a>
      </h2>
<p id="section-9-1">This document presumes that Verifier implementations will differ.
To facilitate the description of normative Verifier behavior, this document describes the internal representation for a reference Verifier and demonstrates how the data is used in the appraisal phases outlined in <a href="#sec-appraisal-procedure" class="auto internal xref">Section 8.1</a>.
If the Verifier operates on CoRIM documents, it is RECOMMENDED that it follows this algorithm.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The terms
Claim,
Environment-Claim Tuple (ECT),
Authority,
Appraisal Claims Set (ACS),
Appraisal Policy, and
Attestation Results Set (ARS)
are used with the meaning defined in <a href="#sec-glossary" class="auto internal xref">Section 1.1.1</a>.<a href="#section-9-2" class="pilcrow">¶</a></p>
<span id="name-corim-verifier-flow"></span><div id="fig-verifier-internal">
<figure id="figure-1">
        <div id="section-9-3.1">
          <div class="alignCenter art-svg artwork" id="section-9-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="736" width="504" viewBox="0 0 504 736" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,240 L 8,272" fill="none" stroke="black"></path>
              <path d="M 8,336 L 8,368" fill="none" stroke="black"></path>
              <path d="M 72,272 L 72,312" fill="none" stroke="black"></path>
              <path d="M 72,384 L 72,400" fill="none" stroke="black"></path>
              <path d="M 144,240 L 144,272" fill="none" stroke="black"></path>
              <path d="M 144,336 L 144,368" fill="none" stroke="black"></path>
              <path d="M 184,144 L 184,408" fill="none" stroke="black"></path>
              <path d="M 184,424 L 184,544" fill="none" stroke="black"></path>
              <path d="M 208,384 L 208,528" fill="none" stroke="black"></path>
              <path d="M 224,400 L 224,432" fill="none" stroke="black"></path>
              <path d="M 224,464 L 224,496" fill="none" stroke="black"></path>
              <path d="M 248,528 L 248,584" fill="none" stroke="black"></path>
              <path d="M 272,400 L 272,432" fill="none" stroke="black"></path>
              <path d="M 272,464 L 272,496" fill="none" stroke="black"></path>
              <path d="M 288,384 L 288,528" fill="none" stroke="black"></path>
              <path d="M 296,272 L 296,352" fill="none" stroke="black"></path>
              <path d="M 304,64 L 304,96" fill="none" stroke="black"></path>
              <path d="M 312,176 L 312,208" fill="none" stroke="black"></path>
              <path d="M 312,304 L 312,336" fill="none" stroke="black"></path>
              <path d="M 320,48 L 320,64" fill="none" stroke="black"></path>
              <path d="M 336,32 L 336,48" fill="none" stroke="black"></path>
              <path d="M 336,416 L 336,480" fill="none" stroke="black"></path>
              <path d="M 360,304 L 360,336" fill="none" stroke="black"></path>
              <path d="M 384,96 L 384,152" fill="none" stroke="black"></path>
              <path d="M 384,224 L 384,264" fill="none" stroke="black"></path>
              <path d="M 384,352 L 384,392" fill="none" stroke="black"></path>
              <path d="M 408,304 L 408,336" fill="none" stroke="black"></path>
              <path d="M 432,416 L 432,480" fill="none" stroke="black"></path>
              <path d="M 440,672 L 440,704" fill="none" stroke="black"></path>
              <path d="M 448,176 L 448,208" fill="none" stroke="black"></path>
              <path d="M 456,304 L 456,336" fill="none" stroke="black"></path>
              <path d="M 464,64 L 464,96" fill="none" stroke="black"></path>
              <path d="M 472,272 L 472,352" fill="none" stroke="black"></path>
              <path d="M 480,48 L 480,80" fill="none" stroke="black"></path>
              <path d="M 496,32 L 496,64" fill="none" stroke="black"></path>
              <path d="M 496,144 L 496,544" fill="none" stroke="black"></path>
              <path d="M 496,672 L 496,704" fill="none" stroke="black"></path>
              <path d="M 336,32 L 496,32" fill="none" stroke="black"></path>
              <path d="M 320,48 L 480,48" fill="none" stroke="black"></path>
              <path d="M 304,64 L 464,64" fill="none" stroke="black"></path>
              <path d="M 480,64 L 496,64" fill="none" stroke="black"></path>
              <path d="M 464,80 L 480,80" fill="none" stroke="black"></path>
              <path d="M 304,96 L 464,96" fill="none" stroke="black"></path>
              <path d="M 200,128 L 376,128" fill="none" stroke="black"></path>
              <path d="M 392,128 L 480,128" fill="none" stroke="black"></path>
              <path d="M 328,160 L 432,160" fill="none" stroke="black"></path>
              <path d="M 328,224 L 432,224" fill="none" stroke="black"></path>
              <path d="M 8,240 L 144,240" fill="none" stroke="black"></path>
              <path d="M 8,272 L 144,272" fill="none" stroke="black"></path>
              <path d="M 296,272 L 472,272" fill="none" stroke="black"></path>
              <path d="M 312,304 L 360,304" fill="none" stroke="black"></path>
              <path d="M 408,304 L 456,304" fill="none" stroke="black"></path>
              <path d="M 24,320 L 128,320" fill="none" stroke="black"></path>
              <path d="M 312,336 L 360,336" fill="none" stroke="black"></path>
              <path d="M 408,336 L 456,336" fill="none" stroke="black"></path>
              <path d="M 296,352 L 472,352" fill="none" stroke="black"></path>
              <path d="M 24,384 L 128,384" fill="none" stroke="black"></path>
              <path d="M 208,384 L 288,384" fill="none" stroke="black"></path>
              <path d="M 224,400 L 272,400" fill="none" stroke="black"></path>
              <path d="M 352,400 L 416,400" fill="none" stroke="black"></path>
              <path d="M 88,416 L 200,416" fill="none" stroke="black"></path>
              <path d="M 288,416 L 328,416" fill="none" stroke="black"></path>
              <path d="M 224,432 L 272,432" fill="none" stroke="black"></path>
              <path d="M 224,464 L 272,464" fill="none" stroke="black"></path>
              <path d="M 296,480 L 336,480" fill="none" stroke="black"></path>
              <path d="M 224,496 L 272,496" fill="none" stroke="black"></path>
              <path d="M 352,496 L 416,496" fill="none" stroke="black"></path>
              <path d="M 208,528 L 288,528" fill="none" stroke="black"></path>
              <path d="M 200,560 L 240,560" fill="none" stroke="black"></path>
              <path d="M 256,560 L 480,560" fill="none" stroke="black"></path>
              <path d="M 184,592 L 312,592" fill="none" stroke="black"></path>
              <path d="M 184,624 L 312,624" fill="none" stroke="black"></path>
              <path d="M 352,672 L 400,672" fill="none" stroke="black"></path>
              <path d="M 440,672 L 496,672" fill="none" stroke="black"></path>
              <path d="M 352,704 L 400,704" fill="none" stroke="black"></path>
              <path d="M 440,704 L 496,704" fill="none" stroke="black"></path>
              <path d="M 200,128 C 191.16936,128 184,135.16936 184,144" fill="none" stroke="black"></path>
              <path d="M 480,128 C 488.83064,128 496,135.16936 496,144" fill="none" stroke="black"></path>
              <path d="M 328,160 C 319.16936,160 312,167.16936 312,176" fill="none" stroke="black"></path>
              <path d="M 432,160 C 440.83064,160 448,167.16936 448,176" fill="none" stroke="black"></path>
              <path d="M 328,224 C 319.16936,224 312,216.83064 312,208" fill="none" stroke="black"></path>
              <path d="M 432,224 C 440.83064,224 448,216.83064 448,208" fill="none" stroke="black"></path>
              <path d="M 24,320 C 15.16936,320 8,327.16936 8,336" fill="none" stroke="black"></path>
              <path d="M 128,320 C 136.83064,320 144,327.16936 144,336" fill="none" stroke="black"></path>
              <path d="M 24,384 C 15.16936,384 8,376.83064 8,368" fill="none" stroke="black"></path>
              <path d="M 128,384 C 136.83064,384 144,376.83064 144,368" fill="none" stroke="black"></path>
              <path d="M 352,400 C 343.16936,400 336,407.16936 336,416" fill="none" stroke="black"></path>
              <path d="M 416,400 C 424.83064,400 432,407.16936 432,416" fill="none" stroke="black"></path>
              <path d="M 88,416 C 79.16936,416 72,408.83064 72,400" fill="none" stroke="black"></path>
              <path d="M 352,496 C 343.16936,496 336,488.83064 336,480" fill="none" stroke="black"></path>
              <path d="M 416,496 C 424.83064,496 432,488.83064 432,480" fill="none" stroke="black"></path>
              <path d="M 200,560 C 191.16936,560 184,552.83064 184,544" fill="none" stroke="black"></path>
              <path d="M 480,560 C 488.83064,560 496,552.83064 496,544" fill="none" stroke="black"></path>
              <path d="M 184,592 C 175.16936,592 168,599.16936 168,608" fill="none" stroke="black"></path>
              <path d="M 312,592 C 320.83064,592 328,599.16936 328,608" fill="none" stroke="black"></path>
              <path d="M 184,624 C 175.16936,624 168,616.83064 168,608" fill="none" stroke="black"></path>
              <path d="M 312,624 C 320.83064,624 328,616.83064 328,608" fill="none" stroke="black"></path>
              <path d="M 352,672 C 343.16936,672 336,679.16936 336,688" fill="none" stroke="black"></path>
              <path d="M 400,672 C 408.83064,672 416,679.16936 416,688" fill="none" stroke="black"></path>
              <path d="M 352,704 C 343.16936,704 336,696.83064 336,688" fill="none" stroke="black"></path>
              <path d="M 400,704 C 408.83064,704 416,696.83064 416,688" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="392,392 380,386.4 380,397.6" fill="black" transform="rotate(90,384,392)"></polygon>
              <polygon class="arrowhead" points="392,264 380,258.4 380,269.6" fill="black" transform="rotate(90,384,264)"></polygon>
              <polygon class="arrowhead" points="392,152 380,146.4 380,157.6" fill="black" transform="rotate(90,384,152)"></polygon>
              <polygon class="arrowhead" points="336,416 324,410.4 324,421.6" fill="black" transform="rotate(0,328,416)"></polygon>
              <polygon class="arrowhead" points="304,480 292,474.4 292,485.6" fill="black" transform="rotate(180,296,480)"></polygon>
              <polygon class="arrowhead" points="256,584 244,578.4 244,589.6" fill="black" transform="rotate(90,248,584)"></polygon>
              <polygon class="arrowhead" points="208,416 196,410.4 196,421.6" fill="black" transform="rotate(0,200,416)"></polygon>
              <polygon class="arrowhead" points="80,312 68,306.4 68,317.6" fill="black" transform="rotate(90,72,312)"></polygon>
              <g class="text">
                <text x="352" y="84">CoRIM</text>
                <text x="408" y="84">file(s)</text>
                <text x="216" y="148">CoRIM</text>
                <text x="280" y="148">Processor</text>
                <text x="364" y="180">Validation</text>
                <text x="416" y="180">&amp;</text>
                <text x="356" y="196">Internal</text>
                <text x="416" y="196">Repr.</text>
                <text x="380" y="212">Transformation</text>
                <text x="76" y="260">Evidence</text>
                <text x="360" y="292">Staging</text>
                <text x="412" y="292">Area</text>
                <text x="336" y="324">ECT</text>
                <text x="384" y="324">...</text>
                <text x="432" y="324">ECT</text>
                <text x="60" y="340">Validation</text>
                <text x="112" y="340">&amp;</text>
                <text x="52" y="356">Internal</text>
                <text x="112" y="356">Repr.</text>
                <text x="76" y="372">Transformation</text>
                <text x="248" y="420">ECT</text>
                <text x="360" y="436">ACS</text>
                <text x="248" y="452">...</text>
                <text x="384" y="452">Condition</text>
                <text x="380" y="468">Matching</text>
                <text x="248" y="484">ECT</text>
                <text x="248" y="516">ACS</text>
                <text x="220" y="612">Subsequent</text>
                <text x="292" y="612">Phases</text>
                <text x="44" y="676">Legenda:</text>
                <text x="40" y="692">ACS</text>
                <text x="64" y="692">=</text>
                <text x="112" y="692">Appraisal</text>
                <text x="180" y="692">Claims</text>
                <text x="224" y="692">Set</text>
                <text x="376" y="692">Process</text>
                <text x="468" y="692">Data</text>
                <text x="40" y="708">ECT</text>
                <text x="64" y="708">=</text>
                <text x="148" y="708">Environment-Claims</text>
                <text x="248" y="708">Tuple</text>
              </g>
            </svg><a href="#section-9-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-corim-verifier-flow" class="selfRef">CoRIM Verifier Flow</a>
        </figcaption></figure>
</div>
<div id="sec-ir-cm">
<section id="section-9.1">
        <h3 id="name-internal-representation-of-">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-internal-representation-of-" class="section-name selfRef">Internal Representation of Conceptual Messages</a>
        </h3>
<p id="section-9.1-1">Conceptual Messages are Verifier input and output values such as Evidence, Reference Values, Endorsed Values, Appraisal Policy, and Attestation Results.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">The internal representation of Conceptual Messages, as well as the ACS (<a href="#sec-ir-acs" class="auto internal xref">Section 9.1.9</a>) and ARS (<a href="#sec-ir-ars" class="auto internal xref">Section 9.1.10</a>), are constructed from a common building block structure called Environment-Claims Tuple (ECT).<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<div id="sec-ir-ect">
<section id="section-9.1.1">
          <h4 id="name-internal-structure-of-ect">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-internal-structure-of-ect" class="section-name selfRef">Internal structure of ECT</a>
          </h4>
<p id="section-9.1.1-1">Environment-Claims Tuples (ECT) have six attributes:<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-9.1.1-2">
<dt>1.</dt>
<dd id="section-9.1.1-2.1">
              <p id="section-9.1.1-2.1.1">Environment : Identifies the Target Environment. Environments are identified using instance, class, or group identifiers. Environments may be composed of elements, each having an element identifier (<code>mkey</code>).
If the Conceptual Message Type is <code>domain-member</code>, this field contains the domain identifier (<code>domain-id</code>) of the domain triple.<a href="#section-9.1.1-2.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>2.</dt>
<dd id="section-9.1.1-2.2">
              <p id="section-9.1.1-2.2.1">Elements : Identifies the set of elements contained within a Target Environment and their trustworthiness Claims.<a href="#section-9.1.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>3.</dt>
<dd id="section-9.1.1-2.3">
              <p id="section-9.1.1-2.3.1">Authority : Identifies the entity that issued the tuple. A certain type of key material by which the authority (and corresponding provenance) of the tuple can be determined, such as the public key of an asymmetric key pair that is associated with an authority's PKIX certificate.<a href="#section-9.1.1-2.3.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>4.</dt>
<dd id="section-9.1.1-2.4">
              <p id="section-9.1.1-2.4.1">Members : Identifies the set of Environments that act as members when a Domain Membership is expressed in an ECT<a href="#section-9.1.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>5.</dt>
<dd id="section-9.1.1-2.5">
              <p id="section-9.1.1-2.5.1">Conceptual Message Type : Identifies the type of Conceptual Message that originated the tuple.<a href="#section-9.1.1-2.5.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>6.</dt>
<dd id="section-9.1.1-2.6">
              <p id="section-9.1.1-2.6.1">Profile : The profile that defines this tuple. If no profile is used, this attribute is omitted.<a href="#section-9.1.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-9.1.1-3">The following CDDL describes the ECT structure in more detail.<a href="#section-9.1.1-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-9.1.1-4">
<pre>
ECT = {
  ? environment: environment-map
  ? element-list: [ + element-map ]
  ? authority: [ + $crypto-key-type-choice ]
  ? members: [ + environment-map ]
  ? cmtype: cm-type
  ? profile: $profile-type-choice
}

element-map = {
  ? element-id: $measured-element-type-choice
  element-claims: measurement-values-map
}

cm-type =  &amp;(
  reference-values: 0
  endorsements: 1
  evidence: 2
  attestation-results: 3
  verifier: 4
  policy: 5
  domain-member: 6
)
</pre><a href="#section-9.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-9.1.1-5">The Conceptual Message type (<code>cmtype</code>) determines which attributes are mandatory.
See <a href="#sec-ir-evidence" class="auto internal xref">Section 9.1.3</a> through to <a href="#sec-ir-ars" class="auto internal xref">Section 9.1.10</a> for ECTs of various conceptual messages.<a href="#section-9.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-ir-ext">
<section id="section-9.1.2">
          <h4 id="name-internal-representation-of-c">
<a href="#section-9.1.2" class="section-number selfRef">9.1.2. </a><a href="#name-internal-representation-of-c" class="section-name selfRef">Internal Representation of Cryptographic Keys</a>
          </h4>
<p id="section-9.1.2-1">The internal representation for keys use the extension slot within <code>measurement-values-map</code> with the <code>intrep-keys</code> claim that consists of a list of <code>typed-crypto-key</code>.
<code>typed-crypto-key</code> consists of a <code>key</code> and an optional <code>key-type</code>.
There are two types of keys <code>attest-key</code> and <code>identity-key</code>.<a href="#section-9.1.2-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-9.1.2-2">
<pre>
$$measurement-values-map-extension //= (
  &amp;(intrep-keys: 65534) =&gt; [ + typed-crypto-key ]
)

typed-crypto-key = {
  key: $crypto-key-type-choice
  ? key-type: uint .bits key-type
}

key-type = &amp;(
  attest-key: 0
  identity-key: 1
)

</pre><a href="#section-9.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-ir-evidence">
<section id="section-9.1.3">
          <h4 id="name-internal-representation-of-e">
<a href="#section-9.1.3" class="section-number selfRef">9.1.3. </a><a href="#name-internal-representation-of-e" class="section-name selfRef">Internal Representation of Evidence</a>
          </h4>
<p id="section-9.1.3-1">An internal representation of attestation Evidence uses the <code>ae</code> relation.<a href="#section-9.1.3-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-9.1.3-2">
<pre>
ae = [
  addition: [ + ECT ]
]
</pre><a href="#section-9.1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-9.1.3-3">The <code>addition</code> is a list of ECTs with Evidence to be appraised.<a href="#section-9.1.3-3" class="pilcrow">¶</a></p>
<p id="section-9.1.3-4">A Verifier may maintain multiple simultaneous sessions to different Attesters.
Each Attester has a different ACS. The Verifier ensures the Evidence inputs are associated with the correct ACS.
The <code>addition</code> is added to the ACS for a specific Attester.<a href="#section-9.1.3-4" class="pilcrow">¶</a></p>
<p id="section-9.1.3-5"><a href="#tbl-ae-ect-optionality" class="auto internal xref">Table 3</a> contains the requirements for the ECT fields of the Evidence tuple:<a href="#section-9.1.3-5" class="pilcrow">¶</a></p>
<span id="name-evidence-tuple-requirements"></span><div id="tbl-ae-ect-optionality">
<table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-evidence-tuple-requirements" class="selfRef">Evidence tuple requirements</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">ECT type</th>
                <th class="text-left" rowspan="1" colspan="1">ECT Field</th>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">addition</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="sec-ir-ref-val">
<section id="section-9.1.4">
          <h4 id="name-internal-representation-of-r">
<a href="#section-9.1.4" class="section-number selfRef">9.1.4. </a><a href="#name-internal-representation-of-r" class="section-name selfRef">Internal Representation of Reference Values</a>
          </h4>
<p id="section-9.1.4-1">An internal representation of Reference Values uses the <code>rv</code> relation, which is a list of ECTs that contains possible states and a list of ECTs that contain actual states asserted with RVP authority.<a href="#section-9.1.4-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-9.1.4-2">
<pre>
rv = [ + {
  condition: ECT
  addition: ECT
} ]
</pre><a href="#section-9.1.4-2" class="pilcrow">¶</a>
</div>
<p id="section-9.1.4-3">The <code>rv</code> relation is a list of condition-addition pairings where each pairing is evaluated together.
If the <code>condition</code> containing reference ECTs matches Evidence ECTs then the Evidence ECTs are re-asserted, but with RVP authority as contained in the <code>addition</code> and <code>cmtype</code> set to <code>reference-values</code>.<a href="#section-9.1.4-3" class="pilcrow">¶</a></p>
<p id="section-9.1.4-4">The reference ECTs define the matching conditions that are applied to Evidence ECTs.
If the matching condition is satisfied, then the re-asserted ECTs are added to the ACS.
Refer to <a href="#sec-phase3" class="auto internal xref">Section 9.3.3</a> for how the <code>rv</code> entries are processed.<a href="#section-9.1.4-4" class="pilcrow">¶</a></p>
<p id="section-9.1.4-5"><a href="#tbl-rv-ect-optionality" class="auto internal xref">Table 4</a> contains the requirements for the ECT fields of the Reference Values tuple:<a href="#section-9.1.4-5" class="pilcrow">¶</a></p>
<span id="name-reference-values-tuple-requ"></span><div id="tbl-rv-ect-optionality">
<table class="center" id="table-4">
            <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-reference-values-tuple-requ" class="selfRef">Reference Values tuple requirements</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">ECT type</th>
                <th class="text-left" rowspan="1" colspan="1">ECT Field</th>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">condition</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">addition</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="sec-ir-end-val">
<section id="section-9.1.5">
          <h4 id="name-internal-representation-of-en">
<a href="#section-9.1.5" class="section-number selfRef">9.1.5. </a><a href="#name-internal-representation-of-en" class="section-name selfRef">Internal Representation of Endorsed Values</a>
          </h4>
<p id="section-9.1.5-1">An internal representation of Endorsed Values uses the <code>ev</code> and <code>evs</code> relations, which are lists of ECTs that describe matching conditions and the additions that are added if the conditions are satisfied.<a href="#section-9.1.5-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-9.1.5-2">
<pre>
ev = [
  condition: [ + ECT ]
  addition: [ + ECT ]
]

evs = [
  condition: [ + ECT ]
  series: [ + {
    selection: [ + ECT ]
    addition: [ + ECT ]
  } ]
]
</pre><a href="#section-9.1.5-2" class="pilcrow">¶</a>
</div>
<p id="section-9.1.5-3">The <code>ev</code> relation compares the <code>condition</code> ECTs to the ACS and if all of the ECTs are found in the ACS then the <code>addition</code> ECTs are added to the ACS.<a href="#section-9.1.5-3" class="pilcrow">¶</a></p>
<p id="section-9.1.5-4">The <code>evs</code> relation compares the <code>condition</code> ECTs to the ACS and if all of the ECTs are found in the ACS then each entry in the series list is evaluated.
The <code>selection</code> ECTs are compared with the ACS and if the selection criteria is satisfied, then the <code>addition</code> ECTs are added to the ACS and evaluation of the series ends.
If the <code>selection</code> criteria is not satisfied, then evaluation procedes to the next series list entry.<a href="#section-9.1.5-4" class="pilcrow">¶</a></p>
<p id="section-9.1.5-5"><a href="#tbl-ev-ect-optionality" class="auto internal xref">Table 5</a> contains the requirements for the ECT fields of the Endorsed Values and Endorsed Values Series tuples:<a href="#section-9.1.5-5" class="pilcrow">¶</a></p>
<span id="name-endorsed-values-and-endorse"></span><div id="tbl-ev-ect-optionality">
<table class="center" id="table-5">
            <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-endorsed-values-and-endorse" class="selfRef">Endorsed Values and Endorsed Values Series tuples requirements</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">ECT type</th>
                <th class="text-left" rowspan="1" colspan="1">ECT Field</th>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">condition</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">selection</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">addition</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="sec-ir-dm">
<section id="section-9.1.6">
          <h4 id="name-internal-representation-of-d">
<a href="#section-9.1.6" class="section-number selfRef">9.1.6. </a><a href="#name-internal-representation-of-d" class="section-name selfRef">Internal Representation of Domain Membership</a>
          </h4>
<p id="section-9.1.6-1">An internal representation of Domain Membership is expressed in a single ECT, where the domain identifier is set in the <code>environment</code> field of the ECT, and the domain members are expressed in the <code>members</code> field.
The <code>cmtype</code> is set to domain-member.<a href="#section-9.1.6-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-9.1.6-2">
<pre>
dm = [ + ( domain: ECT ) ]
</pre><a href="#section-9.1.6-2" class="pilcrow">¶</a>
</div>
<p id="section-9.1.6-3"><a href="#tbl-dm-ect-optionality" class="auto internal xref">Table 6</a> contains the requirements for the ECT fields of the Domain Membership tuple:<a href="#section-9.1.6-3" class="pilcrow">¶</a></p>
<span id="name-domain-membership-tuple-req"></span><div id="tbl-dm-ect-optionality">
<table class="center" id="table-6">
            <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-domain-membership-tuple-req" class="selfRef">Domain Membership tuple requirements</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">ECT type</th>
                <th class="text-left" rowspan="1" colspan="1">ECT Field</th>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">domain</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="sec-ir-policy">
<section id="section-9.1.7">
          <h4 id="name-internal-representation-of-p">
<a href="#section-9.1.7" class="section-number selfRef">9.1.7. </a><a href="#name-internal-representation-of-p" class="section-name selfRef">Internal Representation of Policy Statements</a>
          </h4>
<p id="section-9.1.7-1">The <code>policy</code> relation compares the <code>condition</code> ECTs to the ACS.<a href="#section-9.1.7-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-9.1.7-2">
<pre>
policy = [
  condition: [ + ECT ]
  addition: [ + ECT ]
]
</pre><a href="#section-9.1.7-2" class="pilcrow">¶</a>
</div>
<p id="section-9.1.7-3">If all of the ECTs are found in the ACS then the <code>addition</code> ECTs are added to the ACS with the policy author's authority.<a href="#section-9.1.7-3" class="pilcrow">¶</a></p>
<p id="section-9.1.7-4"><a href="#tbl-policy-ect-optionality" class="auto internal xref">Table 7</a> contains the requirements for the ECT fields of the Policy tuple:<a href="#section-9.1.7-4" class="pilcrow">¶</a></p>
<span id="name-policy-tuple-requirements"></span><div id="tbl-policy-ect-optionality">
<table class="center" id="table-7">
            <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-policy-tuple-requirements" class="selfRef">Policy tuple requirements</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">ECT type</th>
                <th class="text-left" rowspan="1" colspan="1">ECT Field</th>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">condition</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">addition</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="sec-ir-ar">
<section id="section-9.1.8">
          <h4 id="name-internal-representation-of-a">
<a href="#section-9.1.8" class="section-number selfRef">9.1.8. </a><a href="#name-internal-representation-of-a" class="section-name selfRef">Internal Representation of Attestation Results</a>
          </h4>
<p id="section-9.1.8-1">The <code>ar</code> relation compares the <code>acs-condition</code> to the ACS.<a href="#section-9.1.8-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-9.1.8-2">
<pre>
ar = [
  acs-condition: [ + ECT ]
  ars-addition: [ + ECT ]
]
</pre><a href="#section-9.1.8-2" class="pilcrow">¶</a>
</div>
<p id="section-9.1.8-3">If the condition is satisfied, the <code>ars-additions</code> are copied from the ACS to the ARS.
If any of the <code>ars-additions</code> are not found in the ACS then these ACS entries are not copied to the ARS.<a href="#section-9.1.8-3" class="pilcrow">¶</a></p>
<p id="section-9.1.8-4"><a href="#tbl-ar-ect-optionality" class="auto internal xref">Table 8</a> contains the requirements for the ECT fields of the Attestation Results tuple:<a href="#section-9.1.8-4" class="pilcrow">¶</a></p>
<span id="name-attestation-results-tuple-r"></span><div id="tbl-ar-ect-optionality">
<table class="center" id="table-8">
            <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-attestation-results-tuple-r" class="selfRef">Attestation Results tuple requirements</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">ECT type</th>
                <th class="text-left" rowspan="1" colspan="1">ECT Field</th>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">acs-condition</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ars-addition</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>element-list</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>profile</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>members</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Optional</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="sec-ir-acs">
<section id="section-9.1.9">
          <h4 id="name-internal-representation-of-ap">
<a href="#section-9.1.9" class="section-number selfRef">9.1.9. </a><a href="#name-internal-representation-of-ap" class="section-name selfRef">Internal Representation of Appraisal Claims Set (ACS)</a>
          </h4>
<p id="section-9.1.9-1">An ACS is a list of ECTs that describe an Attester's actual state.<a href="#section-9.1.9-1" class="pilcrow">¶</a></p>
<p id="section-9.1.9-2">For ECTs present in the ACS, the <code>cmtype</code> field is mandatory.
Table <a href="#tbl-acs-ect-optionality" class="auto internal xref">Table 9</a> shows the minimum required mandatory fields applicable to all ECTs in an ACS.<a href="#section-9.1.9-2" class="pilcrow">¶</a></p>
<span id="name-acs-tuple-minimum-requireme"></span><div id="tbl-acs-ect-optionality">
<table class="center" id="table-9">
            <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-acs-tuple-minimum-requireme" class="selfRef">ACS tuple minimum requirements</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">ECT type</th>
                <th class="text-left" rowspan="1" colspan="1">ECT Field</th>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">n/a</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>environment</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>authority</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>cmtype</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Mandatory</td>
              </tr>
            </tbody>
          </table>
</div>
<div class="lang-cddl sourcecode" id="section-9.1.9-4">
<pre>
ACS = [ + ECT ]
</pre><a href="#section-9.1.9-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-ir-ars">
<section id="section-9.1.10">
          <h4 id="name-internal-representation-of-at">
<a href="#section-9.1.10" class="section-number selfRef">9.1.10. </a><a href="#name-internal-representation-of-at" class="section-name selfRef">Internal Representation of Attestation Results Set (ARS)</a>
          </h4>
<p id="section-9.1.10-1">An ARS is a list of ECTs that describe ACS entries that are selected for use as Attestation Results.<a href="#section-9.1.10-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-9.1.10-2">
<pre>
ARS = [ + ECT ]
</pre><a href="#section-9.1.10-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec-phase1">
<section id="section-9.2">
        <h3 id="name-input-validation-and-transf">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-input-validation-and-transf" class="section-name selfRef">Input Validation and Transformation (Phase 1)</a>
        </h3>
<p id="section-9.2-1">During the initialization phase, the CoRIM Appraisal Context is loaded with various conceptual message inputs such as CoMID tags (<a href="#sec-comid" class="auto internal xref">Section 5</a>), CoSWID tags <span>[<a href="#RFC9393" class="cite xref">RFC9393</a>]</span>, CoTL tags, and cryptographic validation key material (including raw public keys, root certificates, intermediate CA certificate chains), and Concise Trust Anchor Stores (CoTS) <span>[<a href="#I-D.ietf-rats-concise-ta-stores" class="cite xref">I-D.ietf-rats-concise-ta-stores</a>]</span>.
These objects will be utilized in the Evidence Appraisal phase that follows.
The primary goal of this phase is to ensure that all necessary information is available for subsequent processing.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">After context initialization, additional inputs are held back until appraisal processing has completed.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<div id="sec-phase1-valid">
<section id="section-9.2.1">
          <h4 id="name-input-validation">
<a href="#section-9.2.1" class="section-number selfRef">9.2.1. </a><a href="#name-input-validation" class="section-name selfRef">Input Validation</a>
          </h4>
<div id="corim-selection">
<section id="section-9.2.1.1">
            <h5 id="name-corim-selection">
<a href="#section-9.2.1.1" class="section-number selfRef">9.2.1.1. </a><a href="#name-corim-selection" class="section-name selfRef">CoRIM Selection</a>
            </h5>
<p id="section-9.2.1.1-1">All available CoRIMs are collected.<a href="#section-9.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.2.1.1-2">CoRIM tags MUST be discarded if they are expired, or if they are not associated with an authenticated and authorized source, or if they have been revoked by an authorized source.<a href="#section-9.2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-9.2.1.1-3">Any CoRIM that has been secured by a cryptographic mechanism that fails validation MUST be discarded.
An example of such a mechanism is a digital signature.<a href="#section-9.2.1.1-3" class="pilcrow">¶</a></p>
<p id="section-9.2.1.1-4">Other selection criteria MAY be applied.
For example, if the Evidence format is known in advance, CoRIMs using a profile that is not understood by a Verifier can be readily discarded.<a href="#section-9.2.1.1-4" class="pilcrow">¶</a></p>
<p id="section-9.2.1.1-5">Later stages will further select the CoRIMs appropriate to the Evidence Appraisal stage.<a href="#section-9.2.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="corim-trust-anchors">
<section id="section-9.2.1.2">
            <h5 id="name-corim-trust-anchors">
<a href="#section-9.2.1.2" class="section-number selfRef">9.2.1.2. </a><a href="#name-corim-trust-anchors" class="section-name selfRef">CoRIM Trust Anchors</a>
            </h5>
<p id="section-9.2.1.2-1">If CoRIM tags are signed, the signatures MUST be validated using the appropriate trust anchors (certification paths) available to the Verifier.
The Verifier is expected to have a trust anchor store.
The way in which these trust anchors (i.e., root certificates) are provisioned in the Verifier is beyond the scope of this specification.
If signed, the CoRIM itself should include at least one certificate (e.g., as part of the <code>x5chain</code> in the COSE header), which corresponds to the key pair used for signing.
This certificate (the "leaf certificate") must be linked to one of the Verifier trust anchors.<a href="#section-9.2.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tags-extraction-and-validation">
<section id="section-9.2.1.3">
            <h5 id="name-tags-extraction-and-validat">
<a href="#section-9.2.1.3" class="section-number selfRef">9.2.1.3. </a><a href="#name-tags-extraction-and-validat" class="section-name selfRef">Tags Extraction and Validation</a>
            </h5>
<p id="section-9.2.1.3-1">The Verifier chooses tags from the selected CoRIMs - including CoMID, CoSWID, CoTL, and CoTS.<a href="#section-9.2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-9.2.1.3-2">The Verifier MUST discard all tags which are not syntactically and semantically valid.
Cross-referenced triples MUST be successfully resolved. An example of a cross-referenced triple is a CoMID-CoSWID linking triple.<a href="#section-9.2.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cotl-extraction">
<section id="section-9.2.1.4">
            <h5 id="name-cotl-extraction">
<a href="#section-9.2.1.4" class="section-number selfRef">9.2.1.4. </a><a href="#name-cotl-extraction" class="section-name selfRef">CoTL Extraction</a>
            </h5>
<p id="section-9.2.1.4-1">This section is not applicable if the Verifier appraisal policy does not require CoTLs.<a href="#section-9.2.1.4-1" class="pilcrow">¶</a></p>
<p id="section-9.2.1.4-2">CoTLs which are not within their validity period MUST be discarded.<a href="#section-9.2.1.4-2" class="pilcrow">¶</a></p>
<p id="section-9.2.1.4-3">The Verifier processes all CoTLs that are valid at the point in time of Evidence Appraisal and activates all tags referenced therein.<a href="#section-9.2.1.4-3" class="pilcrow">¶</a></p>
<p id="section-9.2.1.4-4">The Verifier MAY decide to discard some of the available and valid CoTLs depending on any locally configured authorization policies.
Such policies model the trust relationships between the Verifier Owner and the relevant suppliers, and are out of the scope of the present document.
For example, a composite device (<span><a href="https://rfc-editor.org/rfc/rfc9334#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) is likely to be fully described by multiple CoRIMs, each signed by a different supplier.
In such a case, the Verifier Owner may instruct the Verifier to discard tags activated by supplier CoTLs that are not also activated by the trusted integrator.<a href="#section-9.2.1.4-4" class="pilcrow">¶</a></p>
<p id="section-9.2.1.4-5">After the Verifier has processed all CoTLs it MUST discard any tags which have not been activated by a CoTL.<a href="#section-9.2.1.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-ev-coll">
<section id="section-9.2.2">
          <h4 id="name-evidence-collection">
<a href="#section-9.2.2" class="section-number selfRef">9.2.2. </a><a href="#name-evidence-collection" class="section-name selfRef">Evidence Collection</a>
          </h4>
<p id="section-9.2.2-1">During the Evidence collection phase, the Verifier communicates with Attesters to gather Evidence.
Discovery of Evidence sources is untrusted.
Verifiers may rely on conveyance protocol specific context to identify an Evidence source, which is the Evidence input oracle for appraisal.<a href="#section-9.2.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2.2-2">The collected Evidence is then transformed to an internal representation, making it suitable for appraisal processing.<a href="#section-9.2.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2.2-3">The exact protocol used to collect Evidence is out of scope of this specification.<a href="#section-9.2.2-3" class="pilcrow">¶</a></p>
<div id="sec-crypto-validate-evidence">
<section id="section-9.2.2.1">
            <h5 id="name-cryptographic-validation-of">
<a href="#section-9.2.2.1" class="section-number selfRef">9.2.2.1. </a><a href="#name-cryptographic-validation-of" class="section-name selfRef">Cryptographic Validation of Evidence</a>
            </h5>
<p id="section-9.2.2.1-1">If Evidence is cryptographically signed, its validation is applied before transforming Evidence to an internal representation.<a href="#section-9.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-9.2.2.1-2">If Evidence is not cryptographically signed, the underlying conveyance protocol that collected it, should provide the required security.
In such cases, the cryptographic validation of Evidence is determined by the security offered by the conveyance protocol.<a href="#section-9.2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-9.2.2.1-3">The way cryptographic signature validation works depends on the specific Evidence collection method used.
For example, in DICE, a proof of liveness is carried out on the final key in the certificate chain (a.k.a., the alias certificate).
If this is successful, a suitable certification path is looked up in the Appraisal Context, based on linking information obtained from the DeviceID certificate.
See Section 9.2.1 of <span>[<a href="#DICE.Layer" class="cite xref">DICE.Layer</a>]</span>.
If a trusted root certificate is found, X.509 certificate validation is performed.<a href="#section-9.2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-9.2.2.1-4">As a second example, in PSA <span>[<a href="#RFC9783" class="cite xref">RFC9783</a>]</span> the verification public key is looked up in the appraisal context using the <code>ueid</code> claim found in the PSA claims-set.
If found, COSE Sign1 verification is performed accordingly.<a href="#section-9.2.2.1-4" class="pilcrow">¶</a></p>
<p id="section-9.2.2.1-5">Regardless of the specific integrity protection method used, the Verifier MUST NOT process Evidence which is not successfully validated.<a href="#section-9.2.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-phase1-trans">
<section id="section-9.2.3">
          <h4 id="name-input-transformation">
<a href="#section-9.2.3" class="section-number selfRef">9.2.3. </a><a href="#name-input-transformation" class="section-name selfRef">Input Transformation</a>
          </h4>
<p id="section-9.2.3-1">Input Conceptual Messages, whether Evidence, Reference Values, Endorsements, or Policies, are transformed to an internal representation that is based on ECTs (<a href="#sec-ir-cm" class="auto internal xref">Section 9.1</a>).<a href="#section-9.2.3-1" class="pilcrow">¶</a></p>
<p id="section-9.2.3-2">The following mapping conventions apply to all forms of input transformation:<a href="#section-9.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3-3.1">
              <ul class="normal">
<li class="normal" id="section-9.2.3-3.1.1.1">
                  <p id="section-9.2.3-3.1.1.1.1">The <code>environment</code> field is populated with a Target Environment identifier.<a href="#section-9.2.3-3.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.2.3-3.1.1.2">
                  <p id="section-9.2.3-3.1.1.2.1">The <code>element-list</code> field is populated with the measurements collected by an Attesting Environment.<a href="#section-9.2.3-3.1.1.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.2.3-3.1.1.3">
                  <p id="section-9.2.3-3.1.1.3.1">The <code>authority</code> field is populated with the identity of the entity that asserted (e.g., signed) the Conceptual Message.<a href="#section-9.2.3-3.1.1.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.2.3-3.1.1.4">
                  <p id="section-9.2.3-3.1.1.4.1">The <code>cmtype</code> field is set based on the type of Conceptual Message inputted or to be output.<a href="#section-9.2.3-3.1.1.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.2.3-3.1.1.5">
                  <p id="section-9.2.3-3.1.1.5.1">The <code>profile</code> field is set based on the <code>corim-map</code> <code>profile</code> value.<a href="#section-9.2.3-3.1.1.5.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<div id="appraisal-context-construction">
<section id="section-9.2.3.1">
            <h5 id="name-appraisal-context-construct">
<a href="#section-9.2.3.1" class="section-number selfRef">9.2.3.1. </a><a href="#name-appraisal-context-construct" class="section-name selfRef">Appraisal Context Construction</a>
            </h5>
<p id="section-9.2.3.1-1">All of the extracted and validated tags are loaded into an <em>appraisal context</em>.
The Appraisal Context contains an internal representation of the inputted Conceptual Messages.
The selected tags are mapped to an internal representation, making them suitable for appraisal processing.<a href="#section-9.2.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="evidence-tranformation">
<section id="section-9.2.3.2">
            <h5 id="name-evidence-tranformation">
<a href="#section-9.2.3.2" class="section-number selfRef">9.2.3.2. </a><a href="#name-evidence-tranformation" class="section-name selfRef">Evidence Tranformation</a>
            </h5>
<p id="section-9.2.3.2-1">Evidence is transformed from an external representation to an internal representation based on the <code>ae</code> relation (<a href="#sec-ir-evidence" class="auto internal xref">Section 9.1.3</a>).
The Evidence is mapped into one or more <code>addition</code> ECTs.
If the Evidence does not have a value for the mandatory <code>ae</code> fields, the Verifier MUST NOT process the Evidence.<a href="#section-9.2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2.3.2-2">Evidence transformation algorithms may be well-known, defined by a CoRIM profile (<a href="#sec-corim-profile-types" class="auto internal xref">Section 4.1.4</a>), or supplied dynamically.
The handling of dynamic Evidence transformation algorithms is out of scope for this document.<a href="#section-9.2.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-ref-trans">
<section id="section-9.2.3.3">
            <h5 id="name-reference-triples-transform">
<a href="#section-9.2.3.3" class="section-number selfRef">9.2.3.3. </a><a href="#name-reference-triples-transform" class="section-name selfRef">Reference Triples Transformation</a>
            </h5>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.3-1">
<dt>Step 1.</dt>
<dd id="section-9.2.3.3-1.1">
                <p id="section-9.2.3.3-1.1.1">An <code>rv</code> list entry (<a href="#sec-ir-ref-val" class="auto internal xref">Section 9.1.4</a>) is allocated.<a href="#section-9.2.3.3-1.1.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt>Step 2.</dt>
<dd id="section-9.2.3.3-1.2">
                <p id="section-9.2.3.3-1.2.1">The <code>cmtype</code> of the <code>addition</code> ECT in the <code>rv</code> entry is set to <code>reference-values</code>.<a href="#section-9.2.3.3-1.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt>Step 3.</dt>
<dd id="section-9.2.3.3-1.3">
                <p id="section-9.2.3.3-1.3.1">The Reference Values Triple (RVT) (<a href="#sec-comid-triple-refval" class="auto internal xref">Section 5.1.4.2</a>) populates the <code>rv</code> ECTs.<a href="#section-9.2.3.3-1.3.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.3-2">
<dt>i</dt>
<dd id="section-9.2.3.3-2.1">
                <p id="section-9.2.3.3-2.1.1">RVT.<code>ref-env</code><a href="#section-9.2.3.3-2.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.3-3.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.3-3.1.1.1">
                    <p id="section-9.2.3.3-3.1.1.1.1"><strong>copy</strong>(<code>environment-map</code>, <code>rv</code>.<code>condition</code>.<code>environment</code>.<code>environment-map</code>)<a href="#section-9.2.3.3-3.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.3-4.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.3-4.1.1.1">
                    <p id="section-9.2.3.3-4.1.1.1.1"><strong>copy</strong>(<code>environment-map</code>, <code>rv</code>.<code>addition</code>.<code>environment</code>.<code>environment-map</code>)<a href="#section-9.2.3.3-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.3-5">
<dt>ii</dt>
<dd id="section-9.2.3.3-5.1">
                <p id="section-9.2.3.3-5.1.1">For each e in RVT.<code>ref-claims</code>:<a href="#section-9.2.3.3-5.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.3-6.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.3-6.1.1.1">
                    <p id="section-9.2.3.3-6.1.1.1.1"><strong>copy</strong>(e.<code>measurement-map</code>, <code>rv</code>.<code>condition</code>.<code>element-list</code>.<code>element-map</code>)<a href="#section-9.2.3.3-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.3-7">
<dt>Step 4.</dt>
<dd id="section-9.2.3.3-7.1">
                <p id="section-9.2.3.3-7.1.1">The signer of the Reference Values conceptual message is copied to the <code>rv</code>.<code>addition</code>.<code>authority</code> field.<a href="#section-9.2.3.3-7.1.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt>Step 5.</dt>
<dd id="section-9.2.3.3-7.2">
                <p id="section-9.2.3.3-7.2.1">If the Reference Values conceptual message has a profile, the profile identifier is copied to the <code>rv</code>.<code>addition</code>.<code>profile</code> field.<a href="#section-9.2.3.3-7.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-end-trans">
<section id="section-9.2.3.4">
            <h5 id="name-endorsement-triples-transfo">
<a href="#section-9.2.3.4" class="section-number selfRef">9.2.3.4. </a><a href="#name-endorsement-triples-transfo" class="section-name selfRef">Endorsement Triples Transformations</a>
            </h5>
<div id="sec-end-trans-evt">
<section id="section-9.2.3.4.1">
              <h6 id="name-endorsed-values-triple-tran">
<a href="#section-9.2.3.4.1" class="section-number selfRef">9.2.3.4.1. </a><a href="#name-endorsed-values-triple-tran" class="section-name selfRef">Endorsed Values Triple Transformation</a>
              </h6>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.1-1">
<dt>Step 1.</dt>
<dd id="section-9.2.3.4.1-1.1">
                  <p id="section-9.2.3.4.1-1.1.1">An <code>ev</code> entry (<a href="#sec-ir-end-val" class="auto internal xref">Section 9.1.5</a>) is allocated.<a href="#section-9.2.3.4.1-1.1.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 2.</dt>
<dd id="section-9.2.3.4.1-1.2">
                  <p id="section-9.2.3.4.1-1.2.1">The <code>cmtype</code> of the <code>ev</code> entry's <code>addition</code> ECT is set to <code>endorsements</code>.<a href="#section-9.2.3.4.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 3.</dt>
<dd id="section-9.2.3.4.1-1.3">
                  <p id="section-9.2.3.4.1-1.3.1">The Endorsed Values Triple (EVT) (<a href="#sec-comid-triple-endval" class="auto internal xref">Section 5.1.4.3</a>) populates the <code>ev</code> ECTs.<a href="#section-9.2.3.4.1-1.3.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.1-2">
<dt>i</dt>
<dd id="section-9.2.3.4.1-2.1">
                  <p id="section-9.2.3.4.1-2.1.1">EVT.<code>condition</code><a href="#section-9.2.3.4.1-2.1.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.1-3.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.1-3.1.1.1">
                      <p id="section-9.2.3.4.1-3.1.1.1.1"><strong>copy</strong>(<code>environment-map</code>, <code>ev</code>.<code>condition</code>.<code>environment</code>.<code>environment-map</code>)<a href="#section-9.2.3.4.1-3.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.1-4.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.1-4.1.1.1">
                      <p id="section-9.2.3.4.1-4.1.1.1.1"><strong>copy</strong>(<code>environment-map</code>, <code>ev</code>.<code>addition</code>.<code>environment</code>.<code>environment-map</code>)<a href="#section-9.2.3.4.1-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.1-5">
<dt>ii</dt>
<dd id="section-9.2.3.4.1-5.1">
                  <p id="section-9.2.3.4.1-5.1.1">For each e in EVT.<code>endorsement</code>:<a href="#section-9.2.3.4.1-5.1.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.1-6.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.1-6.1.1.1">
                      <p id="section-9.2.3.4.1-6.1.1.1.1"><strong>copy</strong>(e.<code>endorsement</code>.<code>measurement-map</code>, <code>ev</code>.<code>addition</code>.<code>element-list</code>.<code>element-map</code>)<a href="#section-9.2.3.4.1-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.1-7">
<dt>Step 4.</dt>
<dd id="section-9.2.3.4.1-7.1">
                  <p id="section-9.2.3.4.1-7.1.1">The signer of the Endorsement conceptual message is copied to the <code>ev</code>.<code>addition</code>.<code>authority</code> field.<a href="#section-9.2.3.4.1-7.1.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 5.</dt>
<dd id="section-9.2.3.4.1-7.2">
                  <p id="section-9.2.3.4.1-7.2.1">If the Endorsement conceptual message has a profile, the profile is copied to the <code>ev</code>.<code>addition</code>.<code>profile</code> field.<a href="#section-9.2.3.4.1-7.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-end-trans-cet">
<section id="section-9.2.3.4.2">
              <h6 id="name-conditional-endorsement-trip">
<a href="#section-9.2.3.4.2" class="section-number selfRef">9.2.3.4.2. </a><a href="#name-conditional-endorsement-trip" class="section-name selfRef">Conditional Endorsement Triple Transformation</a>
              </h6>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.2-1">
<dt>Step 1.</dt>
<dd id="section-9.2.3.4.2-1.1">
                  <p id="section-9.2.3.4.2-1.1.1">An <code>ev</code> entry (<a href="#sec-ir-end-val" class="auto internal xref">Section 9.1.5</a>) is allocated.<a href="#section-9.2.3.4.2-1.1.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 2.</dt>
<dd id="section-9.2.3.4.2-1.2">
                  <p id="section-9.2.3.4.2-1.2.1">The <code>cmtype</code> of the <code>ev</code> entry's <code>addition</code> ECT is set to <code>endorsements</code>.<a href="#section-9.2.3.4.2-1.2.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 3.</dt>
<dd id="section-9.2.3.4.2-1.3">
                  <p id="section-9.2.3.4.2-1.3.1">Entries in the Conditional Endorsement Triple (CET) (<a href="#sec-comid-triple-cond-endors" class="auto internal xref">Section 5.1.4.4</a>) <code>conditions</code> list are copied to a suitable ECT in the internal representation.<a href="#section-9.2.3.4.2-1.3.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.2-2">
<dt>i</dt>
<dd id="section-9.2.3.4.2-2.1">
                  <p id="section-9.2.3.4.2-2.1.1">For each e in CET.<code>conditions</code>:<a href="#section-9.2.3.4.2-2.1.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.2-3.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.2-3.1.1.1">
                      <p id="section-9.2.3.4.2-3.1.1.1.1"><strong>copy</strong>(e.<code>stateful-environment-record</code>.<code>environment</code>.<code>environment-map</code>, <code>ev</code>.<code>condition</code>.<code>environment</code>.<code>environment-map</code>)<a href="#section-9.2.3.4.2-3.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.2-4.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.2-4.1.1.1">
                      <p id="section-9.2.3.4.2-4.1.1.1.1"><strong>copy</strong>(e.<code>stateful-environment-record</code>.<code>claims-list</code>.<code>measurement-map</code>, <code>ev</code>.<code>condition</code>.<code>element-list</code>.<code>element-map</code>)<a href="#section-9.2.3.4.2-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.2-5">
<dt>ii</dt>
<dd id="section-9.2.3.4.2-5.1">
                  <p id="section-9.2.3.4.2-5.1.1">For each e in CET.<code>endorsements</code>:<a href="#section-9.2.3.4.2-5.1.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.2-6.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.2-6.1.1.1">
                      <p id="section-9.2.3.4.2-6.1.1.1.1"><strong>copy</strong>(e.<code>endorsed-triple-record</code>.<code>condition</code>.<code>environment-map</code>, <code>ev</code>.<code>addition</code>.<code>environment</code>.<code>environment-map</code>)<a href="#section-9.2.3.4.2-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.2-7.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.2-7.1.1.1">
                      <p id="section-9.2.3.4.2-7.1.1.1.1"><strong>copy</strong>(e.<code>endorsed-triple-record</code>.<code>endorsement</code>.<code>measurement-map</code>, <code>ev</code>.<code>addition</code>.<code>element-list</code>.<code>element-map</code>)<a href="#section-9.2.3.4.2-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.2-8">
<dt>Step 4.</dt>
<dd id="section-9.2.3.4.2-8.1">
                  <p id="section-9.2.3.4.2-8.1.1">The signer of the Conditional Endorsement conceptual message is copied to the <code>ev</code>.<code>addition</code>.<code>authority</code> field.<a href="#section-9.2.3.4.2-8.1.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 5.</dt>
<dd id="section-9.2.3.4.2-8.2">
                  <p id="section-9.2.3.4.2-8.2.1">If the Conditional Endorsement conceptual message has a profile, the profile is copied to the <code>ev</code>.<code>addition</code>.<code>profile</code> field.<a href="#section-9.2.3.4.2-8.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-end-trans-cest">
<section id="section-9.2.3.4.3">
              <h6 id="name-conditional-endorsement-seri">
<a href="#section-9.2.3.4.3" class="section-number selfRef">9.2.3.4.3. </a><a href="#name-conditional-endorsement-seri" class="section-name selfRef">Conditional Endorsement Series Triple Transformation</a>
              </h6>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.3-1">
<dt>Step 1.</dt>
<dd id="section-9.2.3.4.3-1.1">
                  <p id="section-9.2.3.4.3-1.1.1">An <code>evs</code> entry (<a href="#sec-ir-end-val" class="auto internal xref">Section 9.1.5</a>) is allocated.<a href="#section-9.2.3.4.3-1.1.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 2.</dt>
<dd id="section-9.2.3.4.3-1.2">
                  <p id="section-9.2.3.4.3-1.2.1">The <code>cmtype</code> of the <code>evs</code> entry's <code>addition</code> ECT is set to <code>endorsements</code>.<a href="#section-9.2.3.4.3-1.2.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 3.</dt>
<dd id="section-9.2.3.4.3-1.3">
                  <p id="section-9.2.3.4.3-1.3.1">Populate the <code>evs</code> ECTs using the Conditional Endorsement Series Triple (CEST) (<a href="#sec-comid-triple-cond-series" class="auto internal xref">Section 5.1.4.5</a>).<a href="#section-9.2.3.4.3-1.3.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.3-2">
<dt>i.</dt>
<dd id="section-9.2.3.4.3-2.1">
                  <p id="section-9.2.3.4.3-2.1.1">CEST.<code>condition</code>:<a href="#section-9.2.3.4.3-2.1.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-3.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-3.1.1.1">
                      <p id="section-9.2.3.4.3-3.1.1.1.1"><strong>copy</strong>(<code>stateful-environment-record</code>.<code>environment</code>.<code>environment-map</code>, <code>evs</code>.<code>condition</code>.<code>environment</code>.<code>environment-map</code>)<a href="#section-9.2.3.4.3-3.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-4.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-4.1.1.1">
                      <p id="section-9.2.3.4.3-4.1.1.1.1"><strong>copy</strong>(<code>stateful-environment-record</code>.<code>claims-list</code>.<code>measurement-map</code>, <code>evs</code>.<code>condition</code>.<code>element-list</code>.<code>element-map</code>)<a href="#section-9.2.3.4.3-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.3-5">
<dt>ii.</dt>
<dd id="section-9.2.3.4.3-5.1">
                  <p id="section-9.2.3.4.3-5.1.1">For each e in CEST.<code>series</code>:<a href="#section-9.2.3.4.3-5.1.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-6.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-6.1.1.1">
                      <p id="section-9.2.3.4.3-6.1.1.1.1"><strong>copy</strong>(<code>evs</code>.<code>condition</code>.<code>environment</code>.<code>environment-map</code>, <code>evs</code>.<code>series</code>.<code>selection</code>.<code>environment</code>.<code>environment-map</code>)<a href="#section-9.2.3.4.3-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-7.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-7.1.1.1">
                      <p id="section-9.2.3.4.3-7.1.1.1.1"><strong>copy</strong>(e.<code>conditional-series-record</code>.<code>selection</code>.<code>measurement</code>.<code>measurement-map</code>, <code>evs</code>.<code>series</code>.<code>selection</code>.<code>element-list</code>.<code>element-map</code>)<a href="#section-9.2.3.4.3-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-8.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-8.1.1.1">
                      <p id="section-9.2.3.4.3-8.1.1.1.1"><strong>copy</strong>(<code>evs</code>.<code>condition</code>.<code>environment</code>.<code>environment-map</code>, <code>evs</code>.<code>series</code>.<code>addition</code>.<code>environment</code>.<code>environment-map</code>)<a href="#section-9.2.3.4.3-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-9.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.4.3-9.1.1.1">
                      <p id="section-9.2.3.4.3-9.1.1.1.1"><strong>copy</strong>(e.<code>conditional-series-record</code>.<code>addition</code>.<code>measurement-map</code>, <code>evs</code>.<code>series</code>.<code>addition</code>.<code>element-list</code>.<code>element-map</code>)<a href="#section-9.2.3.4.3-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.3-10">
<dt>Step 4.</dt>
<dd id="section-9.2.3.4.3-10.1">
                  <p id="section-9.2.3.4.3-10.1.1">The signer of the Conditional Endorsement Series conceptual message is copied to the <code>evs</code>.<code>series</code>.<code>addition</code>.<code>authority</code> field.<a href="#section-9.2.3.4.3-10.1.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 5.</dt>
<dd id="section-9.2.3.4.3-10.2">
                  <p id="section-9.2.3.4.3-10.2.1">If the Conditional Endorsement Series conceptual message has a profile, the profile is copied to the <code>evs</code>.<code>series</code>.<code>addition</code>.<code>profile</code> field.<a href="#section-9.2.3.4.3-10.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-end-trans-kvt">
<section id="section-9.2.3.4.4">
              <h6 id="name-key-verification-triples-tr">
<a href="#section-9.2.3.4.4" class="section-number selfRef">9.2.3.4.4. </a><a href="#name-key-verification-triples-tr" class="section-name selfRef">Key Verification Triples Transformation</a>
              </h6>
<p id="section-9.2.3.4.4-1">The following transformation steps are applied for both the <code>identity-triples</code> and <code>attest-key-triples</code> with noted exceptions:<a href="#section-9.2.3.4.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.4-2">
<dt>Step 1.</dt>
<dd id="section-9.2.3.4.4-2.1">
                  <p id="section-9.2.3.4.4-2.1.1">An <code>ev</code> entry (<a href="#sec-ir-end-val" class="auto internal xref">Section 9.1.5</a>) is allocated.<a href="#section-9.2.3.4.4-2.1.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 2.</dt>
<dd id="section-9.2.3.4.4-2.2">
                  <p id="section-9.2.3.4.4-2.2.1">The <code>cmtype</code> of the <code>ev</code> entry's <code>addition</code> ECT is set to <code>endorsements</code>.<a href="#section-9.2.3.4.4-2.2.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 3.</dt>
<dd id="section-9.2.3.4.4-2.3">
                  <p id="section-9.2.3.4.4-2.3.1">Populate the <code>ev</code> <code>condition</code> ECT using either the <code>identity-triple-record</code> or <code>attest-key-triple-record</code> (<a href="#sec-comid-triple-identity" class="auto internal xref">Section 5.1.4.6</a>) as follows:<a href="#section-9.2.3.4.4-2.3.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.4-3">
<dt>i.</dt>
<dd id="section-9.2.3.4.4-3.1">
                  <p id="section-9.2.3.4.4-3.1.1"><strong>copy</strong>(<code>environment-map</code>, <code>ev</code>.<code>condition</code>.<code>environment</code>.<code>environment-map</code>).<a href="#section-9.2.3.4.4-3.1.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>ii.</dt>
<dd id="section-9.2.3.4.4-3.2">
                  <p id="section-9.2.3.4.4-3.2.1">Foreach <em>key</em> in <code>keylist</code>.<code>$crypto-key-type-choice</code>, <strong>copy</strong>(<em>key</em>, <code>ev</code>.<code>condition</code>.<code>element-list</code>.<code>element-map</code>.<code>element-claims</code>.<code>measurement-values-map</code>.<code>intrep-keys</code>.<code>key</code>).<a href="#section-9.2.3.4.4-3.2.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>iii.</dt>
<dd id="section-9.2.3.4.4-3.3">
                  <p id="section-9.2.3.4.4-3.3.1">If <code>key-list</code> originated from <code>attest-key-triples</code>, <strong>set</strong>(<code>ev</code>.<code>condition</code>.<code>element-list</code>.<code>element-map</code>.<code>element-claims</code>.<code>measurement-values-map</code>.<code>intrep-keys</code>.<code>key-type</code> = <code>attest-key</code>).<a href="#section-9.2.3.4.4-3.3.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>iv.</dt>
<dd id="section-9.2.3.4.4-3.4">
                  <p id="section-9.2.3.4.4-3.4.1">Else if <code>key-list</code> originated from <code>identity-triples</code>, <strong>set</strong>(<code>ev</code>.<code>condition</code>.<code>element-list</code>.<code>element-map</code>.<code>element-claims</code>.<code>measurement-values-map</code>.<code>intrep-keys</code>.<code>key-type</code> = <code>identity-key</code>).<a href="#section-9.2.3.4.4-3.4.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>v.</dt>
<dd id="section-9.2.3.4.4-3.5">
                  <p id="section-9.2.3.4.4-3.5.1">If populated, <strong>copy</strong>(<code>mkey</code>, <code>ev</code>.<code>condition</code>.<code>element-list</code>.<code>element-map</code>.<code>element-id</code>).<a href="#section-9.2.3.4.4-3.5.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>vi.</dt>
<dd id="section-9.2.3.4.4-3.6">
                  <p id="section-9.2.3.4.4-3.6.1">If populated, <strong>copy</strong>(<code>authorized-by</code>, <code>ev</code>.<code>condition</code>.<code>authority</code>).<a href="#section-9.2.3.4.4-3.6.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.4.4-4">
<dt>Step 4.</dt>
<dd id="section-9.2.3.4.4-4.1">
                  <p id="section-9.2.3.4.4-4.1.1">The signer of the Identity or Attest Key Endorsement conceptual message is copied to the <code>ev</code>.<code>addition</code>.<code>authority</code> field.<a href="#section-9.2.3.4.4-4.1.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>Step 5.</dt>
<dd id="section-9.2.3.4.4-4.2">
                  <p id="section-9.2.3.4.4-4.2.1">If the Endorsement conceptual message has a profile, the profile is copied to the <code>ev</code>.<code>addition</code>.<code>profile</code> field.<a href="#section-9.2.3.4.4-4.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec-ir-dm-trans">
<section id="section-9.2.3.5">
            <h5 id="name-domain-membership-triples-t">
<a href="#section-9.2.3.5" class="section-number selfRef">9.2.3.5. </a><a href="#name-domain-membership-triples-t" class="section-name selfRef">Domain Membership Triples Transformation</a>
            </h5>
<p id="section-9.2.3.5-1">This section describes how the external representation of a Domain Membership Triple (DMT) (<a href="#sec-comid-triple-domain-membership" class="auto internal xref">Section 5.1.4.8.1</a>) is transformed into its CoRIM internal representation <code>dm</code> (see <a href="#sec-ir-dm" class="auto internal xref">Section 9.1.6</a>).<a href="#section-9.2.3.5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.5-2">
<dt>Step 1.</dt>
<dd id="section-9.2.3.5-2.1">
                <p id="section-9.2.3.5-2.1.1">Allocate a <code>domain</code> ECT entry.<a href="#section-9.2.3.5-2.1.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt>Step 2.</dt>
<dd id="section-9.2.3.5-2.2">
                <p id="section-9.2.3.5-2.2.1">Set the conceptual message type for the <code>domain</code> ECT to 6 (<code>domain-member</code>).<a href="#section-9.2.3.5-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.5-3">
<dt>i</dt>
<dd id="section-9.2.3.5-3.1">
                <p id="section-9.2.3.5-3.1.1"><strong>copy</strong>(<code>domain-member</code>, <code>domain</code>.<code>cmtype</code>)<a href="#section-9.2.3.5-3.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.5-4">
<dt>Step 3.</dt>
<dd id="section-9.2.3.5-4.1">
                <p id="section-9.2.3.5-4.1.1">Set the authority for the domain ECT to the DMT signer (<a href="#sec-corim-signer" class="auto internal xref">Section 4.2.3.1</a>).<a href="#section-9.2.3.5-4.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.5-5">
<dt>i</dt>
<dd id="section-9.2.3.5-5.1">
                <p id="section-9.2.3.5-5.1.1"><strong>copy</strong>(DMT.<code>signer</code>, <code>domain</code>.<code>authority</code>)<a href="#section-9.2.3.5-5.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.5-6">
<dt>Step 4.</dt>
<dd id="section-9.2.3.5-6.1">
                <p id="section-9.2.3.5-6.1.1">Use the DMT to populate the <code>dm</code> internal representation.<a href="#section-9.2.3.5-6.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.5-7">
<dt>i</dt>
<dd id="section-9.2.3.5-7.1">
                <p id="section-9.2.3.5-7.1.1"><strong>copy</strong>(DMT.<code>domain-id</code>, <code>domain</code>.<code>environment</code>)<a href="#section-9.2.3.5-7.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.5-8">
<dt>ii</dt>
<dd id="section-9.2.3.5-8.1">
                <p id="section-9.2.3.5-8.1.1">For each <code>environment</code> <code>e</code> in DMT.<code>members</code>:<a href="#section-9.2.3.5-8.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.5-9.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2.3.5-9.1.1.1">
                    <p id="section-9.2.3.5-9.1.1.1.1"><strong>copy</strong>(DMT.<code>members</code>[e].<code>environment</code>, <code>domain</code>.<code>members</code>[e].<code>environment</code>)<a href="#section-9.2.3.5-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.5-10">
<dt>Step 5.</dt>
<dd id="section-9.2.3.5-10.1">
                <p id="section-9.2.3.5-10.1.1">If the conceptual message containing the DMT has a profile, it is used to populate the profile for the <code>domain</code> ECT.<a href="#section-9.2.3.5-10.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="olPercent" id="section-9.2.3.5-11">
<dt>i</dt>
<dd id="section-9.2.3.5-11.1">
                <p id="section-9.2.3.5-11.1.1"><strong>copy</strong>(DMT.<code>profile</code>, <code>domain</code>.<code>profile</code>)<a href="#section-9.2.3.5-11.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-acs-aug">
<section id="section-9.3">
        <h3 id="name-acs-augmentation-phases-2-3">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-acs-augmentation-phases-2-3" class="section-name selfRef">ACS Augmentation - Phases 2, 3, and 4</a>
        </h3>
<p id="section-9.3-1">In the ACS augmentation phase, a CoRIM Appraisal Context and an Evidence Appraisal Policy are used by the Verifier to find CoMID triples which match the ACS.
Triples that specify an ACS matching condition will augment the ACS with Endorsements if the condition is met.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">Each triple is processed independently of other triples.
However, the ACS state may change as a result of processing a triple.
If a triple condition does not match, then the Verifier continues to process other triples.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<div id="sec-acs-reqs">
<section id="section-9.3.1">
          <h4 id="name-acs-requirements">
<a href="#section-9.3.1" class="section-number selfRef">9.3.1. </a><a href="#name-acs-requirements" class="section-name selfRef">ACS Requirements</a>
          </h4>
<p id="section-9.3.1-1">At the end of the Evidence collection process, the Evidence has been converted into an internal representation suitable for appraisal.
See <a href="#sec-ir-cm" class="auto internal xref">Section 9.1</a>.<a href="#section-9.3.1-1" class="pilcrow">¶</a></p>
<p id="section-9.3.1-2">Verifiers are not required to use this as their internal representation.
For the purposes of this document, appraisal is described in terms of the above cited internal representation.<a href="#section-9.3.1-2" class="pilcrow">¶</a></p>
<div id="acs-processing-requirements">
<section id="section-9.3.1.1">
            <h5 id="name-acs-processing-requirements">
<a href="#section-9.3.1.1" class="section-number selfRef">9.3.1.1. </a><a href="#name-acs-processing-requirements" class="section-name selfRef">ACS Processing Requirements</a>
            </h5>
<p id="section-9.3.1.1-1">The ACS contains the actual state of Attester's Target Environments (TEs).
The ACS contains Evidence ECTs (from Attesters) and Endorsement ECTs
(e.g. from <code>endorsed-triple-record</code>).<a href="#section-9.3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1-2">CoMID Reference Values will be matched against the ACS following the comparison rules in <a href="#sec-match-condition-ect" class="auto internal xref">Section 9.4</a>.
This document describes an example evidence structure which can be
matched against these Reference Values.<a href="#section-9.3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1-3">Each Endorsement ECT contains the environment and internal representation of <code>measurement-map</code>s as extracted from an <code>endorsed-triple-record</code>.
When an <code>endorsed-triple-record</code> is transformed to Endorsements ECTs it
indicates that the authority named by <code>measurement-map</code>.<code>authorized-by</code>
asserts that the actual state of one or more Claims within the
Target Environment, as identified by <code>environment-map</code>, have the
measurement values in <code>measurement-map</code>.<code>mval</code>.<a href="#section-9.3.1.1-3" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1-4">ECT authority is represented by cryptographic keys. Authority
is asserted by digitally signing a Claim using the key. Hence, Claims are
added to the ACS under the authority of a cryptographic key.<a href="#section-9.3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1-5">Each Claim is encoded as an ECT. The <code>environment-map</code>, the <code>mkey</code> or <code>element-id</code>, and a
key within <code>measurement-values-map</code> encode the name of the Claim.
The value matching that key within <code>measurement-values-map</code> is the actual
state of the Claim.<a href="#section-9.3.1.1-5" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1-6">This specification does not assign special meanings to any Claim name,
it only specifies rules for determining when two Claim names are the same.<a href="#section-9.3.1.1-6" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1-7">If two Claims have the same <code>environment-map</code> encoding then this does not
trigger special encoding in the Verifier. The Verifier follows instructions
in the CoRIM file which tell it how claims are related.<a href="#section-9.3.1.1-7" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1-8">If Evidence or Endorsements from different sources has the same <code>environment-map</code>
and <code>authorized-by</code> then the <code>measurement-values-map</code>s are merged.<a href="#section-9.3.1.1-8" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1-9">The ACS MUST maintain the authority information for each ECT. There can be
multiple entries in <code>state-triples</code> which have the same <code>environment-map</code>
and a different authority.
See <a href="#sec-authority" class="auto internal xref">Section 9.3.2.2</a>.<a href="#section-9.3.1.1-9" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1-10">If the merged <code>measurement-values-map</code> contains duplicate codepoints and the
measurement values are equivalent, then duplicate claims SHOULD be omitted.
Equivalence typically means values MUST be binary identical.<a href="#section-9.3.1.1-10" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1-11">If the merged <code>measurement-values-map</code> contains duplicate codepoints and the
measurement values are not equivalent, then the Verifier SHALL report
an error and stop validation processing.<a href="#section-9.3.1.1-11" class="pilcrow">¶</a></p>
<div id="ordering-of-triple-processing">
<section id="section-9.3.1.1.1">
              <h6 id="name-ordering-of-triple-processi">
<a href="#section-9.3.1.1.1" class="section-number selfRef">9.3.1.1.1. </a><a href="#name-ordering-of-triple-processi" class="section-name selfRef">Ordering of triple processing</a>
              </h6>
<p id="section-9.3.1.1.1-1">Triples interface with the ACS by either adding new ACS entries or by matching existing ACS entries before updating the ACS.
Most triples use an <code>environment-map</code> field to select the ACS entries to match or modify.
This field may be contained in an explicit matching condition, such as <code>stateful-environment-record</code>.<a href="#section-9.3.1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1.1-2">The order of triples processing is important.
Processing a triple may result in ACS modifications that affect matching behavior of other triples.<a href="#section-9.3.1.1.1-2" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1.1-3">The Verifier MUST ensure that a triple including a matching condition is processed after any other triple that modifies or adds an ACS entry with an <code>environment-map</code> that is in the matching condition.<a href="#section-9.3.1.1.1-3" class="pilcrow">¶</a></p>
<p id="section-9.3.1.1.1-4">This can be acheived by sorting the triples before processing, by repeating processing of some triples after ACS modifications or by other algorithms.<a href="#section-9.3.1.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-acs-aug-req">
<section id="section-9.3.1.2">
            <h5 id="name-acs-augmentation-requiremen">
<a href="#section-9.3.1.2" class="section-number selfRef">9.3.1.2. </a><a href="#name-acs-augmentation-requiremen" class="section-name selfRef">ACS Augmentation Requirements</a>
            </h5>
<p id="section-9.3.1.2-1">The ordering of ECTs in the ACS is not significant.
Logically, the ACS represents the conjunction of all claims, so adding an ECT entry to the existing ACS at the end is equivalent to inserting it anywhere else.
Implementations may optimize ECT order to achieve better performance.
Additions to the ACS MUST be atomic.<a href="#section-9.3.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-phase2">
<section id="section-9.3.2">
          <h4 id="name-evidence-augmentation-phase">
<a href="#section-9.3.2" class="section-number selfRef">9.3.2. </a><a href="#name-evidence-augmentation-phase" class="section-name selfRef">Evidence Augmentation (Phase 2)</a>
          </h4>
<div id="sec-acs-initialization">
<section id="section-9.3.2.1">
            <h5 id="name-appraisal-claims-set-initia">
<a href="#section-9.3.2.1" class="section-number selfRef">9.3.2.1. </a><a href="#name-appraisal-claims-set-initia" class="section-name selfRef">Appraisal Claims Set Initialization</a>
            </h5>
<p id="section-9.3.2.1-1">The ACS is initialized by copying the internal representation of Evidence claims to the ACS.
See <a href="#sec-acs-aug" class="auto internal xref">Section 9.3</a>.<a href="#section-9.3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-authority">
<section id="section-9.3.2.2">
            <h5 id="name-the-authority-field-in-the-">
<a href="#section-9.3.2.2" class="section-number selfRef">9.3.2.2. </a><a href="#name-the-authority-field-in-the-" class="section-name selfRef">The authority field in the ACS</a>
            </h5>
<p id="section-9.3.2.2-1">The <code>authority</code> field in an ACS ECT indicates the entity whose authority backs the Claims.<a href="#section-9.3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-9.3.2.2-2">The Verifier keeps track of authority so that it can satisfy appraisal policy that specifies authority.<a href="#section-9.3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-9.3.2.2-3">When adding an Evidence entry to the ACS, the Verifier SHALL set the <code>authority</code> field using a <code>$crypto-keys-type-choice</code> representation of the entity that signed the Evidence.<a href="#section-9.3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-9.3.2.2-4">If multiple authorities approve the same Claim, for example if multiple key chains are available, then the <code>authority</code> field SHALL be set to include the <code>$crypto-keys-type-choice</code> representation for each key chain.<a href="#section-9.3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-9.3.2.2-5">When adding Endorsement or Reference Values Claims to the ACS that resulted from CoRIM processing,
the Verifier SHALL set the <code>authority</code> field using a <code>$crypto-keys-type-choice</code> representation of the entity that signed the CoRIM.<a href="#section-9.3.2.2-5" class="pilcrow">¶</a></p>
<p id="section-9.3.2.2-6">When searching the ACS for an entry which matches a triple condition containing an <code>authorized-by</code> field, the Verifier SHALL ignore ACS entries if none of the entries present in the condition <code>authorized-by</code> field are present in the ACS <code>authority</code> field.
The Verifier SHALL match ACS entries if all of the entries present in the condition <code>authorized-by</code> field are present in the ACS <code>authority</code> field.<a href="#section-9.3.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acs-augmentation-using-comid-triples">
<section id="section-9.3.2.3">
            <h5 id="name-acs-augmentation-using-comi">
<a href="#section-9.3.2.3" class="section-number selfRef">9.3.2.3. </a><a href="#name-acs-augmentation-using-comi" class="section-name selfRef">ACS augmentation using CoMID triples</a>
            </h5>
<p id="section-9.3.2.3-1">In the ACS augmentation phase, a CoRIM Appraisal Context and an Evidence Appraisal Policy are used by the Verifier to find CoMID triples which match the ACS.
Triples that specify an ACS matching condition will augment the ACS with Endorsements if the condition is met.<a href="#section-9.3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3.2.3-2">Each triple is processed independently of other triples.
However, the ACS state may change as a result of processing a triple.
If a triple condition does not match, then the Verifier continues to process other triples.<a href="#section-9.3.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-phase3">
<section id="section-9.3.3">
          <h4 id="name-reference-values-corroborat">
<a href="#section-9.3.3" class="section-number selfRef">9.3.3. </a><a href="#name-reference-values-corroborat" class="section-name selfRef">Reference Values Corroboration and Augmentation (Phase 3)</a>
          </h4>
<p id="section-9.3.3-1">Reference Value Providers (RVP) publish Reference Values using the Reference Values Triple (<a href="#sec-comid-triple-refval" class="auto internal xref">Section 5.1.4.2</a>) which are transformed (<a href="#sec-ref-trans" class="auto internal xref">Section 9.2.3.3</a>) into an internal representation (<a href="#sec-ir-ref-val" class="auto internal xref">Section 9.1.4</a>).
Each Reference Value Triple describes a single possible Attester state.<a href="#section-9.3.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3.3-2">Corroboration is the process of determining whether actual Attester state (as contained in the ACS) can be satisfied by Reference Values.<a href="#section-9.3.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3.3-3">Reference Values are matched with ACS entries by iterating through the <code>rv</code> list.
For each <code>rv</code> entry, the <code>condition</code> ECT is compared with an ACS ECT, where the ACS ECT <code>cmtype</code> contains <code>evidence</code>.<a href="#section-9.3.3-3" class="pilcrow">¶</a></p>
<p id="section-9.3.3-4">If satisfied, for the <code>rv</code> entry, the following three steps are performed:<a href="#section-9.3.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.3.3-5">
<li id="section-9.3.3-5.1">
              <p id="section-9.3.3-5.1.1">The <code>addition</code> ECT is moved to the ACS, with <code>cmtype</code> set to <code>reference-values</code><a href="#section-9.3.3-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-9.3.3-5.2">
              <p id="section-9.3.3-5.2.1">The claims, i.e., the <code>element-list</code> from the ACS ECT with <code>cmtype</code> set to <code>evidence</code> is copied to the <code>element-list</code> of the <code>addition</code> ECT<a href="#section-9.3.3-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-9.3.3-5.3">
              <p id="section-9.3.3-5.3.1">The <code>authority</code> field of the <code>addition</code> ECT has been confirmed as being set correctly to the RVP authority<a href="#section-9.3.3-5.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="sec-phase4">
<section id="section-9.3.4">
          <h4 id="name-endorsed-values-augmentatio">
<a href="#section-9.3.4" class="section-number selfRef">9.3.4. </a><a href="#name-endorsed-values-augmentatio" class="section-name selfRef">Endorsed Values Augmentation (Phase 4)</a>
          </h4>
<p id="section-9.3.4-1">Endorsers publish Endorsements using endorsement triples (see <a href="#sec-comid-triple-endval" class="auto internal xref">Section 5.1.4.3</a>), <a href="#sec-comid-triple-cond-endors" class="auto internal xref">Section 5.1.4.4</a>, and <a href="#sec-comid-triple-cond-series" class="auto internal xref">Section 5.1.4.5</a>) which are transformed (<a href="#sec-end-trans" class="auto internal xref">Section 9.2.3.4</a>) into an internal representation (<a href="#sec-ir-end-val" class="auto internal xref">Section 9.1.5</a>).
Endorsements describe actual Attester state.
Endorsements are added to the ACS if the Endorsement condition is satisifed by the ACS.<a href="#section-9.3.4-1" class="pilcrow">¶</a></p>
<div id="sec-process-end">
<section id="section-9.3.4.1">
            <h5 id="name-processing-endorsements">
<a href="#section-9.3.4.1" class="section-number selfRef">9.3.4.1. </a><a href="#name-processing-endorsements" class="section-name selfRef">Processing Endorsements</a>
            </h5>
<p id="section-9.3.4.1-1">Endorsed Values Triple and Conditional Endorsement Triple share the same internal representation.<a href="#section-9.3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-9.3.4.1-2">After transformation into an <code>ev</code> entry, the processing steps of both triples are the same, as described below.
Each <code>ev</code> entry is processed independently of other <code>ev</code>s.<a href="#section-9.3.4.1-2" class="pilcrow">¶</a></p>
<p id="section-9.3.4.1-3">Endorsements are matched with ACS entries by iterating through the <code>ev</code> list.
For each <code>ev</code> entry, the <code>condition</code> ECT is compared with an ACS ECT, where the ACS ECT <code>cmtype</code> contains either <code>evidence</code>, <code>reference-values</code>, or <code>endorsements</code>.
If the ECTs match (<a href="#sec-match-condition-ect" class="auto internal xref">Section 9.4</a>), the <code>ev</code> <code>addition</code> ECT is added to the ACS.<a href="#section-9.3.4.1-3" class="pilcrow">¶</a></p>
<p id="section-9.3.4.1-4">Some condition values can match against multiple ACS-ECTs, or sets of ACS-ECTs.
If there are multiple matches, then each match is processed independently from the others.<a href="#section-9.3.4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-process-cond-end">
<section id="section-9.3.4.2">
            <h5 id="name-processing-conditional-endo">
<a href="#section-9.3.4.2" class="section-number selfRef">9.3.4.2. </a><a href="#name-processing-conditional-endo" class="section-name selfRef">Processing Conditional Endorsements</a>
            </h5>
<p id="section-9.3.4.2-1">Conditional Endorsement Triples are transformed into an internal representation based on <code>ev</code>.
Conditional endorsements have the same processing steps as shown in (<a href="#sec-process-end" class="auto internal xref">Section 9.3.4.1</a>).<a href="#section-9.3.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-process-series">
<section id="section-9.3.4.3">
            <h5 id="name-processing-conditional-endor">
<a href="#section-9.3.4.3" class="section-number selfRef">9.3.4.3. </a><a href="#name-processing-conditional-endor" class="section-name selfRef">Processing Conditional Endorsement Series</a>
            </h5>
<p id="section-9.3.4.3-1">Conditional Endorsement Series Triples are transformed into an internal representation based on <code>evs</code>.
Conditional series endorsements are matched with ACS entries first by iterating through the <code>evs</code> list,
where for each <code>evs</code> entry, the <code>condition</code> ECT is compared with an ACS ECT, where the ACS ECT <code>cmtype</code> contains either <code>evidence</code>, <code>reference-values</code>, or <code>endorsements</code>.
If the ECTs match (<a href="#sec-match-condition-ect" class="auto internal xref">Section 9.4</a>), the <code>evs</code> <code>series</code> array is iterated,
where for each <code>series</code> entry, if the <code>selection</code> ECT matches an ACS ECT,
the <code>addition</code> ECT is added to the ACS.
Series iteration terminates after the first matching series entry is processed or when no series entries match.<a href="#section-9.3.4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-process-keys">
<section id="section-9.3.4.4">
            <h5 id="name-processing-key-verification">
<a href="#section-9.3.4.4" class="section-number selfRef">9.3.4.4. </a><a href="#name-processing-key-verification" class="section-name selfRef">Processing Key Verification Endorsements</a>
            </h5>
<p id="section-9.3.4.4-1">For each <code>ev</code> entry, the <code>condition</code> ECT is compared with an ACS ECT, where the ACS ECT <code>cmtype</code> contains either <code>evidence</code>, <code>reference-values</code>, or <code>endorsements</code>.
If the ECTs match (<a href="#sec-match-condition-ect" class="auto internal xref">Section 9.4</a>), for each <em>key</em> in <code>ev</code>.<code>condition</code>.<code>element-claims</code>.<code>measurement-values-map</code>.<code>intrep-keys</code>:<a href="#section-9.3.4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3.4.4-2.1">
                <p id="section-9.3.4.4-2.1.1">Verify the certificate signatures for the certification path.<a href="#section-9.3.4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.3.4.4-2.2">
                <p id="section-9.3.4.4-2.2.1">Verify certificate revocation status for the certification path.<a href="#section-9.3.4.4-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.3.4.4-2.3">
                <p id="section-9.3.4.4-2.3.1">Verify key usage restrictions appropriate for the type of key.<a href="#section-9.3.4.4-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.3.4.4-2.4">
                <p id="section-9.3.4.4-2.4.1">If key verification succeeds, <strong>append</strong>(<em>key</em>, <code>ev</code>.<code>addition</code>.<code>element-list</code>.<code>element-map</code>.<code>element-claims</code>.<code>measurement-values-map</code>.<code>intrep-keys</code>).<a href="#section-9.3.4.4-2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-9.3.4.4-3">If key verification succeeds for any <em>key</em>:<a href="#section-9.3.4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3.4.4-4.1">
                <p id="section-9.3.4.4-4.1.1"><strong>copy</strong>(<code>ev</code>.<code>condition</code>.<code>environment</code>, <code>ev</code>.<code>addition</code>.<code>environment</code>).<a href="#section-9.3.4.4-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.3.4.4-4.2">
                <p id="section-9.3.4.4-4.2.1"><strong>copy</strong>(<code>ev</code>.<code>condition</code>.<code>element-list</code>.<code>element-map</code>.<code>element-id</code>, <code>ev</code>.<code>addition</code>.<code>element-list</code>.<code>element-map</code>.<code>element-id</code>).<a href="#section-9.3.4.4-4.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.3.4.4-4.3">
                <p id="section-9.3.4.4-4.3.1">Set <code>ev</code>.<code>addition</code>.<code>cmtype</code> to <code>endorsements</code>.<a href="#section-9.3.4.4-4.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.3.4.4-4.4">
                <p id="section-9.3.4.4-4.4.1">Add the Verifier authority <code>$crypto-key-type-choice</code> to the <code>ev</code>.<code>addition</code>.<code>authority</code> field.<a href="#section-9.3.4.4-4.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.3.4.4-4.5">
                <p id="section-9.3.4.4-4.5.1">Add the <code>addition</code> ECT to the ACS.<a href="#section-9.3.4.4-4.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-9.3.4.4-5">Otherwise, do not add the <code>addition</code> ECT to the ACS.<a href="#section-9.3.4.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-process-dm">
<section id="section-9.3.4.5">
            <h5 id="name-processing-domain-membershi">
<a href="#section-9.3.4.5" class="section-number selfRef">9.3.4.5. </a><a href="#name-processing-domain-membershi" class="section-name selfRef">Processing Domain Membership</a>
            </h5>
<p id="section-9.3.4.5-1">This section assumes that each Domain Membership Triple has been transformed into an internal representation following the steps described in <a href="#sec-ir-dm-trans" class="auto internal xref">Section 9.2.3.5</a>, resulting in the representation specified in <a href="#sec-ir-dm" class="auto internal xref">Section 9.1.6</a>.<a href="#section-9.3.4.5-1" class="pilcrow">¶</a></p>
<p id="section-9.3.4.5-2">Domain Membership ECTs (cmtype: domain-member) in the staging area are matched with ACS entries (of cmtype: evidence) OR (of cmtype: domain-member) using the following algorithm:<a href="#section-9.3.4.5-2" class="pilcrow">¶</a></p>
<p id="section-9.3.4.5-3">For every Domain Membership ECT entry (cmtype: domain-member) in staging area, which has not been processed:<a href="#section-9.3.4.5-3" class="pilcrow">¶</a></p>
<p id="section-9.3.4.5-4">For each i in members, check that there is a corresponding ACS entry with a matching <code>environment</code> and (cmtype:evidence OR cmtype: domain-member)<a href="#section-9.3.4.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3.4.5-5.1">
                <p id="section-9.3.4.5-5.1.1">If all members match a corresponding ACS entry, add the Domain Membership ECT to ACS<a href="#section-9.3.4.5-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.3.4.5-5.2">
                <p id="section-9.3.4.5-5.2.1">If none of the members match, proceed to next Domain Membership ECT in the staging area<a href="#section-9.3.4.5-5.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.3.4.5-5.3">
                <p id="section-9.3.4.5-5.3.1">If there is a partial match, proceed to the next Domain Membership ECT in the staging area
If the previous execution of the loop added any Domain Membership ECTs to the ACS, then run the loop again
Else STOP processing Domain Membership ECTs<a href="#section-9.3.4.5-5.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-9.3.4.5-6">The processing terminates, when all the Domain Membership ECTs which are appropriate to the Evidence have been added to the ACS.<a href="#section-9.3.4.5-6" class="pilcrow">¶</a></p>
<p id="section-9.3.4.5-7">If expected Domain Membership ECTs have not been added, then this may affect the processing in a later phase.<a href="#section-9.3.4.5-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-phases567">
<section id="section-9.3.5">
          <h4 id="name-examples-for-optional-phase">
<a href="#section-9.3.5" class="section-number selfRef">9.3.5. </a><a href="#name-examples-for-optional-phase" class="section-name selfRef">Examples for optional phases 5, 6, and 7</a>
          </h4>
<p id="section-9.3.5-1">Phases 5, 6, and 7 are optional depending on implementation design.
Verifier implementations that apply consistency, integrity, or validity checks could be represented as Claims that augment the ACS or could be handled by application specific interfaces.
Processing appraisal policies may result in augmentation or modification of the ACS, but techniques for tracking the application of policies during appraisal need not result in ACS augmentation.
Additionally, the creation of Attestation Results is out-of-scope for this document, nevertheless internal staging may facilitate processing of Attestation Results.<a href="#section-9.3.5-1" class="pilcrow">¶</a></p>
<p id="section-9.3.5-2">Phase 5: Verifier Augmentation<a href="#section-9.3.5-2" class="pilcrow">¶</a></p>
<p id="section-9.3.5-3">Verifiers may add value to accepted Claims, such as ensuring freshness, consistency, and integrity.
The results of the added value may be asserted as Claims with Verifier authority.
For example, if a Verifier is able to ensure collected Evidence is fresh, it might create a freshness Claim that is included with the Evidence Claims in the ACS.<a href="#section-9.3.5-3" class="pilcrow">¶</a></p>
<p id="section-9.3.5-4">Phase 6: Policy Augmentation<a href="#section-9.3.5-4" class="pilcrow">¶</a></p>
<p id="section-9.3.5-5">Appraisal policy inputs could result in Claims that augment the ACS.
For example, an Appraisal Policy for Evidence may specify that if all of a collection of subcomponents satisfy a particular quality metric, the top-level component also satisfies the quality metric.
The Verifier might generate an Endorsement ECT for the top-level component that asserts a quality metric.
Details about the applied policy may augment the ACS.
An internal representation of policy details, based on the policy ECT, as described in <a href="#sec-ir-policy" class="auto internal xref">Section 9.1.7</a>, contains the environments affected by the policy with policy identifiers as Claims.<a href="#section-9.3.5-5" class="pilcrow">¶</a></p>
<p id="section-9.3.5-6">Phase 7: Attestation Results Production and Transformation<a href="#section-9.3.5-6" class="pilcrow">¶</a></p>
<p id="section-9.3.5-7">Attestation Results rely on input from the ACS, but may not bear any similarity to its content.
For example, Attestation Results processing may map the ACS state to a generalized trustworthiness state such as <span>[<a href="#I-D.ietf-rats-ar4si" class="cite xref">I-D.ietf-rats-ar4si</a>]</span>.
Generated Attestation Results Claims may be specific to a particular Relying Party.
Hence, the Verifier may need to maintain multiple Attestation Results contexts.
An internal representation of Attestation Results as separate contexts (<a href="#sec-ir-ars" class="auto internal xref">Section 9.1.10</a>) ensures Relying Party–specific processing does not modify the ACS, which is common to all Relying Parties.
Attestation Results contexts are the inputs to Attestation Results procedures that produce external representations.<a href="#section-9.3.5-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-match-condition-ect">
<section id="section-9.4">
        <h3 id="name-comparing-a-condition-ect-a">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-comparing-a-condition-ect-a" class="section-name selfRef">Comparing a condition ECT against the ACS</a>
        </h3>
<p id="section-9.4-1">The Verifier SHALL iterate over all ACS entries and SHALL attempt to match the condition ECT against each ACS entry. See <a href="#sec-match-one-condition-ect" class="auto internal xref">Section 9.4.1</a>.
The Verifier SHALL create a "matched entries" set, and SHALL populate it with all ACS entries which matched the condition ECT.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">If the matched entries array is not empty, then the condition ECT matches the ACS.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">If the matched entries array is empty, then the condition ECT does not match the ACS.<a href="#section-9.4-3" class="pilcrow">¶</a></p>
<div id="sec-match-one-condition-ect">
<section id="section-9.4.1">
          <h4 id="name-comparing-a-condition-ect-ag">
<a href="#section-9.4.1" class="section-number selfRef">9.4.1. </a><a href="#name-comparing-a-condition-ect-ag" class="section-name selfRef">Comparing a condition ECT against a single ACS entry</a>
          </h4>
<p id="section-9.4.1-1">If the condition ECT contains a profile and the profile defines an algorithm for a codepoint and <code>environment-map</code> then the Verifier MUST use the algorithm defined by the profile, or it MUST use a standard algorithm if the profile defines that.
If the condition ECT contains a profile, but the profile does not define an algorithm for a particular codepoint and <code>environment-map</code> then the verifier MUST use the standard algorithm described in this document to compare the data at that codepoint.<a href="#section-9.4.1-1" class="pilcrow">¶</a></p>
<p id="section-9.4.1-2">The Verifier SHALL perform all of the comparisons defined in <a href="#sec-compare-environment" class="auto internal xref">Section 9.4.2</a>, <a href="#sec-compare-authority" class="auto internal xref">Section 9.4.3</a>, and <a href="#sec-compare-element-list" class="auto internal xref">Section 9.4.4</a>.<a href="#section-9.4.1-2" class="pilcrow">¶</a></p>
<p id="section-9.4.1-3">Each of these comparisons compares one field in the condition ECT against the same field in the ACS entry.<a href="#section-9.4.1-3" class="pilcrow">¶</a></p>
<p id="section-9.4.1-4">If all of the fields match, then the condition ECT matches the ACS entry.<a href="#section-9.4.1-4" class="pilcrow">¶</a></p>
<p id="section-9.4.1-5">If any of the fields does not match, then the condition ECT does not match the ACS entry.<a href="#section-9.4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-compare-environment">
<section id="section-9.4.2">
          <h4 id="name-environment-comparison">
<a href="#section-9.4.2" class="section-number selfRef">9.4.2. </a><a href="#name-environment-comparison" class="section-name selfRef">Environment Comparison</a>
          </h4>
<p id="section-9.4.2-1">The Verifier SHALL compare each field which is present in the condition ECT <code>environment-map</code> against the corresponding field in the ACS entry <code>environment-map</code> using binary comparison.
Before performing the binary comparison, the Verifier SHOULD convert both <code>environment-map</code> fields into a form which meets CBOR Core Deterministic Encoding Requirements <span>[<a href="#STD94" class="cite xref">STD94</a>]</span>.<a href="#section-9.4.2-1" class="pilcrow">¶</a></p>
<p id="section-9.4.2-2">If all fields which are present in the condition ECT <code>environment-map</code> (e.g., instance-id or group-id) are also present in the ACS entry and are binary identical, then the environments match.<a href="#section-9.4.2-2" class="pilcrow">¶</a></p>
<p id="section-9.4.2-3">If any field which is present in the condition ECT <code>environment-map</code> is not present in the ACS entry, then the environments do not match.<a href="#section-9.4.2-3" class="pilcrow">¶</a></p>
<p id="section-9.4.2-4">If any field which is present in the condition ECT <code>environment-map</code> is not binary identical to the corresponding ACS entry field, then the environments do not match.<a href="#section-9.4.2-4" class="pilcrow">¶</a></p>
<p id="section-9.4.2-5">If a field is not present in the condition ECT <code>environment-map</code> then the presence of, and value of, the corresponding ACS entry field SHALL NOT affect whether the environments match.<a href="#section-9.4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-compare-authority">
<section id="section-9.4.3">
          <h4 id="name-authority-comparison">
<a href="#section-9.4.3" class="section-number selfRef">9.4.3. </a><a href="#name-authority-comparison" class="section-name selfRef">Authority comparison</a>
          </h4>
<p id="section-9.4.3-1">The Verifier MUST compare byte-by-byte the condition ECT's <code>authority</code> value to the candidate entry's <code>authority</code> value.<a href="#section-9.4.3-1" class="pilcrow">¶</a></p>
<p id="section-9.4.3-2">If every entry in the condition ECT <code>authority</code> matches byte-by-byte a corresponding entry in the ACS entry <code>authority</code> field, then the authorities match.
The order of the fields in each <code>authority</code> field do not affect the result of the comparison.<a href="#section-9.4.3-2" class="pilcrow">¶</a></p>
<p id="section-9.4.3-3">If any entry in the condition ECT <code>authority</code> does not have a matching entry in the ACS entry <code>authority</code> field then the authorities do not match.<a href="#section-9.4.3-3" class="pilcrow">¶</a></p>
<p id="section-9.4.3-4">When comparing two <code>$crypto-key-type-choice</code> fields for equality, the Verifier SHALL treat them as equal if their deterministic CBOR encoding is binary equal.<a href="#section-9.4.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-compare-element-list">
<section id="section-9.4.4">
          <h4 id="name-element-list-comparison">
<a href="#section-9.4.4" class="section-number selfRef">9.4.4. </a><a href="#name-element-list-comparison" class="section-name selfRef">Element list comparison</a>
          </h4>
<p id="section-9.4.4-1">The Verifier SHALL iterate over all the entries in the condition ECT <code>element-list</code> and compare each one against the corresponding entry in the ACS entry <code>element-list</code>.<a href="#section-9.4.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4.4-2">If every entry in the condition ECT <code>element-list</code> has a matching entry in the ACS entry <code>element-list</code> field then the element lists match.<a href="#section-9.4.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4.4-3">The order of the fields in each <code>element-list</code> field do not affect the result of the comparison.<a href="#section-9.4.4-3" class="pilcrow">¶</a></p>
<p id="section-9.4.4-4">If any entry in the condition ECT <code>element-list</code> does not have a matching entry in the ACS entry <code>element-list</code> field then the <code>element-list</code> do not match.<a href="#section-9.4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-compare-element-map">
<section id="section-9.4.5">
          <h4 id="name-element-map-comparison">
<a href="#section-9.4.5" class="section-number selfRef">9.4.5. </a><a href="#name-element-map-comparison" class="section-name selfRef">Element map comparison</a>
          </h4>
<p id="section-9.4.5-1">The Verifier SHALL compare each <code>element-map</code> within the condition ECT <code>element-list</code> against the ACS entry <code>element-list</code>.<a href="#section-9.4.5-1" class="pilcrow">¶</a></p>
<p id="section-9.4.5-2">First, the Verifier SHALL locate the entries in the ACS entry <code>element-list</code> which have a matching <code>element-id</code> as the condition ECT <code>element-map</code>.
Two <code>element-id</code> fields are the same if they are either both omitted, or both present with binary identical deterministic encodings.<a href="#section-9.4.5-2" class="pilcrow">¶</a></p>
<p id="section-9.4.5-3">Before performing the binary comparison, the Verifier SHOULD convert both fields into a form which meets CBOR Core Deterministic Encoding Requirements <span>[<a href="#STD94" class="cite xref">STD94</a>]</span>.<a href="#section-9.4.5-3" class="pilcrow">¶</a></p>
<p id="section-9.4.5-4">If any condition ECT entry <code>element-id</code> does not have a corresponding <code>element-id</code> in the ACS entry then the element map does not match.<a href="#section-9.4.5-4" class="pilcrow">¶</a></p>
<p id="section-9.4.5-5">If any condition ECT entry has multiple corresponding <code>element-id</code>s then the element map does not match.<a href="#section-9.4.5-5" class="pilcrow">¶</a></p>
<p id="section-9.4.5-6">Second, the Verifier SHALL compare the <code>element-claims</code> field within the condition ECT <code>element-list</code> and the corresponding field from the ACS entry.
See <a href="#sec-compare-mvm" class="auto internal xref">Section 9.4.6</a>.<a href="#section-9.4.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-compare-mvm">
<section id="section-9.4.6">
          <h4 id="name-measurement-values-map-map-">
<a href="#section-9.4.6" class="section-number selfRef">9.4.6. </a><a href="#name-measurement-values-map-map-" class="section-name selfRef">Measurement values map map Comparison</a>
          </h4>
<p id="section-9.4.6-1">The Verifier SHALL iterate over the codepoints which are present in the condition ECT element's <code>measurement-values-map</code>.
Each of the codepoints present in the condition ECT <code>measurement-values-map</code> is compared against the same codepoint in the candidate entry <code>measurement-values-map</code>.<a href="#section-9.4.6-1" class="pilcrow">¶</a></p>
<p id="section-9.4.6-2">If any codepoint present in the condition ECT <code>measurement-values-map</code> does not have a corresponding codepoint within the candidate entry <code>measurement-values-map</code> then Verifier SHALL remove that candidate entry from the candidate entries array.<a href="#section-9.4.6-2" class="pilcrow">¶</a></p>
<p id="section-9.4.6-3">If any codepoint present in the condition ECT <code>measurement-values-map</code> does not match the same codepoint within the candidate entry <code>measurement-values-map</code> then Verifier SHALL remove that candidate entry from the candidate entries array.<a href="#section-9.4.6-3" class="pilcrow">¶</a></p>
<div id="sec-match-one-codepoint">
<section id="section-9.4.6.1">
            <h5 id="name-comparison-of-a-single-meas">
<a href="#section-9.4.6.1" class="section-number selfRef">9.4.6.1. </a><a href="#name-comparison-of-a-single-meas" class="section-name selfRef">Comparison of a single measurement-values-map codepoint</a>
            </h5>
<p id="section-9.4.6.1-1">The Verifier SHALL compare each condition ECT <code>measurement-values-map</code> value against the corresponding ACS entry value using the appropriate algorithm.<a href="#section-9.4.6.1-1" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1-2">Non-negative codepoints represent standard data representations.
The comparison algorithms for these are defined in this document (in the sections below) or in other specifications.
For some non-negative codepoints their behavior is modified by the CBOR tag at the start of the condition ECT <code>measurement-values-map</code> value.<a href="#section-9.4.6.1-2" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1-3">Negative codepoints represent profile defined data representations.
The Verifier SHALL use the codepoint number, the profile associated with the condition ECT, and, if present, the tag value to select the comparison algorithm.<a href="#section-9.4.6.1-3" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1-4">If the Verifier is unable to determine the comparison algorithm which applies to a codepoint then it SHALL behave as though the candidate entry does not match the condition ECT.<a href="#section-9.4.6.1-4" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1-5">Profile writers SHOULD use CBOR tags for widely applicable comparison methods to ease Verifier implementation compliance across profiles.<a href="#section-9.4.6.1-5" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1-6">The following subsections define the comparison algorithms for the <code>measurement-values-map</code> codepoints defined by this specification.<a href="#section-9.4.6.1-6" class="pilcrow">¶</a></p>
<div id="comparison-for-version-entries">
<section id="section-9.4.6.1.1">
              <h6 id="name-comparison-for-version-entr">
<a href="#section-9.4.6.1.1" class="section-number selfRef">9.4.6.1.1. </a><a href="#name-comparison-for-version-entr" class="section-name selfRef">Comparison for version entries</a>
              </h6>
<p id="section-9.4.6.1.1-1">The value stored under <code>measurement-values-map</code> codepoint 0 is an version label, which MUST have type <code>version-map</code>.
Two <code>version-map</code> values can only be compared for equality, as they are colloquial versions that cannot specify ordering.<a href="#section-9.4.6.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="comparison-for-svn-entries">
<section id="section-9.4.6.1.2">
              <h6 id="name-comparison-for-svn-entries">
<a href="#section-9.4.6.1.2" class="section-number selfRef">9.4.6.1.2. </a><a href="#name-comparison-for-svn-entries" class="section-name selfRef">Comparison for svn entries</a>
              </h6>
<p id="section-9.4.6.1.2-1">The ACS entry value stored under <code>measurement-values-map</code> codepoint 1 is a security version number, which MUST have type <code>svn-type</code>.<a href="#section-9.4.6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.2-2">If the entry <code>svn-type</code> is a <code>uint</code> or a <code>uint</code> tagged with #6.552, then comparison with the <code>uint</code> named as SVN is as follows.<a href="#section-9.4.6.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4.6.1.2-3.1">
                  <p id="section-9.4.6.1.2-3.1.1">If the condition ECT value for <code>measurement-values-map</code> codepoint 1 is an untagged <code>uint</code> or a <code>uint</code> tagged with #6.552 then an equality comparison is performed on the <code>uint</code> components.
The comparison MUST return true if the value of SVN is equal to the <code>uint</code> value in the condition ECT.<a href="#section-9.4.6.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.4.6.1.2-3.2">
                  <p id="section-9.4.6.1.2-3.2.1">If the condition ECT value for <code>measurement-values-map</code> codepoint 1 is a <code>uint</code> tagged with #6.553 then a minimum comparison is performed.
The comparison MUST return true if the <code>uint</code> value in the condition ECT is less than or equal to the value of SVN.<a href="#section-9.4.6.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-9.4.6.1.2-4">If the entry <code>svn-type</code> is a <code>uint</code> tagged with #6.553, then comparison with the <code>uint</code> named as MINSVN is as follows.<a href="#section-9.4.6.1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4.6.1.2-5.1">
                  <p id="section-9.4.6.1.2-5.1.1">If the condition ECT value for <code>measurement-values-map</code> codepoint 1 is an untagged <code>uint</code> or a <code>uint</code> tagged with #6.552 then the comparison MUST return false.<a href="#section-9.4.6.1.2-5.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.4.6.1.2-5.2">
                  <p id="section-9.4.6.1.2-5.2.1">If the condition ECT value for <code>measurement-values-map</code> codepoint 1 is a <code>uint</code> tagged with #6.553 then an equality comparison is performed.
The comparison MUST return true if the value of MINSVN is equal to the <code>uint</code> value in the condition ECT.<a href="#section-9.4.6.1.2-5.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-9.4.6.1.2-6">The meaning of a minimum SVN as an entry value is only meaningful as an endorsed value that has been added to the ACS.
The condition therefore treats the minimum SVN as an exact state and not one to compare with inequality.<a href="#section-9.4.6.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cmp-digests">
<section id="section-9.4.6.1.3">
              <h6 id="name-comparison-for-digests-entr">
<a href="#section-9.4.6.1.3" class="section-number selfRef">9.4.6.1.3. </a><a href="#name-comparison-for-digests-entr" class="section-name selfRef">Comparison for digests entries</a>
              </h6>
<p id="section-9.4.6.1.3-1">A <code>digests</code> entry contains one or more digests, each measuring the same object.
When multiple digests are provided, each represents a different algorithm acceptable to the condition ECT author.<a href="#section-9.4.6.1.3-1" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.3-2">In the simple case, a condition ECT digests entry containing one digest matches a candidate entry containing a single entry with the same algorithm and value.<a href="#section-9.4.6.1.3-2" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.3-3">If there are multiple algorithms in common between the condition ECT and candidate entry, then the bytes paired with common algorithms MUST be equal.
This is to prevent downgrade attacks.
The Verifier SHALL treat two algorithm identifiers as equal if they have the same deterministic binary encoding.
If both an integer and a string representation are defined for an algorithm then entities creating ECTs SHOULD use the integer representation.
If condition ECT and ACS entry use different names for the same algorithm, and the Verifier does not recognize that they are the same, then a downgrade attack is possible.<a href="#section-9.4.6.1.3-3" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.3-4">The comparison MUST return false if the CBOR encoding of the <code>digests</code> entry in the condition ECT or the ACS value with the same codepoint is incorrect. For example, if fields are missing or if they are the wrong type.<a href="#section-9.4.6.1.3-4" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.3-5">The comparison MUST return false if the condition ECT digests entry does not contain any digests.<a href="#section-9.4.6.1.3-5" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.3-6">The comparison MUST return false if either digests entry contains multiple values for the same hash algorithm.<a href="#section-9.4.6.1.3-6" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.3-7">The Verifier MUST iterate over the condition ECT <code>digests</code> array, locating the common hash algorithm identifiers which are present in both the condition ECT and in the candidate entry.
If the value associated with any common hash algorithm identifier in the condition ECT differs from the value for the same algorithm identifier in the candidate entry then the comparison MUST return false.<a href="#section-9.4.6.1.3-7" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.3-8">The comparison MUST return false if there are no hash algorithms from the condition ECT in common with the hash algorithms from the candidate entry ECT.<a href="#section-9.4.6.1.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="comparison-for-raw-value-entries">
<section id="section-9.4.6.1.4">
              <h6 id="name-comparison-for-raw-value-en">
<a href="#section-9.4.6.1.4" class="section-number selfRef">9.4.6.1.4. </a><a href="#name-comparison-for-raw-value-en" class="section-name selfRef">Comparison for raw-value entries</a>
              </h6>
<p id="section-9.4.6.1.4-1">A <code>raw-value</code> entry contains binary data.<a href="#section-9.4.6.1.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.4-2">The value stored under <code>measurement-values-map</code> codepoint 4 in an ACS entry MUST be a <code>raw-value</code> entry, which MUST be tagged and have type <code>bytes</code>.<a href="#section-9.4.6.1.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.4-3">The value stored under the condition ECT <code>measurement-values-map</code> codepoint 4 may additionally be a <code>tagged-masked-raw-value</code> entry, which specifies an expected value and a mask.<a href="#section-9.4.6.1.4-3" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.4-4">If the condition ECT <code>measurement-value-map</code> codepoint 4 is of <code>tagged-bytes</code>, and there is no value stored under codepoint 5, then the Verifier treats it in the same way as a <code>tagged-masked-raw-value</code> with the <code>value</code> field holding the same contents and a <code>mask</code> of the same length as the value with all bits set.
The standard comparison function defined in this document removes the tag before performing the comparison.<a href="#section-9.4.6.1.4-4" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.4-5">For backwards compatibility, if the condition ECT <code>measurement-value-map</code> codepoint 4 is of type <code>tagged-bytes</code>, and there is a mask stored under codepoint 5, then the Verifier treats it in the same way as a <code>tagged-masked-raw-value</code> with the <code>value</code> field holding the same contents and a <code>mask</code> holding the contents of codepoint 5.<a href="#section-9.4.6.1.4-5" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.4-6">The comparison MUST return false if the lengths of the candidate entry value and the condition ECT value are different.<a href="#section-9.4.6.1.4-6" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.4-7">The comparison MUST return false if the lengths of the condition ECT mask and value are different.<a href="#section-9.4.6.1.4-7" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.4-8">The comparison MUST use the mask to determine which bits to compare.
If a bit in the mask is 0 then this indicates that the corresponding bit in the ACS Entry value may have either value.
If, for every bit position in the mask whose value is 1, the corresponding bits in both values are equal then the comparison MUST return true.<a href="#section-9.4.6.1.4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cryptokeys-matching">
<section id="section-9.4.6.1.5">
              <h6 id="name-comparison-for-cryptokeys-e">
<a href="#section-9.4.6.1.5" class="section-number selfRef">9.4.6.1.5. </a><a href="#name-comparison-for-cryptokeys-e" class="section-name selfRef">Comparison for cryptokeys entries</a>
              </h6>
<p id="section-9.4.6.1.5-1">The CBOR tag of the first entry of the condition ECT <code>cryptokeys</code> array is compared with the CBOR tag of the first entry of the candidate entry <code>cryptokeys</code> value.
If the CBOR tags match, then the bytes following the CBOR tag from the condition ECT entry are compared byte-by-byte with the bytes following the CBOR tag from the candidate entry.
If the byte strings match and there is another array entry, then the next entry from the condition ECTs array is likewise compared with the next entry of the ACS array.
If all entries of the condition ECTs array match a corresponding entry in the ACS array, then the <code>cryptokeys</code> condition ECT matches.
Otherwise, <code>cryptokeys</code> does not match.<a href="#section-9.4.6.1.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cmp-integrity-registers">
<section id="section-9.4.6.1.6">
              <h6 id="name-comparison-for-integrity-re">
<a href="#section-9.4.6.1.6" class="section-number selfRef">9.4.6.1.6. </a><a href="#name-comparison-for-integrity-re" class="section-name selfRef">Comparison for Integrity Registers</a>
              </h6>
<p id="section-9.4.6.1.6-1">For each Integrity Register entry in the condition ECT, the Verifier will use the associated identifier (i.e., <code>integrity-register-id-type-choice</code>) to look up the matching Integrity Register entry in the candidate entry.
If no entry is found, the comparison MUST return false.
Instead, if an entry is found, the digest comparison proceeds as defined in <a href="#sec-cmp-digests" class="auto internal xref">Section 9.4.6.1.3</a> after equivalence has been found according to <a href="#sec-comid-integrity-registers" class="auto internal xref">Section 5.1.4.1.6</a>.
Note that it is not required for all the entries in the candidate entry to be used during matching: the condition ECT could consist of a subset of the device's register space. In TPM parlance, a TPM "quote" may report all PCRs in Evidence, while a condition ECT could describe a subset of PCRs.<a href="#section-9.4.6.1.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="comparison-for-int-range-entries">
<section id="section-9.4.6.1.7">
              <h6 id="name-comparison-for-int-range-en">
<a href="#section-9.4.6.1.7" class="section-number selfRef">9.4.6.1.7. </a><a href="#name-comparison-for-int-range-en" class="section-name selfRef">Comparison for int-range entries</a>
              </h6>
<p id="section-9.4.6.1.7-1">The ACS entry value stored under <code>measurement-values-map</code> codepoint 15 is an int range value, which MUST have type <code>int-range-type-choice</code>.<a href="#section-9.4.6.1.7-1" class="pilcrow">¶</a></p>
<p id="section-9.4.6.1.7-2">Consider an <code>int</code> ACS entry value named ENTRY in a <code>measurement-values-map</code> codepoint (e.g., 15) that allows comparing <code>int</code> against a either another <code>int</code> or an <code>int-range</code> named CONDITION.<a href="#section-9.4.6.1.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4.6.1.7-3.1">
                  <p id="section-9.4.6.1.7-3.1.1">If CONDITION is an <code>int</code> then an equality comparison is performed with ENTRY.<a href="#section-9.4.6.1.7-3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.4.6.1.7-3.2">
                  <p id="section-9.4.6.1.7-3.2.1">If CONDITION is an <code>int-range</code> (CBOR tag 564), then a range inclusion comparison is performed.
The comparison MUST return true if and only if all the following conditions are true:<a href="#section-9.4.6.1.7-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4.6.1.7-3.2.2.1">
                      <p id="section-9.4.6.1.7-3.2.2.1.1">CONDITION.min is <code>null</code> or ENTRY is greater than or equal to CONDITION.min.<a href="#section-9.4.6.1.7-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-9.4.6.1.7-3.2.2.2">
                      <p id="section-9.4.6.1.7-3.2.2.2.1">CONDITION.max is <code>null</code> or ENTRY is less than or equal to CONDITION.max.<a href="#section-9.4.6.1.7-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<p id="section-9.4.6.1.7-4">Consider an <code>int-range</code> or <code>int-range</code> (CBOR tag 564) value named ENTRY in a <code>measurement-values-map</code> codepoint (e.g., 15) that allows comparing an <code>int-range</code> against either another <code>int-range</code> or an <code>int</code> named CONDITION.<a href="#section-9.4.6.1.7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4.6.1.7-5.1">
                  <p id="section-9.4.6.1.7-5.1.1">If CONDITION is an <code>int</code>, then the comparison MUST return true if and only if ENTRY.min and ENTRY.max are both equal to CONDITION.<a href="#section-9.4.6.1.7-5.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.4.6.1.7-5.2">
                  <p id="section-9.4.6.1.7-5.2.1">If CONDITION is an <code>int-range</code> (CBOR tag 564), then a range subsumption comparison is performed (i.e., the condition range includes all values of the entry range).
The comparison MUST return true if and only if all the following conditions are true:<a href="#section-9.4.6.1.7-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4.6.1.7-5.2.2.1">
                      <p id="section-9.4.6.1.7-5.2.2.1.1">CONDITION.min is <code>null</code> or ENTRY.min is an <code>int</code> that is greater than or equal to CONDITION.min<a href="#section-9.4.6.1.7-5.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-9.4.6.1.7-5.2.2.2">
                      <p id="section-9.4.6.1.7-5.2.2.2.1">CONDITION.max is <code>null</code> or ENTRY.max is an <code>int</code> that is less than or equal to CONDITION.max.<a href="#section-9.4.6.1.7-5.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-compare-profile">
<section id="section-9.4.7">
          <h4 id="name-profile-directed-comparison">
<a href="#section-9.4.7" class="section-number selfRef">9.4.7. </a><a href="#name-profile-directed-comparison" class="section-name selfRef">Profile-directed Comparison</a>
          </h4>
<p id="section-9.4.7-1">A profile MUST specify comparison algorithms for its additions to <code>$</code>-prefixed CoRIM CDDL codepoints when this specification does not prescribe binary comparison.
The profile MUST specify how to compare the CBOR tagged Reference Value against the ACS.<a href="#section-9.4.7-1" class="pilcrow">¶</a></p>
<p id="section-9.4.7-2">Note that the Verifier may compare Reference Values in any order, so the comparison SHOULD NOT be stateful.<a href="#section-9.4.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="section-10">
      <h2 id="name-implementation-status">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-10-1">This section records the status of known implementations of the protocol
defined by this specification at the time of posting of this Internet-Draft,
and is based on a proposal described in <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>. The description of
implementations in this section is intended to assist the IETF in its decision
processes in progressing drafts to RFCs.  Please note that the listing of any
individual implementation here does not imply endorsement by the IETF.
Furthermore, no effort has been spent to verify the information presented here
that was supplied by IETF contributors.  This is not intended as, and must not
be construed to be, a catalogue of available implementations or their features.
Readers are advised to note that other implementations may exist.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">According to <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>, "this will allow reviewers and working groups to
assign due consideration to documents that have the benefit of running code,
which may serve as Evidence of valuable experimentation and feedback that have
made the implemented protocols more mature.  It is up to the individual working
groups to use this information as they see fit".<a href="#section-10-2" class="pilcrow">¶</a></p>
<div id="veraison">
<section id="section-10.1">
        <h3 id="name-veraison">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-veraison" class="section-name selfRef">Veraison</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.1-1.1">
            <p id="section-10.1-1.1.1">Organization responsible for the implementation: Veraison Project, Linux
Foundation<a href="#section-10.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.2">
            <p id="section-10.1-1.2.1">Implementation's web page:
<a href="https://github.com/veraison/corim/blob/main/README.md">https://github.com/veraison/corim/README.md</a><a href="#section-10.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.3">
            <p id="section-10.1-1.3.1">Brief general description: The <code>corim/corim</code> and <code>corim/comid</code> packages
provide a golang API for low-level manipulation of Concise Reference
Integrity Manifest (CoRIM) and Concise Module Identifier (CoMID) tags
respectively.  The <code>corim/cocli</code> package uses the API above (as well as the
API from the <code>veraison/swid</code> package) to provide a user command line
interface for working with CoRIM, CoMID and CoSWID. Specifically, it allows
creating, signing, verifying, displaying, uploading, and more. See
<a href="https://github.com/veraison/cocli/README.md">https://github.com/veraison/cocli/README.md</a> for
further details.<a href="#section-10.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.4">
            <p id="section-10.1-1.4.1">Implementation's level of maturity: alpha.<a href="#section-10.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.5">
            <p id="section-10.1-1.5.1">Coverage: the whole protocol is implemented, including PSA-specific
extensions <span>[<a href="#I-D.fdb-rats-psa-endorsements" class="cite xref">I-D.fdb-rats-psa-endorsements</a>]</span>.<a href="#section-10.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.6">
            <p id="section-10.1-1.6.1">Version compatibility: Version -02 of the draft<a href="#section-10.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.7">
            <p id="section-10.1-1.7.1">Licensing: Apache 2.0
<a href="https://github.com/veraison/corim/blob/main/LICENSE">https://github.com/veraison/corim/blob/main/LICENSE</a><a href="#section-10.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.8">
            <p id="section-10.1-1.8.1">Implementation experience: n/a<a href="#section-10.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.9">
            <p id="section-10.1-1.9.1">Contact information:
<a href="https://veraison.zulipchat.com">https://veraison.zulipchat.com</a><a href="#section-10.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.10">
            <p id="section-10.1-1.10.1">Last updated:
<a href="https://github.com/veraison/corim/commits/main">https://github.com/veraison/corim/commits/main</a><a href="#section-10.1-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-sec">
<section id="section-11">
      <h2 id="name-security-and-privacy-consid">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-and-privacy-consid" class="section-name selfRef">Security and Privacy Considerations</a>
      </h2>
<p id="section-11-1">Evidence appraisal is at the core of any RATS protocol flow, mediating all interactions between Attesters and their Relying Parties.
The Verifier is effectively part of the Attesters' and Relying Parties' trusted computing base (TCB).
Any mistake in the appraisal procedure conducted by the Verifier could have security implications.
For instance, it could lead to the subversion of an access control function, which creates a chance for privilege escalation.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">Therefore, the Verifier’s code and configuration, especially those of the CoRIM processor, are primary security assets that must be built and maintained as securely as possible.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">The protection of the Verifier system should be considered throughout its entire lifecycle, from design to operation.
This includes the following aspects:<a href="#section-11-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-4.1">
          <p id="section-11-4.1.1">Minimizing implementation complexity (see also <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-endorsements-07#section-6.1" class="relref">Section 6.1</a> of [<a href="#I-D.ietf-rats-endorsements" class="cite xref">I-D.ietf-rats-endorsements</a>]</span>);<a href="#section-11-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-4.2">
          <p id="section-11-4.2.1">Using memory-safe programming languages;<a href="#section-11-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-4.3">
          <p id="section-11-4.3.1">Using secure defaults;<a href="#section-11-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-4.4">
          <p id="section-11-4.4.1">Minimizing the attack surface by avoiding unnecessary features that could be exploited by attackers;<a href="#section-11-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-4.5">
          <p id="section-11-4.5.1">Applying the principle of least privilege to the system's users;<a href="#section-11-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-4.6">
          <p id="section-11-4.6.1">Minimizing the potential impact of security breaches by implementing separation of duties in both the software and operational architecture;<a href="#section-11-4.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-4.7">
          <p id="section-11-4.7.1">Conducting regular, automated audits and reviews of the system, such as ensuring that users' privileges are correctly configured and that any new code has been audited and approved by independent parties;<a href="#section-11-4.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-4.8">
          <p id="section-11-4.8.1">Failing securely in the event of errors to avoid compromising the security of the system.<a href="#section-11-4.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-11-5">It is critical that appraisal procedures are auditable and reproducible.
The integrity of code and data during execution is an explicit objective, for example, ensuring that the appraisal functions are executed in an attestable trusted execution environment (TEE).<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">The integrity of public and private key material and the secrecy of private key material must be ensured at all times.
This includes key material carried in attestation key triples and key material used to verify the authority of triples (such as public keys that identify trusted supply chain actors).
For more detailed information on protecting Trust Anchors, refer to <span><a href="https://rfc-editor.org/rfc/rfc9334#section-12.4" class="relref">Section 12.4</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.
Utilizing the public part of an asymmetric key pair that is used for Evidence generation to identify an Attesting Environment raises privacy considerations that must be carefully considered.<a href="#section-11-6" class="pilcrow">¶</a></p>
<p id="section-11-7">The Verifier should use cryptographically protected, mutually authenticated secure channels to all its trusted input sources (Endorsers, RVPs, Verifier Owners).
These links must reach as deep as possible - possibly terminating within the appraisal session context - to avoid man-in-the-middle attacks.
Minimizing the use of intermediaries is also vital: each intermediary becomes another party that might need to be trusted and therefore factored in the Attesters and Relying Parties' TCBs.
Refer to <span><a href="https://rfc-editor.org/rfc/rfc9334#section-12.2" class="relref">Section 12.2</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> for information on Conceptual Messages protection.<a href="#section-11-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-iana-cons">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="new-cose-header-parameters">
<section id="section-12.1">
        <h3 id="name-new-cose-header-parameters">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-new-cose-header-parameters" class="section-name selfRef">New COSE Header Parameters</a>
      </h3>
</section>
</div>
<div id="sec-iana-cbor-tags">
<section id="section-12.2">
        <h3 id="name-new-cbor-tags">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-new-cbor-tags" class="section-name selfRef">New CBOR Tags</a>
        </h3>
<p id="section-12.2-1">IANA is requested to allocate the following tags in the "CBOR Tags" registry <span>[<a href="#IANA.cbor-tags" class="cite xref">IANA.cbor-tags</a>]</span>, preferably with the specific CBOR tag value requested:<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-10">
          <caption><a href="#table-10" class="selfRef">Table 10</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Tag</th>
              <th class="text-left" rowspan="1" colspan="1">Data Item</th>
              <th class="text-left" rowspan="1" colspan="1">Semantics</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">500</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>tag</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for backward compatibility</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">501</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>map</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">A tagged-unsigned-corim-map, see <a href="#sec-corim-map" class="auto internal xref">Section 4.1</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">502-504</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>any</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Earmarked for CoRIM</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">505</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>bytes</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">A tagged-concise-swid-tag, see <a href="#sec-corim-tags" class="auto internal xref">Section 4.1.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">506</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>bytes</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">A tagged-concise-mid-tag, see <a href="#sec-corim-tags" class="auto internal xref">Section 4.1.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">507</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>any</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Earmarked for CoRIM</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">508</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>bytes</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">A tagged-concise-tl-tag, see <a href="#sec-corim-tags" class="auto internal xref">Section 4.1.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">509-549</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>any</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Earmarked for CoRIM</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">550</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>bytes .size (7..33)</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-ueid-type, see <a href="#sec-common-ueid" class="auto internal xref">Section 7.5</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">552</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>uint</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-svn, see <a href="#sec-comid-svn" class="auto internal xref">Section 5.1.4.1.4.4</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">553</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>uint</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-min-svn, see <a href="#sec-comid-svn" class="auto internal xref">Section 5.1.4.1.4.4</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">554</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>text</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-pkix-base64-key-type, see <a href="#sec-crypto-keys" class="auto internal xref">Section 5.1.4.1.5</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">555</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>text</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-pkix-base64-cert-type, see <a href="#sec-crypto-keys" class="auto internal xref">Section 5.1.4.1.5</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">556</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>text</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-pkix-base64-cert-path-type, see <a href="#sec-crypto-keys" class="auto internal xref">Section 5.1.4.1.5</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">557</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>[int/text, bytes]</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-key-thumbprint-type, see <a href="#sec-common-hash-entry" class="auto internal xref">Section 7.7</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">558</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>COSE_Key</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-cose-key-type, see <a href="#sec-crypto-keys" class="auto internal xref">Section 5.1.4.1.5</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">559</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>digest</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-cert-thumbprint-type, see <a href="#sec-crypto-keys" class="auto internal xref">Section 5.1.4.1.5</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">560</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>bytes</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-bytes, see <a href="#sec-common-tagged-bytes" class="auto internal xref">Section 7.8</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">561</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>digest</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-cert-path-thumbprint-type, see <a href="#sec-crypto-keys" class="auto internal xref">Section 5.1.4.1.5</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">562</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>bytes</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-pkix-asn1der-cert-type, see <a href="#sec-crypto-keys" class="auto internal xref">Section 5.1.4.1.5</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">563</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>tagged-masked-raw-value</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-masked-raw-value, see <a href="#sec-comid-raw-value-types" class="auto internal xref">Section 5.1.4.1.4.6</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">564</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>array</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">tagged-int-range, see <a href="#sec-comid-int-range" class="auto internal xref">Section 5.1.4.1.7</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">565-599</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>any</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Earmarked for CoRIM</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
          </tbody>
        </table>
<p id="section-12.2-3">Tags designated as "Earmarked for CoRIM" can be reassigned by IANA based on advice from the designated expert for the CBOR Tags registry.<a href="#section-12.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-iana-corim">
<section id="section-12.3">
        <h3 id="name-corim-map-registry">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-corim-map-registry" class="section-name selfRef">CoRIM Map Registry</a>
        </h3>
<p id="section-12.3-1">This document defines a new registry titled "CoRIM Map".
The registry uses integer values as index values for items in <code>corim-map</code> CBOR maps.<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<p id="section-12.3-2">Future registrations for this registry are to be made based on <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> as follows:<a href="#section-12.3-2" class="pilcrow">¶</a></p>
<span id="name-corim-map-items-registratio"></span><div id="tbl-iana-corim-map-items-reg-procedures">
<table class="center" id="table-11">
          <caption>
<a href="#table-11" class="selfRef">Table 11</a>:
<a href="#name-corim-map-items-registratio" class="selfRef">CoRIM Map Items Registration Procedures</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-127</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">128-255</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.3-4">All negative values are reserved for Private Use.<a href="#section-12.3-4" class="pilcrow">¶</a></p>
<p id="section-12.3-5">Initial registrations for the "CoRIM Map" registry are provided below.
Assignments consist of an integer index value, the item name, and a reference to the defining specification.<a href="#section-12.3-5" class="pilcrow">¶</a></p>
<span id="name-corim-map-items-initial-reg"></span><div id="tbl-iana-corim-map-items">
<table class="center" id="table-12">
          <caption>
<a href="#table-12" class="selfRef">Table 12</a>:
<a href="#name-corim-map-items-initial-reg" class="selfRef">CoRIM Map Items Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Index</th>
              <th class="text-left" rowspan="1" colspan="1">Item Name</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">id</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">tags</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">dependent-rims</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">profile</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">rim-validity</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">entities</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3-255</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-corim-entity-map">
<section id="section-12.4">
        <h3 id="name-corim-entity-map-registry">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-corim-entity-map-registry" class="section-name selfRef">CoRIM Entity Map Registry</a>
        </h3>
<p id="section-12.4-1">This document defines a new registry titled "CoRIM Entity Map".
The registry uses integer values as index values for items in <code>corim-entity-map</code> CBOR maps.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<p id="section-12.4-2">Future registrations for this registry are to be made based on <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> as follows:<a href="#section-12.4-2" class="pilcrow">¶</a></p>
<span id="name-corim-entity-map-items-regi"></span><div id="tbl-iana-corim-entity-map-items-reg-procedures">
<table class="center" id="table-13">
          <caption>
<a href="#table-13" class="selfRef">Table 13</a>:
<a href="#name-corim-entity-map-items-regi" class="selfRef">CoRIM Entity Map Items Registration Procedures</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-127</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">128-255</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.4-4">All negative values are reserved for Private Use.<a href="#section-12.4-4" class="pilcrow">¶</a></p>
<p id="section-12.4-5">Initial registrations for the "CoRIM Entity Map" registry are provided below.
Assignments consist of an integer index value, the item name, and a reference to the defining specification.<a href="#section-12.4-5" class="pilcrow">¶</a></p>
<span id="name-corim-entity-map-items-init"></span><div id="tbl-iana-corim-entity-map-items">
<table class="center" id="table-14">
          <caption>
<a href="#table-14" class="selfRef">Table 14</a>:
<a href="#name-corim-entity-map-items-init" class="selfRef">CoRIM Entity Map Items Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Index</th>
              <th class="text-left" rowspan="1" colspan="1">Item Name</th>
              <th class="text-left" rowspan="1" colspan="1">Value Type</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">entity-name</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>text</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Name of the entity responsible for the actions of the role.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">reg-id</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>uri</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">A URI associated with the organization that owns the entity name.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">role</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>[ + role-type-choice ]</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">A type choice defining the roles that the entity is claiming.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3-255</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-corim-signer-map">
<section id="section-12.5">
        <h3 id="name-corim-signer-map-registry">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-corim-signer-map-registry" class="section-name selfRef">CoRIM Signer Map Registry</a>
        </h3>
<p id="section-12.5-1">This document defines a new registry titled "CoRIM Signer Map".
The registry uses integer values as index values for items in <code>corim-signer-map</code> CBOR maps.<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<p id="section-12.5-2">Future registrations for this registry are to be made based on <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> as follows:<a href="#section-12.5-2" class="pilcrow">¶</a></p>
<span id="name-corim-signer-map-items-regi"></span><div id="tbl-iana-corim-signer-map-items-reg-procedures">
<table class="center" id="table-15">
          <caption>
<a href="#table-15" class="selfRef">Table 15</a>:
<a href="#name-corim-signer-map-items-regi" class="selfRef">CoRIM Signer Map Items Registration Procedures</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-127</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">128-255</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.5-4">All negative values are reserved for Private Use.<a href="#section-12.5-4" class="pilcrow">¶</a></p>
<p id="section-12.5-5">Initial registrations for the "CoRIM Signer Map" registry are provided below.
Assignments consist of an integer index value, the item name, and a reference to the defining specification.<a href="#section-12.5-5" class="pilcrow">¶</a></p>
<span id="name-corim-signer-map-items-init"></span><div id="tbl-iana-corim-signer-map-items">
<table class="center" id="table-16">
          <caption>
<a href="#table-16" class="selfRef">Table 16</a>:
<a href="#name-corim-signer-map-items-init" class="selfRef">CoRIM Signer Map Items Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Index</th>
              <th class="text-left" rowspan="1" colspan="1">Item Name</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">signer-name</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">signer-uri</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2-255</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-comid">
<section id="section-12.6">
        <h3 id="name-comid-map-registry">
<a href="#section-12.6" class="section-number selfRef">12.6. </a><a href="#name-comid-map-registry" class="section-name selfRef">CoMID Map Registry</a>
        </h3>
<p id="section-12.6-1">This document defines a new registry titled "CoMID Map".
The registry uses integer values as index values for items in <code>concise-mid-tag</code> CBOR maps.<a href="#section-12.6-1" class="pilcrow">¶</a></p>
<p id="section-12.6-2">Future registrations for this registry are to be made based on <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> as follows:<a href="#section-12.6-2" class="pilcrow">¶</a></p>
<span id="name-comid-map-items-registratio"></span><div id="tbl-iana-comid-map-items-reg-procedures">
<table class="center" id="table-17">
          <caption>
<a href="#table-17" class="selfRef">Table 17</a>:
<a href="#name-comid-map-items-registratio" class="selfRef">CoMID Map Items Registration Procedures</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-127</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">128-255</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.6-4">All negative values are reserved for Private Use.<a href="#section-12.6-4" class="pilcrow">¶</a></p>
<p id="section-12.6-5">Initial registrations for the "CoMID Map" registry are provided below.
Assignments consist of an integer index value, the item name, and a reference to the defining specification.<a href="#section-12.6-5" class="pilcrow">¶</a></p>
<span id="name-comid-map-items-initial-reg"></span><div id="tbl-iana-comid-map-items">
<table class="center" id="table-18">
          <caption>
<a href="#table-18" class="selfRef">Table 18</a>:
<a href="#name-comid-map-items-initial-reg" class="selfRef">CoMID Map Items Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Index</th>
              <th class="text-left" rowspan="1" colspan="1">Item Name</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">language</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">tag-identity</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">entity</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">linked-tags</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">triples</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5-255</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-comid-entity-map">
<section id="section-12.7">
        <h3 id="name-comid-entity-map-registry">
<a href="#section-12.7" class="section-number selfRef">12.7. </a><a href="#name-comid-entity-map-registry" class="section-name selfRef">CoMID Entity Map Registry</a>
        </h3>
<p id="section-12.7-1">This document defines a new registry titled "CoRIM Entity Map".
The registry uses integer values as index values for items in <code>corim-entity-map</code> CBOR maps.<a href="#section-12.7-1" class="pilcrow">¶</a></p>
<p id="section-12.7-2">Future registrations for this registry are to be made based on <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> as follows:<a href="#section-12.7-2" class="pilcrow">¶</a></p>
<span id="name-comid-entity-map-items-regi"></span><div id="tbl-iana-comid-entity-map-items-reg-procedures">
<table class="center" id="table-19">
          <caption>
<a href="#table-19" class="selfRef">Table 19</a>:
<a href="#name-comid-entity-map-items-regi" class="selfRef">CoMID Entity Map Items Registration Procedures</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-127</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">128-255</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.7-4">All negative values are reserved for Private Use.<a href="#section-12.7-4" class="pilcrow">¶</a></p>
<p id="section-12.7-5">Initial registrations for the "CoMID Entity Map" registry are provided below.
Assignments consist of an integer index value, the item name, and a reference to the defining specification.<a href="#section-12.7-5" class="pilcrow">¶</a></p>
<span id="name-comid-entity-map-items-init"></span><div id="tbl-iana-comid-entity-map-items">
<table class="center" id="table-20">
          <caption>
<a href="#table-20" class="selfRef">Table 20</a>:
<a href="#name-comid-entity-map-items-init" class="selfRef">CoMID Entity Map Items Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Index</th>
              <th class="text-left" rowspan="1" colspan="1">Item Name</th>
              <th class="text-left" rowspan="1" colspan="1">Value Type</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">entity-name</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>text</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Name of the entity responsible for the actions of the role.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">reg-id</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>uri</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">A URI associated with the organization that owns the entity name.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">role</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>[ + role-type-choice ]</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">A type choice defining the roles that the entity is claiming.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3-255</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-triples-map">
<section id="section-12.8">
        <h3 id="name-comid-triples-map-registry">
<a href="#section-12.8" class="section-number selfRef">12.8. </a><a href="#name-comid-triples-map-registry" class="section-name selfRef">CoMID Triples Map Registry</a>
        </h3>
<p id="section-12.8-1">This document defines a new registry titled "CoMID Triples Map".
The registry uses integer values as index values for items in the <code>triples-map</code> CBOR maps in <code>concise-mid-tag</code> codepoint 4.<a href="#section-12.8-1" class="pilcrow">¶</a></p>
<p id="section-12.8-2">Future registrations for this registry are to be made based on <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> as follows:<a href="#section-12.8-2" class="pilcrow">¶</a></p>
<span id="name-comid-triples-map-items-reg"></span><div id="tbl-iana-comid-triples-map-items-reg-procedures">
<table class="center" id="table-21">
          <caption>
<a href="#table-21" class="selfRef">Table 21</a>:
<a href="#name-comid-triples-map-items-reg" class="selfRef">CoMID Triples Map Items Registration Procedures</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-1023</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1024-65535</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">65536-18446744073709551616</td>
              <td class="text-left" rowspan="1" colspan="1">First come first served</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.8-4">All negative values are reserved for Private Use.<a href="#section-12.8-4" class="pilcrow">¶</a></p>
<p id="section-12.8-5">Initial registrations for the "CoMID Triples Map" registry are provided below.
Assignments consist of an integer index value, the item name, and a reference to the defining specification.<a href="#section-12.8-5" class="pilcrow">¶</a></p>
<span id="name-comid-triples-map-items-ini"></span><div id="tbl-iana-triples-map-items">
<table class="center" id="table-22">
          <caption>
<a href="#table-22" class="selfRef">Table 22</a>:
<a href="#name-comid-triples-map-items-ini" class="selfRef">CoMID Triples Map Items Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Index</th>
              <th class="text-left" rowspan="1" colspan="1">Item Name</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">reference-triples</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">endorsed-triples</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">identity-triples</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">attest-key-triples</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">dependency-triples</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">membership-triples</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">coswid-triples</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">(reserved)</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">conditional-endorsement-series-triples</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">(reserved)</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">conditional-endorsement-triples</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">11-18446744073709551616</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-comid-measurement-values-map">
<section id="section-12.9">
        <h3 id="name-comid-measurement-values-ma">
<a href="#section-12.9" class="section-number selfRef">12.9. </a><a href="#name-comid-measurement-values-ma" class="section-name selfRef">CoMID Measurement Values Map Registry</a>
        </h3>
<p id="section-12.9-1">This document defines a new registry titled "CoMID Measurement Values Map".
The registry uses integer values as index values for items in multiple triples' representations.<a href="#section-12.9-1" class="pilcrow">¶</a></p>
<p id="section-12.9-2">Future registrations for this registry are to be made based on <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> as follows:<a href="#section-12.9-2" class="pilcrow">¶</a></p>
<span id="name-comid-measurement-values-map"></span><div id="tbl-iana-comid-measurement-values-map-items-reg-procedures">
<table class="center" id="table-23">
          <caption>
<a href="#table-23" class="selfRef">Table 23</a>:
<a href="#name-comid-measurement-values-map" class="selfRef">CoMID Measurement Values Map Items Registration Procedures</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-1023</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1024-65535</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">65536-18446744073709551616</td>
              <td class="text-left" rowspan="1" colspan="1">First come first served</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.9-4">All negative values are reserved for Private Use.<a href="#section-12.9-4" class="pilcrow">¶</a></p>
<p id="section-12.9-5">Initial registrations for the "CoMID Measurement Values Map" registry are provided below.
Assignments consist of an integer index value, the item name, and a reference to the defining specification.<a href="#section-12.9-5" class="pilcrow">¶</a></p>
<span id="name-measurement-values-map-item"></span><div id="tbl-iana-comid-measurement-values-map-items">
<table class="center" id="table-24">
          <caption>
<a href="#table-24" class="selfRef">Table 24</a>:
<a href="#name-measurement-values-map-item" class="selfRef">Measurement Values Map Items Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Index</th>
              <th class="text-left" rowspan="1" colspan="1">Item Name</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">version</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">svn</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">digests</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">flags</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">raw-value</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">raw-value-mask-DEPRECATED</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">mac-addr</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">ip-addr</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">serial-number</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">ueid</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">uuid</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">11</td>
              <td class="text-left" rowspan="1" colspan="1">name</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">(reserved)</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">13</td>
              <td class="text-left" rowspan="1" colspan="1">cryptokeys</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">14</td>
              <td class="text-left" rowspan="1" colspan="1">integrity-registers</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">15</td>
              <td class="text-left" rowspan="1" colspan="1">int-range</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">16-18446744073709551616</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-comid-flags-map">
<section id="section-12.10">
        <h3 id="name-comid-flags-map-registry">
<a href="#section-12.10" class="section-number selfRef">12.10. </a><a href="#name-comid-flags-map-registry" class="section-name selfRef">CoMID Flags Map Registry</a>
        </h3>
<p id="section-12.10-1">This document defines a new registry titled "CoMID Flags Map".
The registry uses integer values as index values for items in <code>measurement-values-map</code> codepoint 3.<a href="#section-12.10-1" class="pilcrow">¶</a></p>
<p id="section-12.10-2">Future registrations for this registry are to be made based on <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> as follows:<a href="#section-12.10-2" class="pilcrow">¶</a></p>
<span id="name-comid-flags-map-items-regis"></span><div id="tbl-iana-comid-flags-map-items-reg-procedures">
<table class="center" id="table-25">
          <caption>
<a href="#table-25" class="selfRef">Table 25</a>:
<a href="#name-comid-flags-map-items-regis" class="selfRef">CoMID Flags Map Items Registration Procedures</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-1023</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1024-65535</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">65536-18446744073709551616</td>
              <td class="text-left" rowspan="1" colspan="1">First come first served</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.10-4">All negative values are reserved for Private Use.<a href="#section-12.10-4" class="pilcrow">¶</a></p>
<p id="section-12.10-5">Initial registrations for the "CoMID Measurement Values Map" registry are provided below.
Assignments consist of an integer index value, the item name, and a reference to the defining specification.<a href="#section-12.10-5" class="pilcrow">¶</a></p>
<span id="name-flags-map-items-initial-reg"></span><div id="tbl-iana-comid-flags-map-items">
<table class="center" id="table-26">
          <caption>
<a href="#table-26" class="selfRef">Table 26</a>:
<a href="#name-flags-map-items-initial-reg" class="selfRef">Flags Map Items Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Index</th>
              <th class="text-left" rowspan="1" colspan="1">Item Name</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">is-configured</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">is-secure</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">is-recovery</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">is-debug</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">is-replay-protected</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">is-integrity-protected</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">is-runtime-meas</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">is-immutable</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">is-tcb</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">is-confidentiality-protected</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">10-18446744073709551616</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-cotl">
<section id="section-12.11">
        <h3 id="name-cotl-map-registry">
<a href="#section-12.11" class="section-number selfRef">12.11. </a><a href="#name-cotl-map-registry" class="section-name selfRef">CoTL Map Registry</a>
        </h3>
<p id="section-12.11-1">This document defines a new registry titled "CoTL Map".
The registry uses integer values as index values for items in 'concise-tl-tag' CBOR maps.<a href="#section-12.11-1" class="pilcrow">¶</a></p>
<p id="section-12.11-2">Future registrations for this registry are to be made based on <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> as follows:<a href="#section-12.11-2" class="pilcrow">¶</a></p>
<span id="name-cotl-map-items-registration"></span><div id="tbl-iana-cotl-map-items-reg-procedures">
<table class="center" id="table-27">
          <caption>
<a href="#table-27" class="selfRef">Table 27</a>:
<a href="#name-cotl-map-items-registration" class="selfRef">CoTL Map Items Registration Procedures</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-127</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">128-255</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.11-4">All negative values are reserved for Private Use.<a href="#section-12.11-4" class="pilcrow">¶</a></p>
<p id="section-12.11-5">Initial registrations for the "CoTL Map" registry are provided below.
Assignments consist of an integer index value, the item name, and a reference to the defining specification.<a href="#section-12.11-5" class="pilcrow">¶</a></p>
<span id="name-cotl-map-items-initial-regi"></span><div id="tbl-iana-tl-map-items">
<table class="center" id="table-28">
          <caption>
<a href="#table-28" class="selfRef">Table 28</a>:
<a href="#name-cotl-map-items-initial-regi" class="selfRef">CoTL Map Items Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Index</th>
              <th class="text-left" rowspan="1" colspan="1">Item Name</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">tag-identity</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">tags-list</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">tl-validity</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3-255</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-media-types">
<section id="section-12.12">
        <h3 id="name-new-media-types">
<a href="#section-12.12" class="section-number selfRef">12.12. </a><a href="#name-new-media-types" class="section-name selfRef">New Media Types</a>
        </h3>
<p id="section-12.12-1">IANA is requested to add the following media types to the "Media Types"
registry <span>[<a href="#IANA.media-types" class="cite xref">IANA.media-types</a>]</span>.<a href="#section-12.12-1" class="pilcrow">¶</a></p>
<span id="name-new-media-types-2"></span><div id="tbl-media-type">
<table class="left" id="table-29">
          <caption>
<a href="#table-29" class="selfRef">Table 29</a>:
<a href="#name-new-media-types-2" class="selfRef">New Media Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Template</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">rim+cbor</td>
              <td class="text-left" rowspan="1" colspan="1">application/rim+cbor</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis, (<a href="#sec-mt-rim-cbor" class="auto internal xref">Section 12.12.1</a>)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">rim+cose</td>
              <td class="text-left" rowspan="1" colspan="1">application/rim+cose</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis, (<a href="#sec-mt-rim-cose" class="auto internal xref">Section 12.12.2</a>)</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="sec-mt-rim-cbor">
<section id="section-12.12.1">
          <h4 id="name-rimcbor">
<a href="#section-12.12.1" class="section-number selfRef">12.12.1. </a><a href="#name-rimcbor" class="section-name selfRef">rim+cbor</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-12.12.1-1">
            <dt id="section-12.12.1-1.1">Type name:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.2">
              <p id="section-12.12.1-1.2.1"><code>application</code><a href="#section-12.12.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.3">Subtype name:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.4">
              <p id="section-12.12.1-1.4.1"><code>rim+cbor</code><a href="#section-12.12.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.5">Required parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.6">
              <p id="section-12.12.1-1.6.1">n/a<a href="#section-12.12.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.7">Optional parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.8">
              <p id="section-12.12.1-1.8.1">"profile" (CoRIM profile in string format.  OIDs MUST use the dotted-decimal
notation.)<a href="#section-12.12.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.9">Encoding considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.10">
              <p id="section-12.12.1-1.10.1">binary<a href="#section-12.12.1-1.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.11">Security considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.12">
              <p id="section-12.12.1-1.12.1"><a href="#sec-sec" class="auto internal xref">Section 11</a> of RFCthis<a href="#section-12.12.1-1.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.13">Interoperability considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.14">
              <p id="section-12.12.1-1.14.1">n/a<a href="#section-12.12.1-1.14.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.15">Published specification:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.16">
              <p id="section-12.12.1-1.16.1">RFCthis<a href="#section-12.12.1-1.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.17">Applications that use this media type:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.18">
              <p id="section-12.12.1-1.18.1">Attestation Verifiers, Endorsers and Reference-Value providers that need to
transfer unprotected CoRIM payloads over HTTP(S), CoAP(S), and other
transports.<a href="#section-12.12.1-1.18.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.19">Fragment identifier considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.20">
              <p id="section-12.12.1-1.20.1">n/a<a href="#section-12.12.1-1.20.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.21">Magic number(s):</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.22">
              <p id="section-12.12.1-1.22.1"><code>D9 01 F5</code><a href="#section-12.12.1-1.22.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.23">File extension(s):</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.24">
              <p id="section-12.12.1-1.24.1">.corim<a href="#section-12.12.1-1.24.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.25">Macintosh file type code(s):</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.26">
              <p id="section-12.12.1-1.26.1">n/a<a href="#section-12.12.1-1.26.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.27">Person and email address to contact for further information:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.28">
              <p id="section-12.12.1-1.28.1">RATS WG mailing list (rats@ietf.org)<a href="#section-12.12.1-1.28.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.29">Intended usage:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.30">
              <p id="section-12.12.1-1.30.1">COMMON<a href="#section-12.12.1-1.30.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.31">Restrictions on usage:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.32">
              <p id="section-12.12.1-1.32.1">none<a href="#section-12.12.1-1.32.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.33">Author/Change controller:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.34">
              <p id="section-12.12.1-1.34.1">IETF<a href="#section-12.12.1-1.34.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.1-1.35">Provisional registration?</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.1-1.36">
              <p id="section-12.12.1-1.36.1">Maybe<a href="#section-12.12.1-1.36.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-mt-rim-cose">
<section id="section-12.12.2">
          <h4 id="name-rimcose">
<a href="#section-12.12.2" class="section-number selfRef">12.12.2. </a><a href="#name-rimcose" class="section-name selfRef">rim+cose</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-12.12.2-1">
            <dt id="section-12.12.2-1.1">Type name:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.2">
              <p id="section-12.12.2-1.2.1"><code>application</code><a href="#section-12.12.2-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.3">Subtype name:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.4">
              <p id="section-12.12.2-1.4.1"><code>rim+cose</code><a href="#section-12.12.2-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.5">Required parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.6">
              <p id="section-12.12.2-1.6.1">n/a (cose-type is explicitly not supported, as it is understood to be "cose-sign1")<a href="#section-12.12.2-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.7">Optional parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.8">
              <p id="section-12.12.2-1.8.1">"profile" (CoRIM profile in string format.  OIDs MUST use the dotted-decimal
notation.)<a href="#section-12.12.2-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.9">Encoding considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.10">
              <p id="section-12.12.2-1.10.1">binary<a href="#section-12.12.2-1.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.11">Security considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.12">
              <p id="section-12.12.2-1.12.1"><a href="#sec-sec" class="auto internal xref">Section 11</a> of RFCthis<a href="#section-12.12.2-1.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.13">Interoperability considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.14">
              <p id="section-12.12.2-1.14.1">n/a<a href="#section-12.12.2-1.14.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.15">Published specification:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.16">
              <p id="section-12.12.2-1.16.1">RFCthis<a href="#section-12.12.2-1.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.17">Applications that use this media type:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.18">
              <p id="section-12.12.2-1.18.1">Attestation Verifiers, Endorsers and Reference-Value providers that need to
transfer CoRIM payloads protected using COSE Sign1 over HTTP(S), CoAP(S), and other
transports.<a href="#section-12.12.2-1.18.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.19">Fragment identifier considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.20">
              <p id="section-12.12.2-1.20.1">n/a<a href="#section-12.12.2-1.20.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.21">Magic number(s):</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.22">
              <p id="section-12.12.2-1.22.1"><code>D2 84</code><a href="#section-12.12.2-1.22.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.23">File extension(s):</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.24">
              <p id="section-12.12.2-1.24.1">.corim<a href="#section-12.12.2-1.24.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.25">Macintosh file type code(s):</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.26">
              <p id="section-12.12.2-1.26.1">n/a<a href="#section-12.12.2-1.26.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.27">Person and email address to contact for further information:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.28">
              <p id="section-12.12.2-1.28.1">RATS WG mailing list (rats@ietf.org)<a href="#section-12.12.2-1.28.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.29">Intended usage:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.30">
              <p id="section-12.12.2-1.30.1">COMMON<a href="#section-12.12.2-1.30.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.31">Restrictions on usage:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.32">
              <p id="section-12.12.2-1.32.1">none<a href="#section-12.12.2-1.32.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.33">Author/Change controller:</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.34">
              <p id="section-12.12.2-1.34.1">IETF<a href="#section-12.12.2-1.34.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.12.2-1.35">Provisional registration?</dt>
            <dd style="margin-left: 1.5em" id="section-12.12.2-1.36">
              <p id="section-12.12.2-1.36.1">Maybe<a href="#section-12.12.2-1.36.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="coap-content-formats-registration">
<section id="section-12.13">
        <h3 id="name-coap-content-formats-regist">
<a href="#section-12.13" class="section-number selfRef">12.13. </a><a href="#name-coap-content-formats-regist" class="section-name selfRef">CoAP Content-Formats Registration</a>
        </h3>
<p id="section-12.13-1">IANA is requested to register the two following Content-Format numbers in the
"CoAP Content-Formats" sub-registry, within the "Constrained RESTful
Environments (CoRE) Parameters" Registry <span>[<a href="#IANA.core-parameters" class="cite xref">IANA.core-parameters</a>]</span>:<a href="#section-12.13-1" class="pilcrow">¶</a></p>
<span id="name-new-content-formats"></span><table class="left" id="table-30">
          <caption>
<a href="#table-30" class="selfRef">Table 30</a>:
<a href="#name-new-content-formats" class="selfRef">New Content-Formats</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Content-Type</th>
              <th class="text-left" rowspan="1" colspan="1">Content Coding</th>
              <th class="text-left" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">application/rim+cbor</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">TBD1</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">application/rim+cose</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">TBD2</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-rats-msg-wrap">[I-D.ietf-rats-msg-wrap]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Smith, N.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">D. Glaze</span>, <span class="refTitle">"RATS Conceptual Messages Wrapper (CMW)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-msg-wrap-21</span>, <time datetime="2025-11-18" class="refDate">18 November 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-21">https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-21</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.cbor-tags">[IANA.cbor-tags]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Tags"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cbor-tags">https://www.iana.org/assignments/cbor-tags</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.core-parameters">[IANA.core-parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters">https://www.iana.org/assignments/core-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.language-subtag-registry">[IANA.language-subtag-registry]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Language Subtag Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/language-subtag-registry">https://www.iana.org/assignments/language-subtag-registry</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.media-types">[IANA.media-types]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Media Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/media-types">https://www.iana.org/assignments/media-types</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.named-information">[IANA.named-information]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Named Information"</span>, <span>&lt;<a href="https://www.iana.org/assignments/named-information">https://www.iana.org/assignments/named-information</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7468">[RFC7468]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">S. Leonard</span>, <span class="refTitle">"Textual Encodings of PKIX, PKCS, and CMS Structures"</span>, <span class="seriesInfo">RFC 7468</span>, <span class="seriesInfo">DOI 10.17487/RFC7468</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7468">https://www.rfc-editor.org/rfc/rfc7468</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9090">[RFC9090]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Tags for Object Identifiers"</span>, <span class="seriesInfo">RFC 9090</span>, <span class="seriesInfo">DOI 10.17487/RFC9090</span>, <time datetime="2021-07" class="refDate">July 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9090">https://www.rfc-editor.org/rfc/rfc9090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9393">[RFC9393]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Fitzgerald-McKay, J.</span>, <span class="refAuthor">Schmidt, C.</span>, and <span class="refAuthor">D. Waltermire</span>, <span class="refTitle">"Concise Software Identification Tags"</span>, <span class="seriesInfo">RFC 9393</span>, <span class="seriesInfo">DOI 10.17487/RFC9393</span>, <time datetime="2023-06" class="refDate">June 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9393">https://www.rfc-editor.org/rfc/rfc9393</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9562">[RFC9562]</dt>
        <dd>
<span class="refAuthor">Davis, K.</span>, <span class="refAuthor">Peabody, B.</span>, and <span class="refAuthor">P. Leach</span>, <span class="refTitle">"Universally Unique IDentifiers (UUIDs)"</span>, <span class="seriesInfo">RFC 9562</span>, <span class="seriesInfo">DOI 10.17487/RFC9562</span>, <time datetime="2024-05" class="refDate">May 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9562">https://www.rfc-editor.org/rfc/rfc9562</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9597">[RFC9597]</dt>
        <dd>
<span class="refAuthor">Looker, T.</span> and <span class="refAuthor">M.B. Jones</span>, <span class="refTitle">"CBOR Web Token (CWT) Claims in COSE Headers"</span>, <span class="seriesInfo">RFC 9597</span>, <span class="seriesInfo">DOI 10.17487/RFC9597</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9597">https://www.rfc-editor.org/rfc/rfc9597</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9711">[RFC9711]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="seriesInfo">RFC 9711</span>, <span class="seriesInfo">DOI 10.17487/RFC9711</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9711">https://www.rfc-editor.org/rfc/rfc9711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD66">[STD66]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD94">[STD94]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD96">[STD96]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Information technology — ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.690">https://www.itu.int/rec/T-REC-X.690</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="DICE.cert">[DICE.cert]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"DICE Certificate Profiles"</span>, <span class="seriesInfo">Version 1.0, Revision 0.01 </span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/DICE-Certificate-Profiles-r01_pub.pdf">https://trustedcomputinggroup.org/wp-content/uploads/DICE-Certificate-Profiles-r01_pub.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DICE.Layer">[DICE.Layer]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"DICE Layering Architecture"</span>, <span class="seriesInfo">Version 1.0, Revision 0.19 </span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/DICE-Layering-Architecture-r19_pub.pdf">https://trustedcomputinggroup.org/wp-content/uploads/DICE-Layering-Architecture-r19_pub.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.fdb-rats-psa-endorsements">[I-D.fdb-rats-psa-endorsements]</dt>
        <dd>
<span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Deshpande, Y.</span>, and <span class="refAuthor">H. Birkholz</span>, <span class="refTitle">"A CoRIM Profile for Arm's Platform Security Architecture (PSA) Endorsements"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-fdb-rats-psa-endorsements-08</span>, <time datetime="2025-07-04" class="refDate">4 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-fdb-rats-psa-endorsements-08">https://datatracker.ietf.org/doc/html/draft-fdb-rats-psa-endorsements-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-ar4si">[I-D.ietf-rats-ar4si]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Hardjono, T.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">V. Scarlata</span>, <span class="refTitle">"Attestation Results for Secure Interactions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-ar4si-09</span>, <time datetime="2025-08-15" class="refDate">15 August 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-09">https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-concise-ta-stores">[I-D.ietf-rats-concise-ta-stores]</dt>
        <dd>
<span class="refAuthor">Wallace, C.</span>, <span class="refAuthor">Housley, R.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">Y. Deshpande</span>, <span class="refTitle">"Concise TA Stores (CoTS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-concise-ta-stores-02</span>, <time datetime="2023-12-05" class="refDate">5 December 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-concise-ta-stores-02">https://datatracker.ietf.org/doc/html/draft-ietf-rats-concise-ta-stores-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-endorsements">[I-D.ietf-rats-endorsements]</dt>
        <dd>
<span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Birkholz, H.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"RATS Endorsements"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-endorsements-07</span>, <time datetime="2025-08-25" class="refDate">25 August 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-endorsements-07">https://datatracker.ietf.org/doc/html/draft-ietf-rats-endorsements-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.coswid">[IANA.coswid]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Concise Software Identifier (CoSWID)"</span>, <span>&lt;<a href="https://www.iana.org/assignments/coswid">https://www.iana.org/assignments/coswid</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7942">https://www.rfc-editor.org/rfc/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9783">[RFC9783]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Frost, S.</span>, <span class="refAuthor">Brossard, M.</span>, <span class="refAuthor">Shaw, A.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Arm's Platform Security Architecture (PSA) Attestation Token"</span>, <span class="seriesInfo">RFC 9783</span>, <span class="seriesInfo">DOI 10.17487/RFC9783</span>, <time datetime="2025-06" class="refDate">June 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9783">https://www.rfc-editor.org/rfc/rfc9783</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TNC.Arch">[TNC.Arch]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG Trusted Network Connect TNC Architecture for Interoperability"</span>, <span class="seriesInfo">Specification Version 1.1 Revision 2 </span>, <time datetime="2006-05" class="refDate">May 2006</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TNC_Architecture_v1_1_r2.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TNC_Architecture_v1_1_r2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM2.Part1">[TPM2.Part1]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Trusted Platform Module Library, Part 1: Architecture"</span>, <span class="seriesInfo">Family "2.0", Level 00, Revision 01.83 </span>, <time datetime="2024-01" class="refDate">January 2024</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-library-specification/">https://trustedcomputinggroup.org/resource/tpm-library-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3C.rdf11-primer">[W3C.rdf11-primer]</dt>
      <dd>
<span class="refTitle">"RDF 1.1 Primer"</span>, <span class="seriesInfo">W3C NOTE rdf11-primer</span>, <span class="seriesInfo">W3C rdf11-primer</span>, <span>&lt;<a href="https://www.w3.org/TR/rdf11-primer/">https://www.w3.org/TR/rdf11-primer/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec-corim-cddl">
<section id="appendix-A">
      <h2 id="name-base-corim-cddl">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-base-corim-cddl" class="section-name selfRef">Base CoRIM CDDL</a>
      </h2>
<div class="breakable lang-cddl sourcecode" id="appendix-A-1">
<pre>
corim = concise-rim-type-choice

concise-rim-type-choice /= tagged-unsigned-corim-map
concise-rim-type-choice /= signed-corim

concise-tl-tag = {
  &amp;(tag-identity: 0) =&gt; tag-identity-map
  &amp;(tags-list: 1) =&gt; [ + tag-identity-map ],
  &amp;(tl-validity: 2) =&gt; validity-map
}

$concise-tag-type-choice /= tagged-concise-swid-tag
$concise-tag-type-choice /= tagged-concise-mid-tag
$concise-tag-type-choice /= tagged-concise-tl-tag

corim-entity-map =
  entity-map&lt;$corim-role-type-choice, $$corim-entity-map-extension&gt;

$corim-id-type-choice /= tstr
$corim-id-type-choice /= uuid-type

corim-locator-map = {
  &amp;(href: 0) =&gt; uri / [ + uri ]
  ? &amp;(thumbprint: 1) =&gt; digest / [digest]
}

corim-map = {
  &amp;(id: 0) =&gt; $corim-id-type-choice
  &amp;(tags: 1) =&gt; [ + $concise-tag-type-choice ]
  ? &amp;(dependent-rims: 2) =&gt; [ + corim-locator-map ]
  ? &amp;(profile: 3) =&gt; $profile-type-choice
  ? &amp;(rim-validity: 4) =&gt; validity-map
  ? &amp;(entities: 5) =&gt; [ + corim-entity-map ]
  * $$corim-map-extension
}
unsigned-corim-map = corim-map

corim-meta-map = {
  &amp;(signer: 0) =&gt; corim-signer-map
  ? &amp;(signature-validity: 1) =&gt; validity-map
}

$corim-role-type-choice /= &amp;(manifest-creator: 1)
$corim-role-type-choice /= &amp;(manifest-signer: 2)

corim-signer-map = {
  &amp;(signer-name: 0) =&gt; $entity-name-type-choice
  ? &amp;(signer-uri: 1) =&gt; uri
  * $$corim-signer-map-extension
}

COSE-Sign1-corim = [
  protected: bstr .cbor protected-corim-header-map
  unprotected: unprotected-corim-header-map
  payload: bstr .cbor tagged-unsigned-corim-map
  signature: bstr
]

$profile-type-choice /= uri
$profile-type-choice /= tagged-oid-type

cwt-claims = {
  &amp;(iss: 1) =&gt; tstr
  ? &amp;(sub: 2) =&gt; tstr
  ? &amp;(exp: 4) =&gt; int / float
  ? &amp;(nbf: 5) =&gt; int / float
  * int =&gt; any
}

protected-corim-header-map =
  {
    &amp;(alg: 1) =&gt; int,
    &amp;(content-type: 3) =&gt; "application/rim+cbor",
    meta-group,
    * cose-label =&gt; cose-value
  }

meta-group = ((
        corim-meta-identity,
        ? cwt-claims-identity,
      ) // cwt-claims-identity)

corim-meta-identity = (&amp;(corim-meta: 8) =&gt; bstr .cbor corim-meta-map)
cwt-claims-identity = (&amp;(CWT-Claims: 15) =&gt; cwt-claims)

signed-corim = #6.18(COSE-Sign1-corim)

tagged-concise-swid-tag = #6.505(bytes .cbor concise-swid-tag)

tagged-concise-mid-tag = #6.506(bytes .cbor concise-mid-tag)

tagged-concise-tl-tag = #6.508(bytes .cbor concise-tl-tag)

tagged-unsigned-corim-map = #6.501(unsigned-corim-map)

unprotected-corim-header-map = {
  * cose-label =&gt; cose-value
}

validity-map = {
  ? &amp;(not-before: 0) =&gt; time
  &amp;(not-after: 1) =&gt; time
}

concise-mid-tag = {
  ? &amp;(language: 0) =&gt; text
  &amp;(tag-identity: 1) =&gt; tag-identity-map
  ? &amp;(entities: 2) =&gt; [ + comid-entity-map ]
  ? &amp;(linked-tags: 3) =&gt; [ + linked-tag-map ]
  &amp;(triples: 4) =&gt; triples-map
  * $$concise-mid-tag-extension
}

attest-key-triple-record = [
  environment: environment-map
  key-list: [ + $crypto-key-type-choice ]
  ? conditions: non-empty&lt; {
    ? &amp;(mkey: 0) =&gt; $measured-element-type-choice,
    ? &amp;(authorized-by: 1) =&gt; [ + $crypto-key-type-choice ]
  }&gt;
]

$class-id-type-choice /= tagged-oid-type
$class-id-type-choice /= tagged-uuid-type
$class-id-type-choice /= tagged-bytes

class-map = non-empty&lt;{
  ? &amp;(class-id: 0) =&gt; $class-id-type-choice
  ? &amp;(vendor: 1) =&gt; tstr
  ? &amp;(model: 2) =&gt; tstr
  ? &amp;(layer: 3) =&gt; uint
  ? &amp;(index: 4) =&gt; uint
}&gt;

comid-entity-map =
  entity-map&lt;$comid-role-type-choice, $$comid-entity-map-extension&gt;

$comid-role-type-choice /= &amp;(tag-creator: 0)
$comid-role-type-choice /= &amp;(creator: 1)
$comid-role-type-choice /= &amp;(maintainer: 2)

conditional-endorsement-series-triple-record = [
  condition: stateful-environment-record
  series: [ + conditional-series-record ]
]

conditional-series-record = [
  selection: [ + measurement-map]
  addition: [ + measurement-map ]
]

COSE_Key = {
    1 =&gt; tstr / int
    ? 2 =&gt; bstr
    ? 3 =&gt; tstr / int
    ? 4 =&gt; [+ (tstr / int) ]
    ? 5 =&gt; bstr
    * cose-label =&gt; cose-value
}

cose-label = int / tstr
cose-value = any

coswid-triple-record = [
  environment-map
  [ + concise-swid-tag-id ]
]

concise-swid-tag-id = text / bstr .size 16

$crypto-key-type-choice /= tagged-pkix-base64-key-type
$crypto-key-type-choice /= tagged-pkix-base64-cert-type
$crypto-key-type-choice /= tagged-pkix-base64-cert-path-type
$crypto-key-type-choice /= tagged-cose-key-type
$crypto-key-type-choice /= tagged-pkix-asn1der-cert-type
$crypto-key-type-choice /= tagged-key-thumbprint-type
$crypto-key-type-choice /= tagged-cert-thumbprint-type
$crypto-key-type-choice /= tagged-cert-path-thumbprint-type
$crypto-key-type-choice /= tagged-bytes
tagged-pkix-base64-key-type = #6.554(tstr)
tagged-pkix-base64-cert-type = #6.555(tstr)
tagged-pkix-base64-cert-path-type = #6.556(tstr)
tagged-key-thumbprint-type = #6.557(digest)
tagged-cose-key-type = #6.558(COSE_Key)
tagged-cert-thumbprint-type = #6.559(digest)
tagged-cert-path-thumbprint-type = #6.561(digest)
tagged-pkix-asn1der-cert-type = #6.562(bstr)

domain-dependency-triple-record = [
  domain-type
  [ + domain-type ]
]

domain-membership-triple-record = [
  domain-id: domain-type
  members: [ +  domain-type ]
]

conditional-endorsement-triple-record = [
  conditions: [ + stateful-environment-record ]
  endorsements: [ + endorsed-triple-record ]
]

domain-type = environment-map

endorsed-triple-record = [
  condition: environment-map
  endorsement: [ + measurement-map ]
]

entity-map&lt;role-type-choice, extension-socket&gt; = {
  &amp;(entity-name: 0) =&gt; $entity-name-type-choice
  ? &amp;(reg-id: 1) =&gt; uri
  &amp;(role: 2) =&gt; [ + role-type-choice ]
  * extension-socket
}

$entity-name-type-choice /= text

environment-map = non-empty&lt;{
  ? &amp;(class: 0) =&gt; class-map
  ? &amp;(instance: 1) =&gt; $instance-id-type-choice
  ? &amp;(group: 2) =&gt; $group-id-type-choice
}&gt;

flags-map = {
  ? &amp;(is-configured: 0) =&gt; bool
  ? &amp;(is-secure: 1) =&gt; bool
  ? &amp;(is-recovery: 2) =&gt; bool
  ? &amp;(is-debug: 3) =&gt; bool
  ? &amp;(is-replay-protected: 4) =&gt; bool
  ? &amp;(is-integrity-protected: 5) =&gt; bool
  ? &amp;(is-runtime-meas: 6) =&gt; bool
  ? &amp;(is-immutable: 7) =&gt; bool
  ? &amp;(is-tcb: 8) =&gt; bool
  ? &amp;(is-confidentiality-protected: 9) =&gt; bool
  * $$flags-map-extension
}

$group-id-type-choice /= tagged-uuid-type
$group-id-type-choice /= tagged-bytes

identity-triple-record = [
  environment: environment-map
  key-list: [ + $crypto-key-type-choice ]
  ? conditions: non-empty&lt;{
    ? &amp;(mkey: 0) =&gt; $measured-element-type-choice,
    ? &amp;(authorized-by: 1) =&gt; [ + $crypto-key-type-choice ]
  }&gt;
]

$instance-id-type-choice /= tagged-ueid-type
$instance-id-type-choice /= tagged-uuid-type
$instance-id-type-choice /= tagged-bytes
$instance-id-type-choice /= tagged-pkix-base64-key-type
$instance-id-type-choice /= tagged-pkix-base64-cert-type
$instance-id-type-choice /= tagged-cose-key-type
$instance-id-type-choice /= tagged-key-thumbprint-type
$instance-id-type-choice /= tagged-cert-thumbprint-type
$instance-id-type-choice /= tagged-pkix-asn1der-cert-type

ip-addr-type-choice = ip4-addr-type / ip6-addr-type
ip4-addr-type = bytes .size 4
ip6-addr-type = bytes .size 16

int-range-type-choice = int / tagged-int-range
int-range = [min: int / negative-inf, max: int / positive-inf]
tagged-int-range = #6.564(int-range)
positive-inf = null
negative-inf = null

linked-tag-map = {
  &amp;(linked-tag-id: 0) =&gt; $tag-id-type-choice
  &amp;(tag-rel: 1) =&gt; $tag-rel-type-choice
}

mac-addr-type-choice = eui48-addr-type / eui64-addr-type
eui48-addr-type = bytes .size 6
eui64-addr-type = bytes .size 8

$measured-element-type-choice /= tagged-oid-type
$measured-element-type-choice /= tagged-uuid-type
$measured-element-type-choice /= uint
$measured-element-type-choice /= tstr

measurement-map = {
  ? &amp;(mkey: 0) =&gt; $measured-element-type-choice
  &amp;(mval: 1) =&gt; measurement-values-map
  ? &amp;(authorized-by: 2) =&gt; [ + $crypto-key-type-choice ]
}

measurement-values-map = non-empty&lt;{
  ? &amp;(version: 0) =&gt; version-map
  ? &amp;(svn: 1) =&gt; svn-type-choice
  ? &amp;(digests: 2) =&gt; digests-type
  ? &amp;(flags: 3) =&gt; flags-map
  ? (
      &amp;(raw-value: 4) =&gt; $raw-value-type-choice,
      ? &amp;(raw-value-mask-DEPRECATED: 5) =&gt; raw-value-mask-type
    )
  ? &amp;(mac-addr: 6) =&gt; mac-addr-type-choice
  ? &amp;(ip-addr: 7) =&gt;  ip-addr-type-choice
  ? &amp;(serial-number: 8) =&gt; text
  ? &amp;(ueid: 9) =&gt; ueid-type
  ? &amp;(uuid: 10) =&gt; uuid-type
  ? &amp;(name: 11) =&gt; text
  ? &amp;(cryptokeys: 13) =&gt; [ + $crypto-key-type-choice ]
  ? &amp;(integrity-registers: 14) =&gt; integrity-registers
  ? &amp;(int-range: 15) =&gt; int-range-type-choice
  * $$measurement-values-map-extension
}&gt;

non-empty&lt;M&gt; = (M) .and ({ + any =&gt; any })

oid-type = bytes
tagged-oid-type = #6.111(oid-type)

$raw-value-type-choice /= tagged-bytes
$raw-value-type-choice /= tagged-masked-raw-value

raw-value-mask-type = bytes

tagged-masked-raw-value = #6.563([
  value: bytes
  mask : bytes
])

reference-triple-record = [
  ref-env: environment-map
  ref-claims: [ + measurement-map ]
]

stateful-environment-record = [
  environment: environment-map,
  claims-list: [ + measurement-map ]
]

svn-type = uint
svn = svn-type
min-svn = svn-type
tagged-svn = #6.552(svn)
tagged-min-svn = #6.553(min-svn)
svn-type-choice = svn / tagged-svn / tagged-min-svn

$tag-id-type-choice /= tstr
$tag-id-type-choice /= uuid-type

tag-identity-map = {
  &amp;(tag-id: 0) =&gt; $tag-id-type-choice
  ? &amp;(tag-version: 1) =&gt; tag-version-type
}

$tag-rel-type-choice /= &amp;(supplements: 0)
$tag-rel-type-choice /= &amp;(replaces: 1)

tag-version-type = uint .default 0

tagged-bytes = #6.560(bytes)

triples-map = non-empty&lt;{
  ? &amp;(reference-triples: 0) =&gt;
    [ + reference-triple-record ]
  ? &amp;(endorsed-triples: 1) =&gt;
    [ + endorsed-triple-record ]
  ? &amp;(identity-triples: 2) =&gt;
    [ + identity-triple-record ]
  ? &amp;(attest-key-triples: 3) =&gt;
    [ + attest-key-triple-record ]
  ? &amp;(dependency-triples: 4) =&gt;
    [ + domain-dependency-triple-record ]
  ? &amp;(membership-triples: 5) =&gt;
    [ + domain-membership-triple-record ]
  ? &amp;(coswid-triples: 6) =&gt;
    [ + coswid-triple-record ]
  ? &amp;(conditional-endorsement-series-triples: 8) =&gt;
    [ + conditional-endorsement-series-triple-record ]
  ? &amp;(conditional-endorsement-triples: 10) =&gt;
    [ + conditional-endorsement-triple-record ]
  * $$triples-map-extension
}&gt;

ueid-type = bytes .size (7..33)
tagged-ueid-type = #6.550(ueid-type)

uuid-type = bytes .size 16
tagged-uuid-type = #6.37(uuid-type)

version-map = {
  &amp;(version: 0) =&gt; text
  ? &amp;(version-scheme: 1) =&gt; $version-scheme
}

digest = [
  alg: (int / text),
  val: bytes
]

digests-type = [ + digest ]

integrity-register-id-type-choice = uint / text

integrity-registers = {
  + integrity-register-id-type-choice =&gt; digests-type
}

concise-swid-tag = {
  tag-id =&gt; text / bstr .size 16,
  tag-version =&gt; integer,
  ? corpus =&gt; bool,
  ? patch =&gt; bool,
  ? supplemental =&gt; bool,
  software-name =&gt; text,
  ? software-version =&gt; text,
  ? version-scheme =&gt; $version-scheme,
  ? media =&gt; text,
  ? software-meta =&gt; one-or-more&lt;software-meta-entry&gt;,
  entity =&gt; one-or-more&lt;entity-entry&gt;,
  ? link =&gt; one-or-more&lt;link-entry&gt;,
  ? payload-or-evidence,
  * $$coswid-extension,
  global-attributes,
}

payload-or-evidence //= ( payload =&gt; payload-entry )
payload-or-evidence //= ( evidence =&gt; evidence-entry )

any-uri = uri
label = text / int

$version-scheme /= multipartnumeric
$version-scheme /= multipartnumeric-suffix
$version-scheme /= alphanumeric
$version-scheme /= decimal
$version-scheme /= semver
$version-scheme /= int / text

any-attribute = (
  label =&gt; one-or-more&lt;text&gt; / one-or-more&lt;int&gt;
)

one-or-more&lt;T&gt; = T / [ 2* T ]

global-attributes = (
  ? lang =&gt; text,
  * any-attribute,
)

hash-entry = [
  hash-alg-id: int,
  hash-value: bytes,
]

entity-entry = {
  entity-name =&gt; text,
  ? reg-id =&gt; any-uri,
  role =&gt; one-or-more&lt;$role&gt;,
  ? thumbprint =&gt; hash-entry,
  * $$entity-extension,
  global-attributes,
}

$role /= tag-creator
$role /= software-creator
$role /= aggregator
$role /= distributor
$role /= licensor
$role /= maintainer
$role /= int / text

link-entry = {
  ? artifact =&gt; text,
  href =&gt; any-uri,
  ? media =&gt; text,
  ? ownership =&gt; $ownership,
  rel =&gt; $rel,
  ? media-type =&gt; text,
  ? use =&gt; $use,
  * $$link-extension,
  global-attributes,
}

$ownership /= shared
$ownership /= private
$ownership /= abandon
$ownership /= int / text

$rel /= ancestor
$rel /= component
$rel /= feature
$rel /= installationmedia
$rel /= packageinstaller
$rel /= parent
$rel /= patches
$rel /= requires
$rel /= see-also
$rel /= supersedes
$rel /= supplemental
$rel /= -256..64436 / text

$use /= optional
$use /= required
$use /= recommended
$use /= int / text

software-meta-entry = {
  ? activation-status =&gt; text,
  ? channel-type =&gt; text,
  ? colloquial-version =&gt; text,
  ? description =&gt; text,
  ? edition =&gt; text,
  ? entitlement-data-required =&gt; bool,
  ? entitlement-key =&gt; text,
  ? generator =&gt;  text / bstr .size 16,
  ? persistent-id =&gt; text,
  ? product =&gt; text,
  ? product-family =&gt; text,
  ? revision =&gt; text,
  ? summary =&gt; text,
  ? unspsc-code =&gt; text,
  ? unspsc-version =&gt; text,
  * $$software-meta-extension,
  global-attributes,
}

path-elements-group = ( ? directory =&gt; one-or-more&lt;directory-entry&gt;,
                        ? file =&gt; one-or-more&lt;file-entry&gt;,
                      )

resource-collection = (
  path-elements-group,
  ? process =&gt; one-or-more&lt;process-entry&gt;,
  ? resource =&gt; one-or-more&lt;resource-entry&gt;,
  * $$resource-collection-extension,
)

file-entry = {
  filesystem-item,
  ? size =&gt; uint,
  ? file-version =&gt; text,
  ? hash =&gt; hash-entry,
  * $$file-extension,
  global-attributes,
}

directory-entry = {
  filesystem-item,
  ? path-elements =&gt; { path-elements-group },
  * $$directory-extension,
  global-attributes,
}

process-entry = {
  process-name =&gt; text,
  ? pid =&gt; integer,
  * $$process-extension,
  global-attributes,
}

resource-entry = {
  type =&gt; text,
  * $$resource-extension,
  global-attributes,
}

filesystem-item = (
  ? key =&gt; bool,
  ? location =&gt; text,
  fs-name =&gt; text,
  ? root =&gt; text,
)

payload-entry = {
  resource-collection,
  * $$payload-extension,
  global-attributes,
}

evidence-entry = {
  resource-collection,
  ? date =&gt; integer-time,
  ? device-id =&gt; text,
  ? location =&gt; text,
  * $$evidence-extension,
  global-attributes,
}

integer-time = #6.1(int)

tag-id = 0
software-name = 1
entity = 2
evidence = 3
link = 4
software-meta = 5
payload = 6
hash = 7
corpus = 8
patch = 9
media = 10
supplemental = 11
tag-version = 12
software-version = 13
version-scheme = 14
lang = 15
directory = 16
file = 17
process = 18
resource = 19
size = 20
file-version = 21
key = 22
location = 23
fs-name = 24
root = 25
path-elements = 26
process-name = 27
pid = 28
type = 29
entity-name = 31
reg-id = 32
role = 33
thumbprint = 34
date = 35
device-id = 36
artifact = 37
href = 38
ownership = 39
rel = 40
media-type = 41
use = 42
activation-status = 43
channel-type = 44
colloquial-version = 45
description = 46
edition = 47
entitlement-data-required = 48
entitlement-key = 49
generator = 50
persistent-id = 51
product = 52
product-family = 53
revision = 54
summary = 55
unspsc-code = 56
unspsc-version = 57

multipartnumeric = 1
multipartnumeric-suffix = 2
alphanumeric = 3
decimal = 4
semver = 16384

tag-creator=1
software-creator=2
aggregator=3
distributor=4
licensor=5
maintainer=6

abandon=1
private=2
shared=3

ancestor=1
component=2
feature=3
installationmedia=4
packageinstaller=5
parent=6
patches=7
requires=8
see-also=9
supersedes=10

optional=1
required=2
recommended=3

</pre><a href="#appendix-A-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The authors would like to thank the following people for their review and comments on this document:
<span class="contact-name">Carl Wallace</span>
        <span class="contact-name">Hannes Tschofenig</span>
        <span class="contact-name">Steven Bellock</span>
        <span class="contact-name">Jag Raman</span>
        <span class="contact-name">Giri Mandyam</span>
        <span class="contact-name">Jeremy O'Donoghue</span>
and
<span class="contact-name">Michael Richardson</span><a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-C">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Carsten Bormann</span></div>
<div dir="auto" class="left"><span class="org">Universität Bremen TZI</span></div>
<div dir="auto" class="left"><span class="street-address">Postfach 330440</span></div>
<div dir="auto" class="left">
<span class="postal-code">D-28359</span> <span class="locality">Bremen</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+49-421-218-63921" class="tel">+49-421-218-63921</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:cabo@tzi.org" class="email">cabo@tzi.org</a>
</div>
</address>
<p id="appendix-C-1">Carsten Bormann contributed to the CDDL specifications and the IANA considerations.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Andrew Draper</span></div>
<div dir="auto" class="left"><span class="org">Altera</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:andrew.draper@altera.com" class="email">andrew.draper@altera.com</a>
</div>
</address>
<p id="appendix-C-2">Andrew contributed the concept, description, and semantics of conditional endorsements as well as consistent contribution to weekly reviews of others' edits.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dionna Glaze</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dionnaglaze@google.com" class="email">dionnaglaze@google.com</a>
</div>
</address>
<p id="appendix-C-3">Dionna contributed many clarifying questions and disambiguations to the semantics of attestation appraisal as well as consistent contribution to weekly reviews of others' edits.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@ietf.contact" class="email">henk.birkholz@ietf.contact</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Fossati</span></div>
<div dir="auto" class="left"><span class="org">Linaro</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Thomas.Fossati@linaro.org" class="email">Thomas.Fossati@linaro.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yogesh Deshpande</span></div>
<div dir="auto" class="left"><span class="org">arm</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yogesh.deshpande@arm.com" class="email">yogesh.deshpande@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ned Smith</span></div>
<div dir="auto" class="left"><span class="org">Independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ned.smith.ietf@outlook.com" class="email">ned.smith.ietf@outlook.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Wei Pan</span></div>
<div dir="auto" class="left"><span class="org">Huawei Technologies</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:william.panwei@huawei.com" class="email">william.panwei@huawei.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
